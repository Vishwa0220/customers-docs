<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>06 Ci Cd Security Pipeline</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 30px;
            background-color: #fff;
        }

        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-top: 40px;
        }

        h2 {
            color: #34495e;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
            margin-top: 30px;
        }

        h3, h4, h5, h6 {
            color: #7f8c8d;
            margin-top: 20px;
        }

        code {
            background-color: #f7f9fc;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
        }

        pre {
            background-color: #2d3436;
            color: #dfe6e9;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.85em;
        }

        pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            font-size: 0.9em;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 10px 12px;
            text-align: left;
        }

        th {
            background-color: #3498db;
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        blockquote {
            border-left: 4px solid #3498db;
            margin: 20px 0;
            padding: 10px 20px;
            background-color: #ecf0f1;
            font-style: italic;
        }

        a {
            color: #3498db;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .diagram {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background-color: #fafafa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow-x: auto;
        }

        .diagram svg {
            max-width: 100%;
            height: auto;
        }

        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }

        ul, ol {
            padding-left: 25px;
        }

        li {
            margin-bottom: 5px;
        }

        hr {
            border: none;
            border-top: 2px solid #ecf0f1;
            margin: 30px 0;
        }

        #TOC {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
        }

        #TOC ul {
            list-style-type: none;
            padding-left: 0;
        }

        #TOC li {
            padding: 3px 0;
        }

        .header-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            margin: -30px -30px 30px -30px;
            text-align: center;
        }

        .header-section h1 {
            color: white;
            border: none;
            margin: 0;
        }

        .header-section p {
            margin: 10px 0 0 0;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="header-section">
        <h1>06 Ci Cd Security Pipeline</h1>
        <p>SECURAA Security Documentation</p>
    </div>
    <h1 id="securaa-secure-sdlc---cicd-security-pipeline">SECURAA Secure
SDLC - CI/CD Security Pipeline</h1>
<h2 id="comprehensive-automated-security-integration">Comprehensive
Automated Security Integration</h2>
<hr />
<h2 id="document-control">Document Control</h2>
<table>
<thead>
<tr class="header">
<th><strong>Document Title</strong></th>
<th>SECURAA SDLC - CI/CD Security Pipeline</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Document ID</strong></td>
<td>SECURAA-SDLC-008</td>
</tr>
<tr class="even">
<td><strong>Version</strong></td>
<td>2.0</td>
</tr>
<tr class="odd">
<td><strong>Date</strong></td>
<td>November 13, 2025</td>
</tr>
<tr class="even">
<td><strong>Classification</strong></td>
<td>Customer-Facing - Confidential</td>
</tr>
<tr class="odd">
<td><strong>Status</strong></td>
<td>Published</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="table-of-contents">Table of Contents</h2>
<ol type="1">
<li><a href="#cicd-security-overview">CI/CD Security Overview</a></li>
<li><a href="#security-pipeline-architecture">Security Pipeline
Architecture</a></li>
<li><a href="#pre-commit-security-hooks">Pre-Commit Security
Hooks</a></li>
<li><a href="#aws-codebuild-security-integration">AWS CodeBuild Security
Integration</a></li>
<li><a href="#security-gates-and-thresholds">Security Gates and
Thresholds</a></li>
<li><a href="#automated-security-testing">Automated Security
Testing</a></li>
<li><a href="#container-security-pipeline">Container Security
Pipeline</a></li>
<li><a href="#continuous-security-monitoring">Continuous Security
Monitoring</a></li>
<li><a href="#security-metrics-and-reporting">Security Metrics and
Reporting</a></li>
<li><a href="#pipeline-security-best-practices">Pipeline Security Best
Practices</a></li>
</ol>
<hr />
<h2 id="cicd-security-overview">CI/CD Security Overview</h2>
<h3 id="philosophy-security-as-code">Philosophy: Security as Code</h3>
<p>The SECURAA CI/CD pipeline implements <strong>“Security as
Code”</strong> - treating security controls, policies, and tests as code
that is version-controlled, automated, and continuously validated.</p>
<h3 id="key-principles">Key Principles</h3>
<ol type="1">
<li><strong>Shift Left Security</strong> - Identify and fix security
issues as early as possible</li>
<li><strong>Automated Security Testing</strong> - Every commit triggers
automated security scans</li>
<li><strong>Fail Fast</strong> - Stop the pipeline immediately when
critical security issues are found</li>
<li><strong>Security Gates</strong> - Define clear security criteria
that must be met before progression</li>
<li><strong>Continuous Compliance</strong> - Automated compliance
checking at every stage</li>
<li><strong>Immutable Artifacts</strong> - All artifacts are immutable
and traceable</li>
<li><strong>Defense in Depth</strong> - Multiple layers of security
validation</li>
</ol>
<div class="diagram">
<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 963.344px; background-color: white;" viewBox="0 0 963.34375 3646.3125" role="graphics-document document" aria-roledescription="flowchart-v2">
<style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style>
<g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path d="M248.488,62L248.488,66.167C248.488,70.333,248.488,78.667,248.488,86.333C248.488,94,248.488,101,248.488,104.5L248.488,108" id="L_A_B_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A_B_0" data-points="W3sieCI6MjQ4LjQ4ODI4MTI1LCJ5Ijo2Mn0seyJ4IjoyNDguNDg4MjgxMjUsInkiOjg3fSx7IngiOjI0OC40ODgyODEyNSwieSI6MTEyfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M248.488,166L248.488,170.167C248.488,174.333,248.488,182.667,248.488,190.333C248.488,198,248.488,205,248.488,208.5L248.488,212" id="L_B_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_C_0" data-points="W3sieCI6MjQ4LjQ4ODI4MTI1LCJ5IjoxNjZ9LHsieCI6MjQ4LjQ4ODI4MTI1LCJ5IjoxOTF9LHsieCI6MjQ4LjQ4ODI4MTI1LCJ5IjoyMTZ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M191.545,437.056L180.679,452.714C169.814,468.371,148.083,499.685,137.217,520.843C126.352,542,126.352,553,126.352,558.5L126.352,564" id="L_C_D_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_D_0" data-points="W3sieCI6MTkxLjU0NDU5NDU1MDA1MzcyLCJ5Ijo0MzcuMDU2MzEzMzAwMDUzN30seyJ4IjoxMjYuMzUxNTYyNSwieSI6NTMxfSx7IngiOjEyNi4zNTE1NjI1LCJ5Ijo1Njh9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M305.432,437.056L316.297,452.714C327.163,468.371,348.894,499.685,359.759,520.843C370.625,542,370.625,553,370.625,558.5L370.625,564" id="L_C_E_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_E_0" data-points="W3sieCI6MzA1LjQzMTk2Nzk0OTk0NjMsInkiOjQzNy4wNTYzMTMzMDAwNTM3fSx7IngiOjM3MC42MjUsInkiOjUzMX0seyJ4IjozNzAuNjI1LCJ5Ijo1Njh9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M370.625,622L370.625,626.167C370.625,630.333,370.625,638.667,370.625,646.333C370.625,654,370.625,661,370.625,664.5L370.625,668" id="L_E_F_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E_F_0" data-points="W3sieCI6MzcwLjYyNSwieSI6NjIyfSx7IngiOjM3MC42MjUsInkiOjY0N30seyJ4IjozNzAuNjI1LCJ5Ijo2NzJ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M370.625,726L370.625,730.167C370.625,734.333,370.625,742.667,370.625,750.333C370.625,758,370.625,765,370.625,768.5L370.625,772" id="L_F_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_F_G_0" data-points="W3sieCI6MzcwLjYyNSwieSI6NzI2fSx7IngiOjM3MC42MjUsInkiOjc1MX0seyJ4IjozNzAuNjI1LCJ5Ijo3NzZ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M251.234,826.038L226.219,830.865C201.203,835.692,151.172,845.346,126.156,853.673C101.141,862,101.141,869,101.141,872.5L101.141,876" id="L_G_H_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_G_H_0" data-points="W3sieCI6MjUxLjIzNDM3NSwieSI6ODI2LjAzNzc0NTY5NDkwMzV9LHsieCI6MTAxLjE0MDYyNSwieSI6ODU1fSx7IngiOjEwMS4xNDA2MjUsInkiOjg4MH1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M361.157,830L359.696,834.167C358.235,838.333,355.313,846.667,353.852,854.333C352.391,862,352.391,869,352.391,872.5L352.391,876" id="L_G_I_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_G_I_0" data-points="W3sieCI6MzYxLjE1NzE1MTQ0MjMwNzcsInkiOjgzMH0seyJ4IjozNTIuMzkwNjI1LCJ5Ijo4NTV9LHsieCI6MzUyLjM5MDYyNSwieSI6ODgwfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M490.016,829.389L509.327,833.658C528.638,837.926,567.26,846.463,586.572,854.232C605.883,862,605.883,869,605.883,872.5L605.883,876" id="L_G_J_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_G_J_0" data-points="W3sieCI6NDkwLjAxNTYyNSwieSI6ODI5LjM4OTM5OTkyNjk0MTl9LHsieCI6NjA1Ljg4MjgxMjUsInkiOjg1NX0seyJ4Ijo2MDUuODgyODEyNSwieSI6ODgwfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M490.016,815.862L550.564,822.385C611.112,828.908,732.208,841.954,792.757,851.977C853.305,862,853.305,869,853.305,872.5L853.305,876" id="L_G_K_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_G_K_0" data-points="W3sieCI6NDkwLjAxNTYyNSwieSI6ODE1Ljg2MjE3ODkxNjUzMDR9LHsieCI6ODUzLjMwNDY4NzUsInkiOjg1NX0seyJ4Ijo4NTMuMzA0Njg3NSwieSI6ODgwfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M101.141,934L101.141,938.167C101.141,942.333,101.141,950.667,172.569,970.135C243.998,989.604,386.856,1020.207,458.285,1035.509L529.714,1050.811" id="L_H_L_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_H_L_0" data-points="W3sieCI6MTAxLjE0MDYyNSwieSI6OTM0fSx7IngiOjEwMS4xNDA2MjUsInkiOjk1OX0seyJ4Ijo1MzMuNjI0Nzk4MDgxNjg1NSwieSI6MTA1MS42NDg2Mzk0MTgzMTQ0fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M352.391,934L352.391,938.167C352.391,942.333,352.391,950.667,383.689,968.307C414.986,985.947,477.582,1012.893,508.88,1026.367L540.178,1039.84" id="L_I_L_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_I_L_0" data-points="W3sieCI6MzUyLjM5MDYyNSwieSI6OTM0fSx7IngiOjM1Mi4zOTA2MjUsInkiOjk1OX0seyJ4Ijo1NDMuODUxOTY1NzE2OTU4MSwieSI6MTA0MS40MjE0NzE3ODMwNDE5fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M605.883,934L605.883,938.167C605.883,942.333,605.883,950.667,605.708,958.899C605.533,967.131,605.183,975.261,605.008,979.326L604.833,983.392" id="L_J_L_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_J_L_0" data-points="W3sieCI6NjA1Ljg4MjgxMjUsInkiOjkzNH0seyJ4Ijo2MDUuODgyODEyNSwieSI6OTU5fSx7IngiOjYwNC42NjE1MDg1ODE1MTU3LCJ5Ijo5ODcuMzg4MDcxMDgxNTE1N31d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M853.305,934L853.305,938.167C853.305,942.333,853.305,950.667,821.519,968.346C789.734,986.024,726.163,1013.049,694.378,1026.561L662.593,1040.073" id="L_K_L_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_K_L_0" data-points="W3sieCI6ODUzLjMwNDY4NzUsInkiOjkzNH0seyJ4Ijo4NTMuMzA0Njg3NSwieSI6OTU5fSx7IngiOjY1OC45MTE1OTMwMzM1NjI0LCJ5IjoxMDQxLjYzODE1NTUzMzU2MjR9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M538.571,1085.579L484.969,1102.196C431.366,1118.813,324.162,1152.047,270.559,1179.331C216.957,1206.615,216.957,1227.948,216.957,1247.281C216.957,1266.615,216.957,1283.948,216.957,1301.281C216.957,1318.615,216.957,1335.948,216.957,1353.281C216.957,1370.615,216.957,1387.948,216.957,1414.471C216.957,1440.995,216.957,1476.708,216.957,1514.422C216.957,1552.135,216.957,1591.849,216.957,1622.372C216.957,1652.896,216.957,1674.229,216.957,1693.563C216.957,1712.896,216.957,1730.229,216.957,1747.563C216.957,1764.896,216.957,1782.229,216.957,1799.563C216.957,1816.896,216.957,1834.229,216.957,1851.563C216.957,1868.896,216.957,1886.229,216.957,1903.563C216.957,1920.896,216.957,1938.229,216.957,1955.563C216.957,1972.896,216.957,1990.229,216.957,2007.563C216.957,2024.896,216.957,2042.229,216.957,2068.753C216.957,2095.276,216.957,2130.99,216.957,2168.703C216.957,2206.417,216.957,2246.13,216.957,2276.654C216.957,2307.177,216.957,2328.51,216.957,2349.844C216.957,2371.177,216.957,2392.51,216.957,2413.844C216.957,2435.177,216.957,2456.51,216.957,2475.844C216.957,2495.177,216.957,2512.51,216.957,2529.844C216.957,2547.177,216.957,2564.51,216.957,2581.844C216.957,2599.177,216.957,2616.51,216.957,2633.844C216.957,2651.177,216.957,2668.51,216.957,2685.844C216.957,2703.177,216.957,2720.51,216.957,2747.034C216.957,2773.557,216.957,2809.271,216.957,2846.984C216.957,2884.698,216.957,2924.411,216.957,2954.935C216.957,2985.458,216.957,3006.792,216.957,3028.125C216.957,3049.458,216.957,3070.792,216.957,3102.057C216.957,3133.323,216.957,3174.521,216.957,3215.719C216.957,3256.917,216.957,3298.115,228.91,3324.586C240.863,3351.058,264.769,3362.803,276.722,3368.676L288.674,3374.549" id="L_L_M_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_L_M_0" data-points="W3sieCI6NTM4LjU3MDk4NjU1MDUxMDIsInkiOjEwODUuNTc4Nzk5MDUwNTF9LHsieCI6MjE2Ljk1NzAzMTI1LCJ5IjoxMTg1LjI4MTI1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MTI0OS4yODEyNX0seyJ4IjoyMTYuOTU3MDMxMjUsInkiOjEzMDEuMjgxMjV9LHsieCI6MjE2Ljk1NzAzMTI1LCJ5IjoxMzUzLjI4MTI1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MTQwNS4yODEyNX0seyJ4IjoyMTYuOTU3MDMxMjUsInkiOjE1MTIuNDIxODc1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MTYzMS41NjI1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MTY5NS41NjI1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MTc0Ny41NjI1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MTc5OS41NjI1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MTg1MS41NjI1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MTkwMy41NjI1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MTk1NS41NjI1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MjAwNy41NjI1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MjA1OS41NjI1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MjE2Ni43MDMxMjV9LHsieCI6MjE2Ljk1NzAzMTI1LCJ5IjoyMjg1Ljg0Mzc1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MjM0OS44NDM3NX0seyJ4IjoyMTYuOTU3MDMxMjUsInkiOjI0MTMuODQzNzV9LHsieCI6MjE2Ljk1NzAzMTI1LCJ5IjoyNDc3Ljg0Mzc1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MjUyOS44NDM3NX0seyJ4IjoyMTYuOTU3MDMxMjUsInkiOjI1ODEuODQzNzV9LHsieCI6MjE2Ljk1NzAzMTI1LCJ5IjoyNjMzLjg0Mzc1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MjY4NS44NDM3NX0seyJ4IjoyMTYuOTU3MDMxMjUsInkiOjI3MzcuODQzNzV9LHsieCI6MjE2Ljk1NzAzMTI1LCJ5IjoyODQ0Ljk4NDM3NX0seyJ4IjoyMTYuOTU3MDMxMjUsInkiOjI5NjQuMTI1fSx7IngiOjIxNi45NTcwMzEyNSwieSI6MzAyOC4xMjV9LHsieCI6MjE2Ljk1NzAzMTI1LCJ5IjozMDkyLjEyNX0seyJ4IjoyMTYuOTU3MDMxMjUsInkiOjMyMTUuNzE4NzV9LHsieCI6MjE2Ljk1NzAzMTI1LCJ5IjozMzM5LjMxMjV9LHsieCI6MjkyLjI2NDU4NzQwMjM0Mzc1LCJ5IjozMzc2LjMxMjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M623.629,1125.926L627.328,1135.818C631.027,1145.711,638.426,1165.496,642.125,1180.889C645.824,1196.281,645.824,1207.281,645.824,1212.781L645.824,1218.281" id="L_L_N_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_L_N_0" data-points="W3sieCI6NjIzLjYyOTA5NTAxNDAxOTgsInkiOjExMjUuOTI1NTkyNDg1OTgwMX0seyJ4Ijo2NDUuODI0MjE4NzUsInkiOjExODUuMjgxMjV9LHsieCI6NjQ1LjgyNDIxODc1LCJ5IjoxMjIyLjI4MTI1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M573.129,1261.083L531.86,1267.783C490.591,1274.482,408.053,1287.882,366.785,1298.082C325.516,1308.281,325.516,1315.281,325.516,1318.781L325.516,1322.281" id="L_N_O_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_N_O_0" data-points="W3sieCI6NTczLjEyODkwNjI1LCJ5IjoxMjYxLjA4Mjg1NzMzNjY3NDh9LHsieCI6MzI1LjUxNTYyNSwieSI6MTMwMS4yODEyNX0seyJ4IjozMjUuNTE1NjI1LCJ5IjoxMzI2LjI4MTI1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M589.482,1276.281L580.787,1280.448C572.092,1284.615,554.702,1292.948,546.007,1300.615C537.313,1308.281,537.313,1315.281,537.313,1318.781L537.313,1322.281" id="L_N_P_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_N_P_0" data-points="W3sieCI6NTg5LjQ4MTU5NTU1Mjg4NDYsInkiOjEyNzYuMjgxMjV9LHsieCI6NTM3LjMxMjUsInkiOjEzMDEuMjgxMjV9LHsieCI6NTM3LjMxMjUsInkiOjEzMjYuMjgxMjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M702.167,1276.281L710.862,1280.448C719.557,1284.615,736.946,1292.948,745.641,1300.615C754.336,1308.281,754.336,1315.281,754.336,1318.781L754.336,1322.281" id="L_N_Q_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_N_Q_0" data-points="W3sieCI6NzAyLjE2Njg0MTk0NzExNTQsInkiOjEyNzYuMjgxMjV9LHsieCI6NzU0LjMzNTkzNzUsInkiOjEzMDEuMjgxMjV9LHsieCI6NzU0LjMzNTkzNzUsInkiOjEzMjYuMjgxMjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M325.516,1380.281L325.516,1384.448C325.516,1388.615,325.516,1396.948,368.009,1415.328C410.503,1433.709,495.491,1462.137,537.985,1476.351L580.479,1490.564" id="L_O_R_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_O_R_0" data-points="W3sieCI6MzI1LjUxNTYyNSwieSI6MTM4MC4yODEyNX0seyJ4IjozMjUuNTE1NjI1LCJ5IjoxNDA1LjI4MTI1fSx7IngiOjU4NC4yNzIyMzMzMjI1MDA0LCJ5IjoxNDkxLjgzMzIzNTQyNzQ5OTZ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M537.313,1380.281L537.313,1384.448C537.313,1388.615,537.313,1396.948,548.035,1411.701C558.757,1426.455,580.202,1447.629,590.924,1458.215L601.646,1468.802" id="L_P_R_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_P_R_0" data-points="W3sieCI6NTM3LjMxMjUsInkiOjEzODAuMjgxMjV9LHsieCI6NTM3LjMxMjUsInkiOjE0MDUuMjgxMjV9LHsieCI6NjA0LjQ5Mjc4NTc0NTU4MDIsInkiOjE0NzEuNjEyNjgzMDA0NDE5OH1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M754.336,1380.281L754.336,1384.448C754.336,1388.615,754.336,1396.948,743.614,1411.701C732.891,1426.455,711.447,1447.629,700.724,1458.215L690.002,1468.802" id="L_Q_R_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Q_R_0" data-points="W3sieCI6NzU0LjMzNTkzNzUsInkiOjEzODAuMjgxMjV9LHsieCI6NzU0LjMzNTkzNzUsInkiOjE0MDUuMjgxMjV9LHsieCI6Njg3LjE1NTY1MTc1NDQxOTgsInkiOjE0NzEuNjEyNjgzMDA0NDE5OH1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M584.57,1533.309L536.546,1549.684C488.521,1566.06,392.471,1598.811,344.447,1625.854C296.422,1652.896,296.422,1674.229,296.422,1693.563C296.422,1712.896,296.422,1730.229,296.422,1747.563C296.422,1764.896,296.422,1782.229,296.422,1799.563C296.422,1816.896,296.422,1834.229,296.422,1851.563C296.422,1868.896,296.422,1886.229,296.422,1903.563C296.422,1920.896,296.422,1938.229,296.422,1955.563C296.422,1972.896,296.422,1990.229,296.422,2007.563C296.422,2024.896,296.422,2042.229,296.422,2068.753C296.422,2095.276,296.422,2130.99,296.422,2168.703C296.422,2206.417,296.422,2246.13,296.422,2276.654C296.422,2307.177,296.422,2328.51,296.422,2349.844C296.422,2371.177,296.422,2392.51,296.422,2413.844C296.422,2435.177,296.422,2456.51,296.422,2475.844C296.422,2495.177,296.422,2512.51,296.422,2529.844C296.422,2547.177,296.422,2564.51,296.422,2581.844C296.422,2599.177,296.422,2616.51,296.422,2633.844C296.422,2651.177,296.422,2668.51,296.422,2685.844C296.422,2703.177,296.422,2720.51,296.422,2747.034C296.422,2773.557,296.422,2809.271,296.422,2846.984C296.422,2884.698,296.422,2924.411,296.422,2954.935C296.422,2985.458,296.422,3006.792,296.422,3028.125C296.422,3049.458,296.422,3070.792,296.422,3102.057C296.422,3133.323,296.422,3174.521,296.422,3215.719C296.422,3256.917,296.422,3298.115,300.902,3324.358C305.382,3350.601,314.342,3361.89,318.822,3367.535L323.302,3373.179" id="L_R_M_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_R_M_0" data-points="W3sieCI6NTg0LjU3MDIyNzUzNDA4OCwieSI6MTUzMy4zMDg1MDg3ODQwODh9LHsieCI6Mjk2LjQyMTg3NSwieSI6MTYzMS41NjI1fSx7IngiOjI5Ni40MjE4NzUsInkiOjE2OTUuNTYyNX0seyJ4IjoyOTYuNDIxODc1LCJ5IjoxNzQ3LjU2MjV9LHsieCI6Mjk2LjQyMTg3NSwieSI6MTc5OS41NjI1fSx7IngiOjI5Ni40MjE4NzUsInkiOjE4NTEuNTYyNX0seyJ4IjoyOTYuNDIxODc1LCJ5IjoxOTAzLjU2MjV9LHsieCI6Mjk2LjQyMTg3NSwieSI6MTk1NS41NjI1fSx7IngiOjI5Ni40MjE4NzUsInkiOjIwMDcuNTYyNX0seyJ4IjoyOTYuNDIxODc1LCJ5IjoyMDU5LjU2MjV9LHsieCI6Mjk2LjQyMTg3NSwieSI6MjE2Ni43MDMxMjV9LHsieCI6Mjk2LjQyMTg3NSwieSI6MjI4NS44NDM3NX0seyJ4IjoyOTYuNDIxODc1LCJ5IjoyMzQ5Ljg0Mzc1fSx7IngiOjI5Ni40MjE4NzUsInkiOjI0MTMuODQzNzV9LHsieCI6Mjk2LjQyMTg3NSwieSI6MjQ3Ny44NDM3NX0seyJ4IjoyOTYuNDIxODc1LCJ5IjoyNTI5Ljg0Mzc1fSx7IngiOjI5Ni40MjE4NzUsInkiOjI1ODEuODQzNzV9LHsieCI6Mjk2LjQyMTg3NSwieSI6MjYzMy44NDM3NX0seyJ4IjoyOTYuNDIxODc1LCJ5IjoyNjg1Ljg0Mzc1fSx7IngiOjI5Ni40MjE4NzUsInkiOjI3MzcuODQzNzV9LHsieCI6Mjk2LjQyMTg3NSwieSI6Mjg0NC45ODQzNzV9LHsieCI6Mjk2LjQyMTg3NSwieSI6Mjk2NC4xMjV9LHsieCI6Mjk2LjQyMTg3NSwieSI6MzAyOC4xMjV9LHsieCI6Mjk2LjQyMTg3NSwieSI6MzA5Mi4xMjV9LHsieCI6Mjk2LjQyMTg3NSwieSI6MzIxNS43MTg3NX0seyJ4IjoyOTYuNDIxODc1LCJ5IjozMzM5LjMxMjV9LHsieCI6MzI1Ljc4ODgxODM1OTM3NSwieSI6MzM3Ni4zMTI1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M645.824,1594.563L645.824,1600.729C645.824,1606.896,645.824,1619.229,645.824,1630.896C645.824,1642.563,645.824,1653.563,645.824,1659.063L645.824,1664.563" id="L_R_S_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_R_S_0" data-points="W3sieCI6NjQ1LjgyNDIxODc1LCJ5IjoxNTk0LjU2MjV9LHsieCI6NjQ1LjgyNDIxODc1LCJ5IjoxNjMxLjU2MjV9LHsieCI6NjQ1LjgyNDIxODc1LCJ5IjoxNjY4LjU2MjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M645.824,1722.563L645.824,1726.729C645.824,1730.896,645.824,1739.229,645.824,1746.896C645.824,1754.563,645.824,1761.563,645.824,1765.063L645.824,1768.563" id="L_S_T_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_S_T_0" data-points="W3sieCI6NjQ1LjgyNDIxODc1LCJ5IjoxNzIyLjU2MjV9LHsieCI6NjQ1LjgyNDIxODc1LCJ5IjoxNzQ3LjU2MjV9LHsieCI6NjQ1LjgyNDIxODc1LCJ5IjoxNzcyLjU2MjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M645.824,1826.563L645.824,1830.729C645.824,1834.896,645.824,1843.229,645.824,1850.896C645.824,1858.563,645.824,1865.563,645.824,1869.063L645.824,1872.563" id="L_T_U_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_T_U_0" data-points="W3sieCI6NjQ1LjgyNDIxODc1LCJ5IjoxODI2LjU2MjV9LHsieCI6NjQ1LjgyNDIxODc1LCJ5IjoxODUxLjU2MjV9LHsieCI6NjQ1LjgyNDIxODc1LCJ5IjoxODc2LjU2MjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M645.824,1930.563L645.824,1934.729C645.824,1938.896,645.824,1947.229,645.824,1954.896C645.824,1962.563,645.824,1969.563,645.824,1973.063L645.824,1976.563" id="L_U_V_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_U_V_0" data-points="W3sieCI6NjQ1LjgyNDIxODc1LCJ5IjoxOTMwLjU2MjV9LHsieCI6NjQ1LjgyNDIxODc1LCJ5IjoxOTU1LjU2MjV9LHsieCI6NjQ1LjgyNDIxODc1LCJ5IjoxOTgwLjU2MjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M645.824,2034.563L645.824,2038.729C645.824,2042.896,645.824,2051.229,645.824,2058.896C645.824,2066.563,645.824,2073.563,645.824,2077.063L645.824,2080.563" id="L_V_W_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_V_W_0" data-points="W3sieCI6NjQ1LjgyNDIxODc1LCJ5IjoyMDM0LjU2MjV9LHsieCI6NjQ1LjgyNDIxODc1LCJ5IjoyMDU5LjU2MjV9LHsieCI6NjQ1LjgyNDIxODc1LCJ5IjoyMDg0LjU2MjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M590.148,2193.168L557.653,2208.614C525.157,2224.06,460.167,2254.952,427.671,2281.064C395.176,2307.177,395.176,2328.51,395.176,2349.844C395.176,2371.177,395.176,2392.51,395.176,2413.844C395.176,2435.177,395.176,2456.51,395.176,2475.844C395.176,2495.177,395.176,2512.51,395.176,2529.844C395.176,2547.177,395.176,2564.51,395.176,2581.844C395.176,2599.177,395.176,2616.51,395.176,2633.844C395.176,2651.177,395.176,2668.51,395.176,2685.844C395.176,2703.177,395.176,2720.51,395.176,2747.034C395.176,2773.557,395.176,2809.271,395.176,2846.984C395.176,2884.698,395.176,2924.411,395.176,2954.935C395.176,2985.458,395.176,3006.792,395.176,3028.125C395.176,3049.458,395.176,3070.792,395.176,3102.057C395.176,3133.323,395.176,3174.521,395.176,3215.719C395.176,3256.917,395.176,3298.115,390.955,3324.347C386.734,3350.579,378.291,3361.845,374.07,3367.478L369.849,3373.111" id="L_W_M_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_W_M_0" data-points="W3sieCI6NTkwLjE0ODEwMTIwMjUxNzMsInkiOjIxOTMuMTY3NjMyNDUyNTE3NH0seyJ4IjozOTUuMTc1NzgxMjUsInkiOjIyODUuODQzNzV9LHsieCI6Mzk1LjE3NTc4MTI1LCJ5IjoyMzQ5Ljg0Mzc1fSx7IngiOjM5NS4xNzU3ODEyNSwieSI6MjQxMy44NDM3NX0seyJ4IjozOTUuMTc1NzgxMjUsInkiOjI0NzcuODQzNzV9LHsieCI6Mzk1LjE3NTc4MTI1LCJ5IjoyNTI5Ljg0Mzc1fSx7IngiOjM5NS4xNzU3ODEyNSwieSI6MjU4MS44NDM3NX0seyJ4IjozOTUuMTc1NzgxMjUsInkiOjI2MzMuODQzNzV9LHsieCI6Mzk1LjE3NTc4MTI1LCJ5IjoyNjg1Ljg0Mzc1fSx7IngiOjM5NS4xNzU3ODEyNSwieSI6MjczNy44NDM3NX0seyJ4IjozOTUuMTc1NzgxMjUsInkiOjI4NDQuOTg0Mzc1fSx7IngiOjM5NS4xNzU3ODEyNSwieSI6Mjk2NC4xMjV9LHsieCI6Mzk1LjE3NTc4MTI1LCJ5IjozMDI4LjEyNX0seyJ4IjozOTUuMTc1NzgxMjUsInkiOjMwOTIuMTI1fSx7IngiOjM5NS4xNzU3ODEyNSwieSI6MzIxNS43MTg3NX0seyJ4IjozOTUuMTc1NzgxMjUsInkiOjMzMzkuMzEyNX0seyJ4IjozNjcuNDUwNjIyNTU4NTkzNzUsInkiOjMzNzYuMzEyNX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M667.256,2227.412L670.693,2237.151C674.131,2246.89,681.007,2266.367,684.445,2281.605C687.883,2296.844,687.883,2307.844,687.883,2313.344L687.883,2318.844" id="L_W_X_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_W_X_0" data-points="W3sieCI6NjY3LjI1NTU4MzAyMTA4ODIsInkiOjIyMjcuNDEyMzg1NzI4OTEyfSx7IngiOjY4Ny44ODI4MTI1LCJ5IjoyMjg1Ljg0Mzc1fSx7IngiOjY4Ny44ODI4MTI1LCJ5IjoyMzIyLjg0Mzc1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M687.883,2376.844L687.883,2383.01C687.883,2389.177,687.883,2401.51,687.883,2413.177C687.883,2424.844,687.883,2435.844,687.883,2441.344L687.883,2446.844" id="L_X_Y_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_X_Y_0" data-points="W3sieCI6Njg3Ljg4MjgxMjUsInkiOjIzNzYuODQzNzV9LHsieCI6Njg3Ljg4MjgxMjUsInkiOjI0MTMuODQzNzV9LHsieCI6Njg3Ljg4MjgxMjUsInkiOjI0NTAuODQzNzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M687.883,2504.844L687.883,2509.01C687.883,2513.177,687.883,2521.51,687.883,2529.177C687.883,2536.844,687.883,2543.844,687.883,2547.344L687.883,2550.844" id="L_Y_Z_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Y_Z_0" data-points="W3sieCI6Njg3Ljg4MjgxMjUsInkiOjI1MDQuODQzNzV9LHsieCI6Njg3Ljg4MjgxMjUsInkiOjI1MjkuODQzNzV9LHsieCI6Njg3Ljg4MjgxMjUsInkiOjI1NTQuODQzNzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M687.883,2608.844L687.883,2613.01C687.883,2617.177,687.883,2625.51,687.883,2633.177C687.883,2640.844,687.883,2647.844,687.883,2651.344L687.883,2654.844" id="L_Z_AA_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Z_AA_0" data-points="W3sieCI6Njg3Ljg4MjgxMjUsInkiOjI2MDguODQzNzV9LHsieCI6Njg3Ljg4MjgxMjUsInkiOjI2MzMuODQzNzV9LHsieCI6Njg3Ljg4MjgxMjUsInkiOjI2NTguODQzNzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M687.883,2712.844L687.883,2717.01C687.883,2721.177,687.883,2729.51,687.883,2737.177C687.883,2744.844,687.883,2751.844,687.883,2755.344L687.883,2758.844" id="L_AA_AB_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_AA_AB_0" data-points="W3sieCI6Njg3Ljg4MjgxMjUsInkiOjI3MTIuODQzNzV9LHsieCI6Njg3Ljg4MjgxMjUsInkiOjI3MzcuODQzNzV9LHsieCI6Njg3Ljg4MjgxMjUsInkiOjI3NjIuODQzNzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M636.641,2875.883L612.251,2890.59C587.861,2905.297,539.081,2934.711,514.691,2960.085C490.301,2985.458,490.301,3006.792,490.301,3028.125C490.301,3049.458,490.301,3070.792,490.301,3102.057C490.301,3133.323,490.301,3174.521,490.301,3215.719C490.301,3256.917,490.301,3298.115,477.123,3324.608C463.945,3351.101,437.589,3362.89,424.411,3368.785L411.233,3374.679" id="L_AB_M_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_AB_M_0" data-points="W3sieCI6NjM2LjY0MDc4MzUwMjc2MjcsInkiOjI4NzUuODgyOTcxMDAyNzYyNn0seyJ4Ijo0OTAuMzAwNzgxMjUsInkiOjI5NjQuMTI1fSx7IngiOjQ5MC4zMDA3ODEyNSwieSI6MzAyOC4xMjV9LHsieCI6NDkwLjMwMDc4MTI1LCJ5IjozMDkyLjEyNX0seyJ4Ijo0OTAuMzAwNzgxMjUsInkiOjMyMTUuNzE4NzV9LHsieCI6NDkwLjMwMDc4MTI1LCJ5IjozMzM5LjMxMjV9LHsieCI6NDA3LjU4MTQ4MTkzMzU5Mzc1LCJ5IjozMzc2LjMxMjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M716.479,2898.529L722.318,2909.461C728.157,2920.394,739.834,2942.26,745.673,2958.692C751.512,2975.125,751.512,2986.125,751.512,2991.625L751.512,2997.125" id="L_AB_AC_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_AB_AC_0" data-points="W3sieCI6NzE2LjQ3OTAzNDcwMjMzMzksInkiOjI4OTguNTI4Nzc3Nzk3NjY2fSx7IngiOjc1MS41MTE3MTg3NSwieSI6Mjk2NC4xMjV9LHsieCI6NzUxLjUxMTcxODc1LCJ5IjozMDAxLjEyNX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M751.512,3055.125L751.512,3061.292C751.512,3067.458,751.512,3079.792,751.512,3091.458C751.512,3103.125,751.512,3114.125,751.512,3119.625L751.512,3125.125" id="L_AC_AD_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_AC_AD_0" data-points="W3sieCI6NzUxLjUxMTcxODc1LCJ5IjozMDU1LjEyNX0seyJ4Ijo3NTEuNTExNzE4NzUsInkiOjMwOTIuMTI1fSx7IngiOjc1MS41MTE3MTg3NSwieSI6MzEyOS4xMjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M701.15,3251.951L680.911,3266.511C660.673,3281.071,620.196,3310.192,578.198,3330.742C536.2,3351.292,492.68,3363.271,470.921,3369.261L449.161,3375.251" id="L_AD_M_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_AD_M_0" data-points="W3sieCI6NzAxLjE0OTk1MDc5MTU1MDQsInkiOjMyNTEuOTUwNzMyMDQxNTUwNX0seyJ4Ijo1NzkuNzE4NzUsInkiOjMzMzkuMzEyNX0seyJ4Ijo0NDUuMzA0Njg3NSwieSI6MzM3Ni4zMTI1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M773.83,3279.995L777.262,3289.881C780.695,3299.767,787.56,3319.54,790.993,3334.926C794.426,3350.313,794.426,3361.313,794.426,3366.813L794.426,3372.313" id="L_AD_AE_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_AD_AE_0" data-points="W3sieCI6NzczLjgyOTUyODAwOTYwNjksInkiOjMyNzkuOTk0NjkwNzQwMzkzM30seyJ4Ijo3OTQuNDI1NzgxMjUsInkiOjMzMzkuMzEyNX0seyJ4Ijo3OTQuNDI1NzgxMjUsInkiOjMzNzYuMzEyNX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M794.426,3430.313L794.426,3434.479C794.426,3438.646,794.426,3446.979,794.426,3454.646C794.426,3462.313,794.426,3469.313,794.426,3472.813L794.426,3476.313" id="L_AE_AF_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_AE_AF_0" data-points="W3sieCI6Nzk0LjQyNTc4MTI1LCJ5IjozNDMwLjMxMjV9LHsieCI6Nzk0LjQyNTc4MTI1LCJ5IjozNDU1LjMxMjV9LHsieCI6Nzk0LjQyNTc4MTI1LCJ5IjozNDgwLjMxMjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M794.426,3534.313L794.426,3538.479C794.426,3542.646,794.426,3550.979,794.426,3558.646C794.426,3566.313,794.426,3573.313,794.426,3576.813L794.426,3580.313" id="L_AF_AG_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_AF_AG_0" data-points="W3sieCI6Nzk0LjQyNTc4MTI1LCJ5IjozNTM0LjMxMjV9LHsieCI6Nzk0LjQyNTc4MTI1LCJ5IjozNTU5LjMxMjV9LHsieCI6Nzk0LjQyNTc4MTI1LCJ5IjozNTg0LjMxMjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" data-id="L_A_B_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_B_C_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(126.3515625, 531)"><g class="label" data-id="L_C_D_0" transform="translate(-10.2265625, -12)"><foreignObject width="20.453125" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
No
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(370.625, 531)"><g class="label" data-id="L_C_E_0" transform="translate(-13.0546875, -12)"><foreignObject width="26.109375" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Yes
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_E_F_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_F_G_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_G_H_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_G_I_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_G_J_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_G_K_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_H_L_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_I_L_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_J_L_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_K_L_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(216.95703125, 2166.703125)"><g class="label" data-id="L_L_M_0" transform="translate(-21.7890625, -12)"><foreignObject width="43.578125" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Failed
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(645.82421875, 1185.28125)"><g class="label" data-id="L_L_N_0" transform="translate(-26.6875, -12)"><foreignObject width="53.375" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Passed
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_N_O_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_N_P_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_N_Q_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_O_R_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_P_R_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_Q_R_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(296.421875, 2413.84375)"><g class="label" data-id="L_R_M_0" transform="translate(-21.7890625, -12)"><foreignObject width="43.578125" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Failed
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(645.82421875, 1631.5625)"><g class="label" data-id="L_R_S_0" transform="translate(-26.6875, -12)"><foreignObject width="53.375" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Passed
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_S_T_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_T_U_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_U_V_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_V_W_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(395.17578125, 2685.84375)"><g class="label" data-id="L_W_M_0" transform="translate(-21.7890625, -12)"><foreignObject width="43.578125" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Failed
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(687.8828125, 2285.84375)"><g class="label" data-id="L_W_X_0" transform="translate(-26.6875, -12)"><foreignObject width="53.375" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Passed
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_X_Y_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_Y_Z_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_Z_AA_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_AA_AB_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(490.30078125, 3092.125)"><g class="label" data-id="L_AB_M_0" transform="translate(-21.7890625, -12)"><foreignObject width="43.578125" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Failed
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(751.51171875, 2964.125)"><g class="label" data-id="L_AB_AC_0" transform="translate(-26.6875, -12)"><foreignObject width="53.375" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Passed
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_AC_AD_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(583.84973, 3336.34053)"><g class="label" data-id="L_AD_M_0" transform="translate(-31.578125, -12)"><foreignObject width="63.15625" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Rejected
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(794.42578125, 3339.3125)"><g class="label" data-id="L_AD_AE_0" transform="translate(-34.25, -12)"><foreignObject width="68.5" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Approved
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_AE_AF_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_AF_AG_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-0" transform="translate(248.48828125, 35)"><rect class="basic label-container" style="" x="-121.59375" y="-27" width="243.1875" height="54"/><g class="label" style="" transform="translate(-91.59375, -12)"><rect/><foreignObject width="183.1875" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Developer Commits Code
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-B-1" transform="translate(248.48828125, 139)"><rect class="basic label-container" style="" x="-97.5703125" y="-27" width="195.140625" height="54"/><g class="label" style="" transform="translate(-67.5703125, -12)"><rect/><foreignObject width="135.140625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Pre-Commit Hooks
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-C-3" transform="translate(248.48828125, 355)"><polygon points="139,0 278,-139 139,-278 0,-139" class="label-container" transform="translate(-138.5, 139)"/><g class="label" style="" transform="translate(-100, -24)"><rect/><foreignObject width="200" height="48">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;">
<span class="nodeLabel">
<p>
Local Security Checks Pass?
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-D-5" transform="translate(126.3515625, 595)"><rect class="basic label-container" style="" x="-88.2421875" y="-27" width="176.484375" height="54"/><g class="label" style="" transform="translate(-58.2421875, -12)"><rect/><foreignObject width="116.484375" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Commit Blocked
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-E-7" transform="translate(370.625, 595)"><rect class="basic label-container" style="" x="-106.03125" y="-27" width="212.0625" height="54"/><g class="label" style="" transform="translate(-76.03125, -12)"><rect/><foreignObject width="152.0625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Push to CodeCommit
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-F-9" transform="translate(370.625, 699)"><rect class="basic label-container" style="" x="-102.9375" y="-27" width="205.875" height="54"/><g class="label" style="" transform="translate(-72.9375, -12)"><rect/><foreignObject width="145.875" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
CodeBuild Triggered
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-G-11" transform="translate(370.625, 803)"><rect class="basic label-container" style="" x="-119.390625" y="-27" width="238.78125" height="54"/><g class="label" style="" transform="translate(-89.390625, -12)"><rect/><foreignObject width="178.78125" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Security Scanning Phase
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-H-13" transform="translate(101.140625, 907)"><rect class="basic label-container" style="" x="-93.140625" y="-27" width="186.28125" height="54"/><g class="label" style="" transform="translate(-63.140625, -12)"><rect/><foreignObject width="126.28125" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Secrets Detection
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-I-15" transform="translate(352.390625, 907)"><rect class="basic label-container" style="" x="-108.109375" y="-27" width="216.21875" height="54"/><g class="label" style="" transform="translate(-78.109375, -12)"><rect/><foreignObject width="156.21875" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
SAST - GoSec/ESLint
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-J-17" transform="translate(605.8828125, 907)"><rect class="basic label-container" style="" x="-95.3828125" y="-27" width="190.765625" height="54"/><g class="label" style="" transform="translate(-65.3828125, -12)"><rect/><foreignObject width="130.765625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Dependency Scan
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-K-19" transform="translate(853.3046875, 907)"><rect class="basic label-container" style="" x="-102.0390625" y="-27" width="204.078125" height="54"/><g class="label" style="" transform="translate(-72.0390625, -12)"><rect/><foreignObject width="144.078125" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
License Compliance
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-L-21" transform="translate(601.2734375, 1066.140625)"><polygon points="82.140625,0 164.28125,-82.140625 82.140625,-164.28125 0,-82.140625" class="label-container" transform="translate(-81.640625, 82.140625)" style="fill:#fff3e0 !important"/><g class="label" style="" transform="translate(-55.140625, -12)"><rect/><foreignObject width="110.28125" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Security Gate 1
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-M-29" transform="translate(347.21875, 3403.3125)"><rect class="basic label-container" style="" x="-99.359375" y="-27" width="198.71875" height="54"/><g class="label" style="" transform="translate(-69.359375, -12)"><rect/><foreignObject width="138.71875" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Build Failed - Notify
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-N-31" transform="translate(645.82421875, 1249.28125)"><rect class="basic label-container" style="" x="-72.6953125" y="-27" width="145.390625" height="54"/><g class="label" style="" transform="translate(-42.6953125, -12)"><rect/><foreignObject width="85.390625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Build Phase
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-O-33" transform="translate(325.515625, 1353.28125)"><rect class="basic label-container" style="" x="-64.9765625" y="-27" width="129.953125" height="54"/><g class="label" style="" transform="translate(-34.9765625, -12)"><rect/><foreignObject width="69.953125" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Unit Tests
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-P-35" transform="translate(537.3125, 1353.28125)"><rect class="basic label-container" style="" x="-88.5546875" y="-27" width="177.109375" height="54"/><g class="label" style="" transform="translate(-58.5546875, -12)"><rect/><foreignObject width="117.109375" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Integration Tests
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-Q-37" transform="translate(754.3359375, 1353.28125)"><rect class="basic label-container" style="" x="-78.46875" y="-27" width="156.9375" height="54"/><g class="label" style="" transform="translate(-48.46875, -12)"><rect/><foreignObject width="96.9375" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Build Artifacts
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-R-39" transform="translate(645.82421875, 1512.421875)"><polygon points="82.140625,0 164.28125,-82.140625 82.140625,-164.28125 0,-82.140625" class="label-container" transform="translate(-81.640625, 82.140625)" style="fill:#fff3e0 !important"/><g class="label" style="" transform="translate(-55.140625, -12)"><rect/><foreignObject width="110.28125" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Security Gate 2
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-S-47" transform="translate(645.82421875, 1695.5625)"><rect class="basic label-container" style="" x="-120.71875" y="-27" width="241.4375" height="54"/><g class="label" style="" transform="translate(-90.71875, -12)"><rect/><foreignObject width="181.4375" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Container Security Phase
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-T-49" transform="translate(645.82421875, 1799.5625)"><rect class="basic label-container" style="" x="-99.8125" y="-27" width="199.625" height="54"/><g class="label" style="" transform="translate(-69.8125, -12)"><rect/><foreignObject width="139.625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Build Docker Image
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-U-51" transform="translate(645.82421875, 1903.5625)"><rect class="basic label-container" style="" x="-109.140625" y="-27" width="218.28125" height="54"/><g class="label" style="" transform="translate(-79.140625, -12)"><rect/><foreignObject width="158.28125" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Container Scan - Trivy
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-V-53" transform="translate(645.82421875, 2007.5625)"><rect class="basic label-container" style="" x="-102.484375" y="-27" width="204.96875" height="54"/><g class="label" style="" transform="translate(-72.484375, -12)"><rect/><foreignObject width="144.96875" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Image Sign - Cosign
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-W-55" transform="translate(645.82421875, 2166.703125)"><polygon points="82.140625,0 164.28125,-82.140625 82.140625,-164.28125 0,-82.140625" class="label-container" transform="translate(-81.640625, 82.140625)" style="fill:#fff3e0 !important"/><g class="label" style="" transform="translate(-55.140625, -12)"><rect/><foreignObject width="110.28125" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Security Gate 3
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-X-59" transform="translate(687.8828125, 2349.84375)"><rect class="basic label-container" style="" x="-76.2421875" y="-27" width="152.484375" height="54"/><g class="label" style="" transform="translate(-46.2421875, -12)"><rect/><foreignObject width="92.484375" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Push to ECR
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-Y-61" transform="translate(687.8828125, 2477.84375)"><rect class="basic label-container" style="" x="-93.15625" y="-27" width="186.3125" height="54"/><g class="label" style="" transform="translate(-63.15625, -12)"><rect/><foreignObject width="126.3125" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Deploy to Staging
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-Z-63" transform="translate(687.8828125, 2581.84375)"><rect class="basic label-container" style="" x="-105.421875" y="-27" width="210.84375" height="54"/><g class="label" style="" transform="translate(-75.421875, -12)"><rect/><foreignObject width="150.84375" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
DAST - OWASP ZAP
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-AA-65" transform="translate(687.8828125, 2685.84375)"><rect class="basic label-container" style="" x="-91.671875" y="-27" width="183.34375" height="54"/><g class="label" style="" transform="translate(-61.671875, -12)"><rect/><foreignObject width="123.34375" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Penetration Tests
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-AB-67" transform="translate(687.8828125, 2844.984375)"><polygon points="82.140625,0 164.28125,-82.140625 82.140625,-164.28125 0,-82.140625" class="label-container" transform="translate(-81.640625, 82.140625)" style="fill:#ffebee !important"/><g class="label" style="" transform="translate(-55.140625, -12)"><rect/><foreignObject width="110.28125" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Security Gate 4
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-AC-71" transform="translate(751.51171875, 3028.125)"><rect class="basic label-container" style="" x="-92.2578125" y="-27" width="184.515625" height="54"/><g class="label" style="" transform="translate(-62.2578125, -12)"><rect/><foreignObject width="124.515625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Security Approval
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-AD-73" transform="translate(751.51171875, 3215.71875)"><polygon points="86.59375,0 173.1875,-86.59375 86.59375,-173.1875 0,-86.59375" class="label-container" transform="translate(-86.09375, 86.59375)" style="fill:#ffebee !important"/><g class="label" style="" transform="translate(-59.59375, -12)"><rect/><foreignObject width="119.1875" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Manual Approval
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-AE-77" transform="translate(794.42578125, 3403.3125)"><rect class="basic label-container" style="fill:#e8f5e9 !important" x="-104.265625" y="-27" width="208.53125" height="54"/><g class="label" style="" transform="translate(-74.265625, -12)"><rect/><foreignObject width="148.53125" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Deploy to Production
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-AF-79" transform="translate(794.42578125, 3507.3125)"><rect class="basic label-container" style="" x="-107.8203125" y="-27" width="215.640625" height="54"/><g class="label" style="" transform="translate(-77.8203125, -12)"><rect/><foreignObject width="155.640625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Production Monitoring
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-AG-81" transform="translate(794.42578125, 3611.3125)"><rect class="basic label-container" style="" x="-81.1328125" y="-27" width="162.265625" height="54"/><g class="label" style="" transform="translate(-51.1328125, -12)"><rect/><foreignObject width="102.265625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Security Alerts
</p>
</span>
</div>
</foreignObject></g></g></g></g></g>
</svg>
</div>
<hr />
<h2 id="security-pipeline-architecture">Security Pipeline
Architecture</h2>
<h3 id="pipeline-stages">Pipeline Stages</h3>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete CI/CD Security Pipeline Configuration</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pipeline_stages</span><span class="kw">:</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">stage_1_pre_commit</span><span class="kw">:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Developer Workstation&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">security_controls</span><span class="kw">:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Secrets detection (git-secrets, gitleaks)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> SAST (GoSec, ESLint)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Code formatting and linting</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Unit tests with security scenarios</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> pre-commit hooks</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> husky (for JavaScript)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">gate</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Block commit if critical issues found&quot;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">stage_2_commit_validation</span><span class="kw">:</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;AWS CodeCommit&quot;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">security_controls</span><span class="kw">:</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Branch protection rules</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Signed commits validation</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> PR security checklist</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Code review requirements</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> AWS CodeCommit</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Git hooks</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">gate</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Require security team review for sensitive changes&quot;</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">stage_3_build_security</span><span class="kw">:</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;AWS CodeBuild - Security Phase&quot;</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">security_controls</span><span class="kw">:</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Secrets scanning (full repository)</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> SAST (GoSec, ESLint, Semgrep)</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Dependency vulnerability scanning (Nancy, npm audit)</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> License compliance checking</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Code coverage analysis</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> AWS CodeBuild</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Security scanning tools</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">gate</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Fail build if critical vulnerabilities found&quot;</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">stage_4_artifact_build</span><span class="kw">:</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;AWS CodeBuild - Build Phase&quot;</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">security_controls</span><span class="kw">:</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Secure build environment</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Immutable artifact creation</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Build provenance generation</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> SBOM generation</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> AWS CodeBuild</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Docker</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Go build tools</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">gate</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Build must succeed with all tests passing&quot;</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">stage_5_container_security</span><span class="kw">:</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Container Security Validation&quot;</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">security_controls</span><span class="kw">:</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Container image scanning (Trivy, ECR scanning)</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Base image validation</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Container configuration security</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Image signing (Cosign)</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Trivy</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> AWS ECR</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Cosign</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">gate</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Block deployment if high/critical vulnerabilities found&quot;</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">stage_6_staging_deployment</span><span class="kw">:</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Staging Environment&quot;</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">security_controls</span><span class="kw">:</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> DAST scanning (OWASP ZAP)</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> API security testing</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Integration security tests</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Performance security tests</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> OWASP ZAP</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Custom security tests</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">gate</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;All security tests must pass&quot;</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">stage_7_production_approval</span><span class="kw">:</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Security Approval Gate&quot;</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">security_controls</span><span class="kw">:</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Security team review</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Compliance validation</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Risk assessment</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Change approval</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Manual review process</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> AWS CodePipeline approval action</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">gate</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Require explicit security approval&quot;</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">stage_8_production_deployment</span><span class="kw">:</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Production Environment&quot;</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">security_controls</span><span class="kw">:</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Blue-green deployment</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Canary deployment</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Automatic rollback on security alerts</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Production security monitoring</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> AWS ECS</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> CloudWatch</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Custom deployment scripts</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">gate</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Health checks and security monitoring must pass&quot;</span></span></code></pre></div>
<hr />
<h2 id="pre-commit-security-hooks">Pre-Commit Security Hooks</h2>
<h3 id="git-pre-commit-configuration">Git Pre-Commit Configuration</h3>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># .git/hooks/pre-commit</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># SECURAA Pre-Commit Security Hook</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="at">-e</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;🔒 Running SECURAA Pre-Commit Security Checks...&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Color codes for output</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="va">RED</span><span class="op">=</span><span class="st">&#39;\033[0;31m&#39;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="va">GREEN</span><span class="op">=</span><span class="st">&#39;\033[0;32m&#39;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="va">YELLOW</span><span class="op">=</span><span class="st">&#39;\033[1;33m&#39;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="va">NC</span><span class="op">=</span><span class="st">&#39;\033[0m&#39;</span> <span class="co"># No Color</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Track if any checks fail</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="va">CHECKS_FAILED</span><span class="op">=</span>0</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Secrets Detection</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;\n</span><span class="va">${YELLOW}</span><span class="st">[1/6] Checking for secrets...</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">command</span> <span class="at">-v</span> gitleaks <span class="op">&amp;&gt;</span> /dev/null<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="ot">! </span><span class="ex">gitleaks</span> protect <span class="at">--staged</span> <span class="at">--verbose</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${RED}</span><span class="st">❌ Secrets detected in staged files!</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">CHECKS_FAILED</span><span class="op">=</span>1</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${GREEN}</span><span class="st">✅ No secrets detected</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${YELLOW}</span><span class="st">⚠️  gitleaks not installed, skipping secrets check</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Go Security Scanning</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;\n</span><span class="va">${YELLOW}</span><span class="st">[2/6] Running GoSec security scan...</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">command</span> <span class="at">-v</span> gosec <span class="op">&amp;&gt;</span> /dev/null<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get list of staged Go files</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="va">GO_FILES</span><span class="op">=</span><span class="va">$(</span><span class="fu">git</span> diff <span class="at">--cached</span> <span class="at">--name-only</span> <span class="at">--diff-filter</span><span class="op">=</span>ACM <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&#39;\.go$&#39;</span> <span class="kw">||</span> <span class="fu">true</span><span class="va">)</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="ot">-n</span> <span class="st">&quot;</span><span class="va">$GO_FILES</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="ot">! </span><span class="ex">gosec</span> <span class="at">-quiet</span> ./...<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${RED}</span><span class="st">❌ GoSec found security issues!</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>            <span class="va">CHECKS_FAILED</span><span class="op">=</span>1</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${GREEN}</span><span class="st">✅ GoSec scan passed</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">fi</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${GREEN}</span><span class="st">✅ No Go files to scan</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${YELLOW}</span><span class="st">⚠️  gosec not installed, skipping Go security scan</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Go Dependency Check</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;\n</span><span class="va">${YELLOW}</span><span class="st">[3/6] Checking Go dependencies for vulnerabilities...</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">command</span> <span class="at">-v</span> nancy <span class="op">&amp;&gt;</span> /dev/null<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="ot">! </span><span class="ex">go</span> list <span class="at">-json</span> <span class="at">-m</span> all <span class="kw">|</span> <span class="ex">nancy</span> sleuth <span class="at">--quiet</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${RED}</span><span class="st">❌ Vulnerable dependencies detected!</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        <span class="va">CHECKS_FAILED</span><span class="op">=</span>1</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${GREEN}</span><span class="st">✅ No vulnerable dependencies</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${YELLOW}</span><span class="st">⚠️  nancy not installed, skipping dependency check</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. JavaScript/TypeScript Security Linting</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;\n</span><span class="va">${YELLOW}</span><span class="st">[4/6] Running ESLint security checks...</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a><span class="va">JS_FILES</span><span class="op">=</span><span class="va">$(</span><span class="fu">git</span> diff <span class="at">--cached</span> <span class="at">--name-only</span> <span class="at">--diff-filter</span><span class="op">=</span>ACM <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-E</span> <span class="st">&#39;\.(js|jsx|ts|tsx)$&#39;</span> <span class="kw">||</span> <span class="fu">true</span><span class="va">)</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-n</span> <span class="st">&quot;</span><span class="va">$JS_FILES</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">command</span> <span class="at">-v</span> eslint <span class="op">&amp;&gt;</span> /dev/null<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="ot">! </span><span class="ex">eslint</span> <span class="va">$JS_FILES</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${RED}</span><span class="st">❌ ESLint security issues found!</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>            <span class="va">CHECKS_FAILED</span><span class="op">=</span>1</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${GREEN}</span><span class="st">✅ ESLint checks passed</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">fi</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${YELLOW}</span><span class="st">⚠️  eslint not installed, skipping JavaScript security check</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${GREEN}</span><span class="st">✅ No JavaScript files to check</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. License Compliance Check</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;\n</span><span class="va">${YELLOW}</span><span class="st">[5/6] Checking license compliance...</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if go.mod was modified</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">git</span> diff <span class="at">--cached</span> <span class="at">--name-only</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-q</span> <span class="st">&quot;go.mod&quot;</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">command</span> <span class="at">-v</span> go-licenses <span class="op">&amp;&gt;</span> /dev/null<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="ot">! </span><span class="ex">go-licenses</span> check ./...<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${RED}</span><span class="st">❌ License compliance issues found!</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>            <span class="va">CHECKS_FAILED</span><span class="op">=</span>1</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${GREEN}</span><span class="st">✅ License compliance check passed</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">fi</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${YELLOW}</span><span class="st">⚠️  go-licenses not installed, skipping license check</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${GREEN}</span><span class="st">✅ No dependency changes to check</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Run Unit Tests with Security Focus</span></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;\n</span><span class="va">${YELLOW}</span><span class="st">[6/6] Running unit tests...</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-f</span> <span class="st">&quot;Makefile&quot;</span> <span class="bu">]</span> <span class="kw">&amp;&amp;</span> <span class="fu">grep</span> <span class="at">-q</span> <span class="st">&quot;^test:&quot;</span> Makefile<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="ot">! </span><span class="fu">make</span> test-fast<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${RED}</span><span class="st">❌ Unit tests failed!</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>        <span class="va">CHECKS_FAILED</span><span class="op">=</span>1</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${GREEN}</span><span class="st">✅ Unit tests passed</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> <span class="bu">[</span> <span class="ot">-f</span> <span class="st">&quot;go.mod&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="ot">! </span><span class="ex">go</span> test <span class="at">-short</span> ./...<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${RED}</span><span class="st">❌ Go tests failed!</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>        <span class="va">CHECKS_FAILED</span><span class="op">=</span>1</span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${GREEN}</span><span class="st">✅ Go tests passed</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${YELLOW}</span><span class="st">⚠️  No test configuration found, skipping tests</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Final result</span></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;\n</span><span class="va">${YELLOW}</span><span class="st">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$CHECKS_FAILED</span> <span class="ot">-eq</span> 1 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${RED}</span><span class="st">❌ Pre-commit checks FAILED!</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${RED}</span><span class="st">Please fix the issues above before committing.</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${YELLOW}</span><span class="st">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>    <span class="bu">exit</span> 1</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${GREEN}</span><span class="st">✅ All pre-commit checks PASSED!</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${YELLOW}</span><span class="st">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><span class="va">${NC}</span><span class="st">&quot;</span></span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>    <span class="bu">exit</span> 0</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span></code></pre></div>
<h3 id="pre-commit-installation-script">Pre-Commit Installation
Script</h3>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install-pre-commit-hooks.sh</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Installing SECURAA Pre-Commit Security Hooks...&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Make hooks directory if it doesn&#39;t exist</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> .git/hooks</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy pre-commit hook</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> scripts/pre-commit .git/hooks/pre-commit</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> +x .git/hooks/pre-commit</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Install security tools if not present</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Checking for required security tools...&quot;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Install gitleaks</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="ot">! </span><span class="bu">command</span> <span class="at">-v</span> gitleaks <span class="op">&amp;&gt;</span> /dev/null<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Installing gitleaks...&quot;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="ex">go</span> install github.com/zricethezav/gitleaks/v8@latest</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Install gosec</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="ot">! </span><span class="bu">command</span> <span class="at">-v</span> gosec <span class="op">&amp;&gt;</span> /dev/null<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Installing gosec...&quot;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="ex">go</span> install github.com/securego/gosec/v2/cmd/gosec@latest</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Install nancy</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="ot">! </span><span class="bu">command</span> <span class="at">-v</span> nancy <span class="op">&amp;&gt;</span> /dev/null<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Installing nancy...&quot;</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="ex">go</span> install github.com/sonatype-nexus-community/nancy@latest</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Install go-licenses</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="ot">! </span><span class="bu">command</span> <span class="at">-v</span> go-licenses <span class="op">&amp;&gt;</span> /dev/null<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Installing go-licenses...&quot;</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="ex">go</span> install github.com/google/go-licenses@latest</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;✅ Pre-commit hooks installed successfully!&quot;</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Run &#39;git commit&#39; to trigger security checks.&quot;</span></span></code></pre></div>
<hr />
<h2 id="aws-codebuild-security-integration">AWS CodeBuild Security
Integration</h2>
<h3 id="complete-security-buildspec">Complete Security BuildSpec</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># buildspec-security.yml - Dedicated Security Scanning Phase</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.2</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">variables</span><span class="kw">:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">SECURITY_SCAN_ENABLED</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;true&quot;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">FAIL_ON_CRITICAL</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;true&quot;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">FAIL_ON_HIGH</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;false&quot;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">MAX_HIGH_VULNERABILITIES</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;10&quot;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">parameter-store</span><span class="kw">:</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">SNYK_TOKEN</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;/securaa/security/snyk-token&quot;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">SONARQUBE_TOKEN</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;/securaa/security/sonarqube-token&quot;</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">phases</span><span class="kw">:</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">install</span><span class="kw">:</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">runtime-versions</span><span class="kw">:</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">golang</span><span class="kw">:</span><span class="at"> </span><span class="fl">1.17</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">nodejs</span><span class="kw">:</span><span class="at"> </span><span class="dv">16</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">python</span><span class="kw">:</span><span class="at"> </span><span class="fl">3.9</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Installing security scanning tools...&quot;</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co">      # Install Go security tools</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go install github.com/securego/gosec/v2/cmd/gosec@latest</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go install github.com/sonatype-nexus-community/nancy@latest</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go install golang.org/x/vuln/cmd/govulncheck@latest</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go install github.com/google/go-licenses@latest</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co">      # Install gitleaks</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> wget https://github.com/zricethezav/gitleaks/releases/download/v8.18.0/gitleaks_8.18.0_linux_x64.tar.gz</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> tar -xzf gitleaks_8.18.0_linux_x64.tar.gz</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> mv gitleaks /usr/local/bin/</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> chmod +x /usr/local/bin/gitleaks</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="co">      # Install Trivy</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> wget -qO - https://aquasecurity.github.io/trivy-repo/deb/public.key | apt-key add -</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;deb https://aquasecurity.github.io/trivy-repo/deb $(lsb_release -sc) main&quot; | tee -a /etc/apt/sources.list.d/trivy.list</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> apt-get update</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> apt-get install -y trivy</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="co">      # Install JavaScript security tools</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> npm install -g eslint eslint-plugin-security snyk</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a><span class="co">      # Install Python tools</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> pip3 install bandit safety</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pre_build</span><span class="kw">:</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Starting comprehensive security scanning...&quot;</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> mkdir -p security-reports</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a><span class="co">      # ========================================</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a><span class="co">      # 1. SECRETS DETECTION</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a><span class="co">      # ========================================</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running secrets detection with gitleaks...&quot;</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>        gitleaks detect \</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>          --source . \</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>          --report-path security-reports/gitleaks-report.json \</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>          --report-format json \</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>          --verbose || {</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>            echo &quot;❌ SECURITY ALERT: Secrets detected in repository!&quot;</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>            cat security-reports/gitleaks-report.json</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>            if [ &quot;$FAIL_ON_CRITICAL&quot; = &quot;true&quot; ]; then</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>              exit 1</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>            fi</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a><span class="co">      # ========================================</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a><span class="co">      # 2. STATIC APPLICATION </span><span class="al">SECURITY</span><span class="co"> </span><span class="al">TESTING</span><span class="co"> (SAST)</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a><span class="co">      # ========================================</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a><span class="co">      # GoSec - Go SAST</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running GoSec static analysis...&quot;</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>        gosec -fmt=json -out=security-reports/gosec-report.json ./... || {</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>          echo &quot;⚠️  GoSec found security issues&quot;</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>          cat security-reports/gosec-report.json | jq &#39;.Issues[] | select(.severity == &quot;HIGH&quot; and .confidence == &quot;HIGH&quot;)&#39;</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a><span class="co">      # ESLint Security - JavaScript/TypeScript SAST</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running ESLint security analysis...&quot;</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>        if [ -f &quot;package.json&quot; ]; then</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>          npm install</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>          eslint \</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>            --ext .js,.jsx,.ts,.tsx \</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>            --format json \</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>            --output-file security-reports/eslint-report.json \</span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>            src/ || echo &quot;⚠️  ESLint found issues&quot;</span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>        fi</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a><span class="co">      # Semgrep - Multi-language SAST</span></span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running Semgrep security analysis...&quot;</span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>        docker run --rm -v $(pwd):/src returntocorp/semgrep \</span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>          --config=auto \</span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>          --json \</span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>          --output=/src/security-reports/semgrep-report.json \</span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>          /src || echo &quot;⚠️  Semgrep found issues&quot;</span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a><span class="co">      # ========================================</span></span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a><span class="co">      # 3. DEPENDENCY VULNERABILITY SCANNING</span></span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a><span class="co">      # ========================================</span></span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a><span class="co">      # Nancy - Go dependencies</span></span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running Nancy dependency scan...&quot;</span></span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>        go list -json -m all | nancy sleuth \</span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>          --output json &gt; security-reports/nancy-report.json || {</span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>            echo &quot;⚠️  Nancy found vulnerable dependencies&quot;</span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>            cat security-reports/nancy-report.json | jq &#39;.vulnerable&#39;</span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a><span class="co">      # govulncheck - Go vulnerabilities</span></span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running govulncheck...&quot;</span></span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>        govulncheck -json ./... &gt; security-reports/govulncheck-report.json || {</span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>          echo &quot;⚠️  govulncheck found vulnerabilities&quot;</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a><span class="co">      # npm audit - JavaScript dependencies</span></span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running npm audit...&quot;</span></span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>        if [ -f &quot;package.json&quot; ]; then</span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>          npm audit --json &gt; security-reports/npm-audit-report.json || {</span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>            echo &quot;⚠️  npm audit found vulnerabilities&quot;</span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>            cat security-reports/npm-audit-report.json | jq &#39;.vulnerabilities&#39;</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>        fi</span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a><span class="co">      # Snyk - Multi-language dependency scanning</span></span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running Snyk security scan...&quot;</span></span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>        snyk test \</span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>          --json \</span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>          --severity-threshold=high &gt; security-reports/snyk-report.json || {</span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a>            echo &quot;⚠️  Snyk found vulnerabilities&quot;</span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a><span class="co">      # ========================================</span></span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a><span class="co">      # 4. LICENSE COMPLIANCE CHECKING</span></span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a><span class="co">      # ========================================</span></span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Checking license compliance...&quot;</span></span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>        go-licenses report ./... &gt; security-reports/licenses.txt || {</span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>          echo &quot;⚠️  License compliance issues found&quot;</span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a><span class="co">      # ========================================</span></span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a><span class="co">      # 5. CODE QUALITY AND </span><span class="al">SECURITY</span><span class="co"> METRICS</span></span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a><span class="co">      # ========================================</span></span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running code quality analysis...&quot;</span></span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>        # Calculate cyclomatic complexity</span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>        gocyclo -over 15 . &gt; security-reports/complexity-report.txt || true</span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>        # Check code coverage</span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>        go test -coverprofile=security-reports/coverage.out ./...</span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a>        go tool cover -func=security-reports/coverage.out &gt; security-reports/coverage-summary.txt</span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a><span class="co">      # ========================================</span></span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a><span class="co">      # 6. </span><span class="al">SECURITY</span><span class="co"> GATE EVALUATION</span></span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a><span class="co">      # ========================================</span></span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Evaluating security gate...&quot;</span></span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> python3 scripts/security-gate.py</span></span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a><span class="co">      # ========================================</span></span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a><span class="co">      # 7. GENERATE </span><span class="al">SECURITY</span><span class="co"> SUMMARY</span></span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a><span class="co">      # ========================================</span></span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Generating security summary report...&quot;</span></span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> python3 scripts/generate-security-summary.py</span></span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">build</span><span class="kw">:</span></span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Security scanning phase completed!&quot;</span></span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Security reports available in security-reports/ directory&quot;</span></span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a><span class="fu">artifacts</span><span class="kw">:</span></span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">files</span><span class="kw">:</span></span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;security-reports/**/*&#39;</span></span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> security-scan-reports-$CODEBUILD_BUILD_NUMBER</span></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a><span class="fu">reports</span><span class="kw">:</span></span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">SecurityReports</span><span class="kw">:</span></span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">files</span><span class="kw">:</span></span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;security-reports/gosec-report.json&#39;</span></span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;security-reports/nancy-report.json&#39;</span></span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;security-reports/eslint-report.json&#39;</span></span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;security-reports/snyk-report.json&#39;</span></span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">file-format</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;JSON&#39;</span></span></code></pre></div>
<h3 id="advanced-security-gate-script">Advanced Security Gate
Script</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># scripts/security-gate.py - Advanced Security Gate Evaluation</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> enum <span class="im">import</span> Enum</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Severity(Enum):</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    CRITICAL <span class="op">=</span> <span class="st">&quot;CRITICAL&quot;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    HIGH <span class="op">=</span> <span class="st">&quot;HIGH&quot;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    MEDIUM <span class="op">=</span> <span class="st">&quot;MEDIUM&quot;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    LOW <span class="op">=</span> <span class="st">&quot;LOW&quot;</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    INFO <span class="op">=</span> <span class="st">&quot;INFO&quot;</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Finding:</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    tool: <span class="bu">str</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    severity: Severity</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    title: <span class="bu">str</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    description: <span class="bu">str</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    file_path: <span class="bu">str</span> <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    line_number: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    cve: <span class="bu">str</span> <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    cvss_score: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    remediation: <span class="bu">str</span> <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SecurityGate:</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.findings: List[Finding] <span class="op">=</span> []</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.passed <span class="op">=</span> <span class="va">True</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.critical_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.high_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.medium_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.low_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Thresholds from environment or defaults</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fail_on_critical <span class="op">=</span> os.getenv(<span class="st">&#39;FAIL_ON_CRITICAL&#39;</span>, <span class="st">&#39;true&#39;</span>).lower() <span class="op">==</span> <span class="st">&#39;true&#39;</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fail_on_high <span class="op">=</span> os.getenv(<span class="st">&#39;FAIL_ON_HIGH&#39;</span>, <span class="st">&#39;false&#39;</span>).lower() <span class="op">==</span> <span class="st">&#39;true&#39;</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.max_high_vulnerabilities <span class="op">=</span> <span class="bu">int</span>(os.getenv(<span class="st">&#39;MAX_HIGH_VULNERABILITIES&#39;</span>, <span class="st">&#39;10&#39;</span>))</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_gosec_report(<span class="va">self</span>):</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Parse GoSec SAST results&quot;&quot;&quot;</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;security-reports/gosec-report.json&#39;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>                report <span class="op">=</span> json.load(f)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> issue <span class="kw">in</span> report.get(<span class="st">&#39;Issues&#39;</span>, []):</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>                severity_map <span class="op">=</span> {</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;HIGH&#39;</span>: Severity.HIGH,</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;MEDIUM&#39;</span>: Severity.MEDIUM,</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;LOW&#39;</span>: Severity.LOW</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>                confidence <span class="op">=</span> issue.get(<span class="st">&#39;confidence&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>                issue_severity <span class="op">=</span> issue.get(<span class="st">&#39;severity&#39;</span>, <span class="st">&#39;LOW&#39;</span>)</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Elevate to CRITICAL if HIGH severity and HIGH confidence</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> issue_severity <span class="op">==</span> <span class="st">&#39;HIGH&#39;</span> <span class="kw">and</span> confidence <span class="op">==</span> <span class="st">&#39;HIGH&#39;</span>:</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>                    severity <span class="op">=</span> Severity.CRITICAL</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>                    severity <span class="op">=</span> severity_map.get(issue_severity, Severity.LOW)</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>                finding <span class="op">=</span> Finding(</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>                    tool<span class="op">=</span><span class="st">&#39;GoSec&#39;</span>,</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>                    severity<span class="op">=</span>severity,</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>                    title<span class="op">=</span>issue.get(<span class="st">&#39;rule&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>                    description<span class="op">=</span>issue.get(<span class="st">&#39;details&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>                    file_path<span class="op">=</span>issue.get(<span class="st">&#39;file&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>                    line_number<span class="op">=</span><span class="bu">int</span>(issue.get(<span class="st">&#39;line&#39;</span>, <span class="dv">0</span>)),</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>                    remediation<span class="op">=</span><span class="st">&quot;Review and fix the security issue in the code&quot;</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.findings.append(finding)</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>._increment_severity_count(severity)</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">FileNotFoundError</span>:</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;⚠️  GoSec report not found&quot;</span>)</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;❌ Error parsing GoSec report: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_nancy_report(<span class="va">self</span>):</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Parse Nancy dependency scan results&quot;&quot;&quot;</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;security-reports/nancy-report.json&#39;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>                report <span class="op">=</span> json.load(f)</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> vuln <span class="kw">in</span> report.get(<span class="st">&#39;vulnerable&#39;</span>, []):</span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>                cvss <span class="op">=</span> vuln.get(<span class="st">&#39;cvss_score&#39;</span>, <span class="dv">0</span>)</span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Map CVSS to severity</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> cvss <span class="op">&gt;=</span> <span class="fl">9.0</span>:</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>                    severity <span class="op">=</span> Severity.CRITICAL</span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> cvss <span class="op">&gt;=</span> <span class="fl">7.0</span>:</span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>                    severity <span class="op">=</span> Severity.HIGH</span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> cvss <span class="op">&gt;=</span> <span class="fl">4.0</span>:</span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>                    severity <span class="op">=</span> Severity.MEDIUM</span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>                    severity <span class="op">=</span> Severity.LOW</span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>                finding <span class="op">=</span> Finding(</span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>                    tool<span class="op">=</span><span class="st">&#39;Nancy&#39;</span>,</span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>                    severity<span class="op">=</span>severity,</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>                    title<span class="op">=</span>vuln.get(<span class="st">&#39;title&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>                    description<span class="op">=</span>vuln.get(<span class="st">&#39;description&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>                    cve<span class="op">=</span>vuln.get(<span class="st">&#39;cve&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>                    cvss_score<span class="op">=</span>cvss,</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>                    remediation<span class="op">=</span><span class="ss">f&quot;Update dependency: </span><span class="sc">{</span>vuln<span class="sc">.</span>get(<span class="st">&#39;coordinates&#39;</span>, <span class="st">&#39;&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.findings.append(finding)</span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>._increment_severity_count(severity)</span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">FileNotFoundError</span>:</span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;⚠️  Nancy report not found&quot;</span>)</span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;❌ Error parsing Nancy report: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_eslint_report(<span class="va">self</span>):</span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Parse ESLint security results&quot;&quot;&quot;</span></span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;security-reports/eslint-report.json&#39;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a>                report <span class="op">=</span> json.load(f)</span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> file_result <span class="kw">in</span> report:</span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> message <span class="kw">in</span> file_result.get(<span class="st">&#39;messages&#39;</span>, []):</span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a>                    rule_id <span class="op">=</span> message.get(<span class="st">&#39;ruleId&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Only process security-related rules</span></span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="st">&#39;security&#39;</span> <span class="kw">not</span> <span class="kw">in</span> rule_id.lower():</span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Map ESLint severity (1=warn, 2=error)</span></span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a>                    eslint_severity <span class="op">=</span> message.get(<span class="st">&#39;severity&#39;</span>, <span class="dv">1</span>)</span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> eslint_severity <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a>                        severity <span class="op">=</span> Severity.HIGH</span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>                        severity <span class="op">=</span> Severity.MEDIUM</span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a>                    finding <span class="op">=</span> Finding(</span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a>                        tool<span class="op">=</span><span class="st">&#39;ESLint&#39;</span>,</span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a>                        severity<span class="op">=</span>severity,</span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a>                        title<span class="op">=</span>rule_id,</span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a>                        description<span class="op">=</span>message.get(<span class="st">&#39;message&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a>                        file_path<span class="op">=</span>file_result.get(<span class="st">&#39;filePath&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a>                        line_number<span class="op">=</span>message.get(<span class="st">&#39;line&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a>                        remediation<span class="op">=</span><span class="st">&quot;Review and fix the security issue&quot;</span></span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.findings.append(finding)</span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>._increment_severity_count(severity)</span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">FileNotFoundError</span>:</span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;⚠️  ESLint report not found&quot;</span>)</span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;❌ Error parsing ESLint report: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_snyk_report(<span class="va">self</span>):</span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Parse Snyk vulnerability results&quot;&quot;&quot;</span></span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;security-reports/snyk-report.json&#39;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a>                report <span class="op">=</span> json.load(f)</span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> vuln <span class="kw">in</span> report.get(<span class="st">&#39;vulnerabilities&#39;</span>, []):</span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a>                severity_map <span class="op">=</span> {</span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;critical&#39;</span>: Severity.CRITICAL,</span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;high&#39;</span>: Severity.HIGH,</span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;medium&#39;</span>: Severity.MEDIUM,</span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;low&#39;</span>: Severity.LOW</span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a>                severity <span class="op">=</span> severity_map.get(</span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a>                    vuln.get(<span class="st">&#39;severity&#39;</span>, <span class="st">&#39;low&#39;</span>).lower(),</span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a>                    Severity.LOW</span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb5-178"><a href="#cb5-178" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-179"><a href="#cb5-179" aria-hidden="true" tabindex="-1"></a>                finding <span class="op">=</span> Finding(</span>
<span id="cb5-180"><a href="#cb5-180" aria-hidden="true" tabindex="-1"></a>                    tool<span class="op">=</span><span class="st">&#39;Snyk&#39;</span>,</span>
<span id="cb5-181"><a href="#cb5-181" aria-hidden="true" tabindex="-1"></a>                    severity<span class="op">=</span>severity,</span>
<span id="cb5-182"><a href="#cb5-182" aria-hidden="true" tabindex="-1"></a>                    title<span class="op">=</span>vuln.get(<span class="st">&#39;title&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb5-183"><a href="#cb5-183" aria-hidden="true" tabindex="-1"></a>                    description<span class="op">=</span>vuln.get(<span class="st">&#39;description&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb5-184"><a href="#cb5-184" aria-hidden="true" tabindex="-1"></a>                    cve<span class="op">=</span>vuln.get(<span class="st">&#39;identifiers&#39;</span>, {}).get(<span class="st">&#39;CVE&#39;</span>, [<span class="st">&#39;&#39;</span>])[<span class="dv">0</span>],</span>
<span id="cb5-185"><a href="#cb5-185" aria-hidden="true" tabindex="-1"></a>                    cvss_score<span class="op">=</span>vuln.get(<span class="st">&#39;cvssScore&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb5-186"><a href="#cb5-186" aria-hidden="true" tabindex="-1"></a>                    remediation<span class="op">=</span>vuln.get(<span class="st">&#39;fixedIn&#39;</span>, [<span class="st">&#39;No fix available&#39;</span>])[<span class="dv">0</span>]</span>
<span id="cb5-187"><a href="#cb5-187" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb5-188"><a href="#cb5-188" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-189"><a href="#cb5-189" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.findings.append(finding)</span>
<span id="cb5-190"><a href="#cb5-190" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>._increment_severity_count(severity)</span>
<span id="cb5-191"><a href="#cb5-191" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-192"><a href="#cb5-192" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">FileNotFoundError</span>:</span>
<span id="cb5-193"><a href="#cb5-193" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;⚠️  Snyk report not found&quot;</span>)</span>
<span id="cb5-194"><a href="#cb5-194" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb5-195"><a href="#cb5-195" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;❌ Error parsing Snyk report: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-196"><a href="#cb5-196" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-197"><a href="#cb5-197" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_gitleaks_report(<span class="va">self</span>):</span>
<span id="cb5-198"><a href="#cb5-198" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Parse Gitleaks secrets detection results&quot;&quot;&quot;</span></span>
<span id="cb5-199"><a href="#cb5-199" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-200"><a href="#cb5-200" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;security-reports/gitleaks-report.json&#39;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb5-201"><a href="#cb5-201" aria-hidden="true" tabindex="-1"></a>                report <span class="op">=</span> json.load(f)</span>
<span id="cb5-202"><a href="#cb5-202" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-203"><a href="#cb5-203" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> secret <span class="kw">in</span> report:</span>
<span id="cb5-204"><a href="#cb5-204" aria-hidden="true" tabindex="-1"></a>                finding <span class="op">=</span> Finding(</span>
<span id="cb5-205"><a href="#cb5-205" aria-hidden="true" tabindex="-1"></a>                    tool<span class="op">=</span><span class="st">&#39;Gitleaks&#39;</span>,</span>
<span id="cb5-206"><a href="#cb5-206" aria-hidden="true" tabindex="-1"></a>                    severity<span class="op">=</span>Severity.CRITICAL,  <span class="co"># Secrets are always critical</span></span>
<span id="cb5-207"><a href="#cb5-207" aria-hidden="true" tabindex="-1"></a>                    title<span class="op">=</span><span class="st">&quot;Secret Detected&quot;</span>,</span>
<span id="cb5-208"><a href="#cb5-208" aria-hidden="true" tabindex="-1"></a>                    description<span class="op">=</span><span class="ss">f&quot;Secret found: </span><span class="sc">{</span>secret<span class="sc">.</span>get(<span class="st">&#39;Description&#39;</span>, <span class="st">&#39;&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb5-209"><a href="#cb5-209" aria-hidden="true" tabindex="-1"></a>                    file_path<span class="op">=</span>secret.get(<span class="st">&#39;File&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb5-210"><a href="#cb5-210" aria-hidden="true" tabindex="-1"></a>                    line_number<span class="op">=</span>secret.get(<span class="st">&#39;StartLine&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb5-211"><a href="#cb5-211" aria-hidden="true" tabindex="-1"></a>                    remediation<span class="op">=</span><span class="st">&quot;Remove the secret and rotate credentials immediately&quot;</span></span>
<span id="cb5-212"><a href="#cb5-212" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb5-213"><a href="#cb5-213" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-214"><a href="#cb5-214" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.findings.append(finding)</span>
<span id="cb5-215"><a href="#cb5-215" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.critical_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-216"><a href="#cb5-216" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-217"><a href="#cb5-217" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">FileNotFoundError</span>:</span>
<span id="cb5-218"><a href="#cb5-218" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;✅ No secrets detected&quot;</span>)</span>
<span id="cb5-219"><a href="#cb5-219" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb5-220"><a href="#cb5-220" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;❌ Error parsing Gitleaks report: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-221"><a href="#cb5-221" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-222"><a href="#cb5-222" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _increment_severity_count(<span class="va">self</span>, severity: Severity):</span>
<span id="cb5-223"><a href="#cb5-223" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Increment the appropriate severity counter&quot;&quot;&quot;</span></span>
<span id="cb5-224"><a href="#cb5-224" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> severity <span class="op">==</span> Severity.CRITICAL:</span>
<span id="cb5-225"><a href="#cb5-225" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.critical_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-226"><a href="#cb5-226" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> severity <span class="op">==</span> Severity.HIGH:</span>
<span id="cb5-227"><a href="#cb5-227" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.high_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-228"><a href="#cb5-228" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> severity <span class="op">==</span> Severity.MEDIUM:</span>
<span id="cb5-229"><a href="#cb5-229" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.medium_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-230"><a href="#cb5-230" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> severity <span class="op">==</span> Severity.LOW:</span>
<span id="cb5-231"><a href="#cb5-231" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.low_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-232"><a href="#cb5-232" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-233"><a href="#cb5-233" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> evaluate(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb5-234"><a href="#cb5-234" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Evaluate all security findings and determine if gate passes&quot;&quot;&quot;</span></span>
<span id="cb5-235"><a href="#cb5-235" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-236"><a href="#cb5-236" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb5-237"><a href="#cb5-237" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;🔒 SECURAA SECURITY GATE EVALUATION&quot;</span>)</span>
<span id="cb5-238"><a href="#cb5-238" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb5-239"><a href="#cb5-239" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-240"><a href="#cb5-240" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Load all security reports</span></span>
<span id="cb5-241"><a href="#cb5-241" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">📊 Loading security scan results...&quot;</span>)</span>
<span id="cb5-242"><a href="#cb5-242" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.load_gitleaks_report()</span>
<span id="cb5-243"><a href="#cb5-243" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.load_gosec_report()</span>
<span id="cb5-244"><a href="#cb5-244" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.load_nancy_report()</span>
<span id="cb5-245"><a href="#cb5-245" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.load_eslint_report()</span>
<span id="cb5-246"><a href="#cb5-246" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.load_snyk_report()</span>
<span id="cb5-247"><a href="#cb5-247" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-248"><a href="#cb5-248" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Display summary</span></span>
<span id="cb5-249"><a href="#cb5-249" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">📈 Security Findings Summary:&quot;</span>)</span>
<span id="cb5-250"><a href="#cb5-250" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   🔴 Critical: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>critical_count<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-251"><a href="#cb5-251" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   🟠 High:     </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>high_count<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-252"><a href="#cb5-252" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   🟡 Medium:   </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>medium_count<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-253"><a href="#cb5-253" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   🟢 Low:      </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>low_count<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-254"><a href="#cb5-254" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   📋 Total:    </span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.findings)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-255"><a href="#cb5-255" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-256"><a href="#cb5-256" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Evaluate gate criteria</span></span>
<span id="cb5-257"><a href="#cb5-257" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">🚦 Evaluating Security Gate Criteria:&quot;</span>)</span>
<span id="cb5-258"><a href="#cb5-258" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-259"><a href="#cb5-259" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check 1: Critical vulnerabilities</span></span>
<span id="cb5-260"><a href="#cb5-260" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.critical_count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb5-261"><a href="#cb5-261" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   ❌ FAILED: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>critical_count<span class="sc">}</span><span class="ss"> critical vulnerabilities found&quot;</span>)</span>
<span id="cb5-262"><a href="#cb5-262" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.fail_on_critical:</span>
<span id="cb5-263"><a href="#cb5-263" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.passed <span class="op">=</span> <span class="va">False</span></span>
<span id="cb5-264"><a href="#cb5-264" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb5-265"><a href="#cb5-265" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;   ✅ PASSED: No critical vulnerabilities&quot;</span>)</span>
<span id="cb5-266"><a href="#cb5-266" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-267"><a href="#cb5-267" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check 2: High vulnerabilities</span></span>
<span id="cb5-268"><a href="#cb5-268" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.high_count <span class="op">&gt;</span> <span class="va">self</span>.max_high_vulnerabilities:</span>
<span id="cb5-269"><a href="#cb5-269" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   ❌ FAILED: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>high_count<span class="sc">}</span><span class="ss"> high vulnerabilities &quot;</span> <span class="op">+</span></span>
<span id="cb5-270"><a href="#cb5-270" aria-hidden="true" tabindex="-1"></a>                  <span class="ss">f&quot;(threshold: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>max_high_vulnerabilities<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb5-271"><a href="#cb5-271" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.fail_on_high:</span>
<span id="cb5-272"><a href="#cb5-272" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.passed <span class="op">=</span> <span class="va">False</span></span>
<span id="cb5-273"><a href="#cb5-273" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb5-274"><a href="#cb5-274" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   ✅ PASSED: High vulnerabilities within threshold &quot;</span> <span class="op">+</span></span>
<span id="cb5-275"><a href="#cb5-275" aria-hidden="true" tabindex="-1"></a>                  <span class="ss">f&quot;(</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>high_count<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>max_high_vulnerabilities<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb5-276"><a href="#cb5-276" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-277"><a href="#cb5-277" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Display critical and high findings</span></span>
<span id="cb5-278"><a href="#cb5-278" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.critical_count <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">or</span> <span class="va">self</span>.high_count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb5-279"><a href="#cb5-279" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">🔍 Critical and High Severity Findings:&quot;</span>)</span>
<span id="cb5-280"><a href="#cb5-280" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-281"><a href="#cb5-281" aria-hidden="true" tabindex="-1"></a>            critical_findings <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> <span class="va">self</span>.findings <span class="cf">if</span> f.severity <span class="op">==</span> Severity.CRITICAL]</span>
<span id="cb5-282"><a href="#cb5-282" aria-hidden="true" tabindex="-1"></a>            high_findings <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> <span class="va">self</span>.findings <span class="cf">if</span> f.severity <span class="op">==</span> Severity.HIGH]</span>
<span id="cb5-283"><a href="#cb5-283" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-284"><a href="#cb5-284" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> finding <span class="kw">in</span> critical_findings[:<span class="dv">5</span>]:  <span class="co"># Show first 5</span></span>
<span id="cb5-285"><a href="#cb5-285" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>._print_finding(finding)</span>
<span id="cb5-286"><a href="#cb5-286" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-287"><a href="#cb5-287" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> finding <span class="kw">in</span> high_findings[:<span class="dv">5</span>]:  <span class="co"># Show first 5</span></span>
<span id="cb5-288"><a href="#cb5-288" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>._print_finding(finding)</span>
<span id="cb5-289"><a href="#cb5-289" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-290"><a href="#cb5-290" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(critical_findings) <span class="op">+</span> <span class="bu">len</span>(high_findings) <span class="op">&gt;</span> <span class="dv">10</span>:</span>
<span id="cb5-291"><a href="#cb5-291" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">   ... and </span><span class="sc">{</span><span class="bu">len</span>(critical_findings) <span class="op">+</span> <span class="bu">len</span>(high_findings) <span class="op">-</span> <span class="dv">10</span><span class="sc">}</span><span class="ss"> more&quot;</span>)</span>
<span id="cb5-292"><a href="#cb5-292" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-293"><a href="#cb5-293" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Final verdict</span></span>
<span id="cb5-294"><a href="#cb5-294" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb5-295"><a href="#cb5-295" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.passed:</span>
<span id="cb5-296"><a href="#cb5-296" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;✅ SECURITY GATE: PASSED&quot;</span>)</span>
<span id="cb5-297"><a href="#cb5-297" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">80</span> <span class="op">+</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb5-298"><a href="#cb5-298" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb5-299"><a href="#cb5-299" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb5-300"><a href="#cb5-300" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;❌ SECURITY GATE: FAILED&quot;</span>)</span>
<span id="cb5-301"><a href="#cb5-301" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb5-302"><a href="#cb5-302" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">🛠️  Action Required:&quot;</span>)</span>
<span id="cb5-303"><a href="#cb5-303" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;   1. Review and fix all critical security issues&quot;</span>)</span>
<span id="cb5-304"><a href="#cb5-304" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;   2. Address high severity vulnerabilities&quot;</span>)</span>
<span id="cb5-305"><a href="#cb5-305" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;   3. Review security reports in security-reports/ directory&quot;</span>)</span>
<span id="cb5-306"><a href="#cb5-306" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;   4. Re-run the build after fixes</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb5-307"><a href="#cb5-307" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb5-308"><a href="#cb5-308" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-309"><a href="#cb5-309" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _print_finding(<span class="va">self</span>, finding: Finding):</span>
<span id="cb5-310"><a href="#cb5-310" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Pretty print a security finding&quot;&quot;&quot;</span></span>
<span id="cb5-311"><a href="#cb5-311" aria-hidden="true" tabindex="-1"></a>        severity_icons <span class="op">=</span> {</span>
<span id="cb5-312"><a href="#cb5-312" aria-hidden="true" tabindex="-1"></a>            Severity.CRITICAL: <span class="st">&quot;🔴&quot;</span>,</span>
<span id="cb5-313"><a href="#cb5-313" aria-hidden="true" tabindex="-1"></a>            Severity.HIGH: <span class="st">&quot;🟠&quot;</span>,</span>
<span id="cb5-314"><a href="#cb5-314" aria-hidden="true" tabindex="-1"></a>            Severity.MEDIUM: <span class="st">&quot;🟡&quot;</span>,</span>
<span id="cb5-315"><a href="#cb5-315" aria-hidden="true" tabindex="-1"></a>            Severity.LOW: <span class="st">&quot;🟢&quot;</span>,</span>
<span id="cb5-316"><a href="#cb5-316" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-317"><a href="#cb5-317" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-318"><a href="#cb5-318" aria-hidden="true" tabindex="-1"></a>        icon <span class="op">=</span> severity_icons.get(finding.severity, <span class="st">&quot;ℹ️&quot;</span>)</span>
<span id="cb5-319"><a href="#cb5-319" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">   </span><span class="sc">{</span>icon<span class="sc">}</span><span class="ss"> [</span><span class="sc">{</span>finding<span class="sc">.</span>tool<span class="sc">}</span><span class="ss">] </span><span class="sc">{</span>finding<span class="sc">.</span>title<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-320"><a href="#cb5-320" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;      Severity: </span><span class="sc">{</span>finding<span class="sc">.</span>severity<span class="sc">.</span>value<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-321"><a href="#cb5-321" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> finding.file_path:</span>
<span id="cb5-322"><a href="#cb5-322" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;      Location: </span><span class="sc">{</span>finding<span class="sc">.</span>file_path<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>finding<span class="sc">.</span>line_number<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-323"><a href="#cb5-323" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> finding.cve:</span>
<span id="cb5-324"><a href="#cb5-324" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;      CVE: </span><span class="sc">{</span>finding<span class="sc">.</span>cve<span class="sc">}</span><span class="ss"> (CVSS: </span><span class="sc">{</span>finding<span class="sc">.</span>cvss_score<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb5-325"><a href="#cb5-325" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> finding.description:</span>
<span id="cb5-326"><a href="#cb5-326" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;      Description: </span><span class="sc">{</span>finding<span class="sc">.</span>description[:<span class="dv">100</span>]<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb5-327"><a href="#cb5-327" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> finding.remediation:</span>
<span id="cb5-328"><a href="#cb5-328" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;      Remediation: </span><span class="sc">{</span>finding<span class="sc">.</span>remediation<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-329"><a href="#cb5-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-330"><a href="#cb5-330" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb5-331"><a href="#cb5-331" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Main entry point&quot;&quot;&quot;</span></span>
<span id="cb5-332"><a href="#cb5-332" aria-hidden="true" tabindex="-1"></a>    gate <span class="op">=</span> SecurityGate()</span>
<span id="cb5-333"><a href="#cb5-333" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-334"><a href="#cb5-334" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> gate.evaluate():</span>
<span id="cb5-335"><a href="#cb5-335" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">0</span>)</span>
<span id="cb5-336"><a href="#cb5-336" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb5-337"><a href="#cb5-337" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb5-338"><a href="#cb5-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-339"><a href="#cb5-339" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb5-340"><a href="#cb5-340" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<hr />
<h2 id="security-gates-and-thresholds">Security Gates and
Thresholds</h2>
<h3 id="security-gate-configuration">Security Gate Configuration</h3>
<div class="sourceCode" id="cb6"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># security-gate-config.yml</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">security_gates</span><span class="kw">:</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">gate_1_secrets</span><span class="kw">:</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Secrets Detection Gate&quot;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fail_on_finding</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> gitleaks</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">criteria</span><span class="kw">:</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">no_secrets_in_code</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">no_credentials_in_config</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action_on_failure</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Block commit/build immediately&quot;</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">gate_2_sast</span><span class="kw">:</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Static Application Security Testing Gate&quot;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fail_on_finding</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> gosec</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> eslint-security</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> semgrep</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">criteria</span><span class="kw">:</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">max_critical</span><span class="kw">:</span><span class="at"> </span><span class="dv">0</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">max_high</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">max_medium</span><span class="kw">:</span><span class="at"> </span><span class="dv">50</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action_on_failure</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Fail build and notify security team&quot;</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">gate_3_dependencies</span><span class="kw">:</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Dependency Vulnerability Gate&quot;</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fail_on_finding</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> nancy</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> npm-audit</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> snyk</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">criteria</span><span class="kw">:</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">max_critical_cvss</span><span class="kw">:</span><span class="at"> </span><span class="dv">0</span><span class="co">  # No CVSS &gt;= 9.0</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">max_high_cvss</span><span class="kw">:</span><span class="at"> </span><span class="dv">5</span><span class="co">      # Max 5 vulnerabilities with CVSS &gt;= 7.0</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">must_have_fix_available</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action_on_failure</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Fail build if critical or no fix available&quot;</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">gate_4_license</span><span class="kw">:</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;License Compliance Gate&quot;</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fail_on_finding</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go-licenses</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">criteria</span><span class="kw">:</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">allowed_licenses</span><span class="kw">:</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> MIT</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> Apache-2.0</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> BSD-2-Clause</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> BSD-3-Clause</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> ISC</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">forbidden_licenses</span><span class="kw">:</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> GPL-3.0</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> AGPL-3.0</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action_on_failure</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Fail build and require manual review&quot;</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">gate_5_container</span><span class="kw">:</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Container Security Gate&quot;</span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fail_on_finding</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> trivy</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> docker-scout</span></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">criteria</span><span class="kw">:</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">max_critical</span><span class="kw">:</span><span class="at"> </span><span class="dv">0</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">max_high</span><span class="kw">:</span><span class="at"> </span><span class="dv">5</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">no_malware</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">must_be_signed</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action_on_failure</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Block ECR push&quot;</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">gate_6_dast</span><span class="kw">:</span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Dynamic Application Security Testing Gate&quot;</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fail_on_finding</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span><span class="at"> staging</span></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> owasp-zap</span></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> burp-suite</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">criteria</span><span class="kw">:</span></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">max_high_risk</span><span class="kw">:</span><span class="at"> </span><span class="dv">0</span></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">max_medium_risk</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action_on_failure</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Block production deployment&quot;</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">gate_7_compliance</span><span class="kw">:</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Compliance Validation Gate&quot;</span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fail_on_finding</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">criteria</span><span class="kw">:</span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">soc2_compliant</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">iso27001_compliant</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">gdpr_compliant</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">pci_dss_compliant</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span><span class="co">  # Not required for SECURAA</span></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action_on_failure</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Block production deployment&quot;</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">gate_8_manual_approval</span><span class="kw">:</span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Security Team Manual Approval&quot;</span></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">required_for</span><span class="kw">:</span></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> production_deployment</span></span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> security_sensitive_changes</span></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">approvers</span><span class="kw">:</span></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> security-team</span></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ciso</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action_on_failure</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Block deployment&quot;</span></span></code></pre></div>
<hr />
<h2 id="container-security-pipeline">Container Security Pipeline</h2>
<h3 id="container-build-and-scan-process">Container Build and Scan
Process</h3>
<div class="sourceCode" id="cb7"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># buildspec-container.yml</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.2</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">phases</span><span class="kw">:</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">build</span><span class="kw">:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Building secure Docker images...&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">      # Build image with security labels</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        docker build \</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>          --build-arg BUILD_DATE=$(date -u +&#39;%Y-%m-%dT%H:%M:%SZ&#39;) \</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>          --build-arg VCS_REF=$(git rev-parse --short HEAD) \</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>          --build-arg VERSION=${CODEBUILD_BUILD_NUMBER} \</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>          --label &quot;com.securaa.build-date=$(date -u +&#39;%Y-%m-%dT%H:%M:%SZ&#39;)&quot; \</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>          --label &quot;com.securaa.vcs-ref=$(git rev-parse HEAD)&quot; \</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>          --label &quot;com.securaa.version=${CODEBUILD_BUILD_NUMBER}&quot; \</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>          --label &quot;com.securaa.security-scanned=true&quot; \</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>          --tag securaa/app:${CODEBUILD_BUILD_NUMBER} \</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>          --tag securaa/app:latest \</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>          -f Dockerfile \</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>          .</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">      # Scan with Trivy</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Scanning image with Trivy...&quot;</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>        trivy image \</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>          --severity HIGH,CRITICAL \</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>          --exit-code 1 \</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>          --no-progress \</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>          --format json \</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>          --output trivy-report.json \</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>          securaa/app:${CODEBUILD_BUILD_NUMBER} || {</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>            echo &quot;❌ Container scan failed!&quot;</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>            cat trivy-report.json | jq &#39;.Results[].Vulnerabilities[] | select(.Severity == &quot;CRITICAL&quot; or .Severity == &quot;HIGH&quot;)&#39;</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>            exit 1</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co">      # Generate SBOM (Software Bill of Materials)</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Generating SBOM...&quot;</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>        trivy image \</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>          --format cyclonedx \</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>          --output sbom.json \</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>          securaa/app:${CODEBUILD_BUILD_NUMBER}</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="co">      # Sign image with Cosign</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Signing container image...&quot;</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>        cosign sign \</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>          --key awskms:///alias/securaa-image-signing \</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>          securaa/app:${CODEBUILD_BUILD_NUMBER}</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="co">      # Verify signature</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Verifying image signature...&quot;</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>        cosign verify \</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>          --key awskms:///alias/securaa-image-signing \</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>          securaa/app:${CODEBUILD_BUILD_NUMBER}</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a><span class="co">      # Push to ECR</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Pushing to ECR...&quot;</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>        aws ecr get-login-password --region us-east-2 | \</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>          docker login --username AWS --password-stdin \</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>          ${ECR_REGISTRY}</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>        docker tag securaa/app:${CODEBUILD_BUILD_NUMBER} \</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>          ${ECR_REGISTRY}/securaa/app:${CODEBUILD_BUILD_NUMBER}</span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>        docker push ${ECR_REGISTRY}/securaa/app:${CODEBUILD_BUILD_NUMBER}</span></code></pre></div>
<hr />
<h2 id="continuous-security-monitoring">Continuous Security
Monitoring</h2>
<h3 id="pipeline-monitoring-configuration">Pipeline Monitoring
Configuration</h3>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scripts/pipeline-security-monitor.py</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">Continuous monitoring of CI/CD pipeline security metrics</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> boto3</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PipelineSecurityMonitor:</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cloudwatch <span class="op">=</span> boto3.client(<span class="st">&#39;cloudwatch&#39;</span>, region_name<span class="op">=</span><span class="st">&#39;us-east-2&#39;</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.codebuild <span class="op">=</span> boto3.client(<span class="st">&#39;codebuild&#39;</span>, region_name<span class="op">=</span><span class="st">&#39;us-east-2&#39;</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> publish_security_metrics(<span class="va">self</span>, build_id: <span class="bu">str</span>, metrics: Dict):</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Publish security metrics to CloudWatch&quot;&quot;&quot;</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>        namespace <span class="op">=</span> <span class="st">&#39;SECURAA/Security/Pipeline&#39;</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>        timestamp <span class="op">=</span> datetime.utcnow()</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        metric_data <span class="op">=</span> [</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;MetricName&#39;</span>: <span class="st">&#39;CriticalVulnerabilities&#39;</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Value&#39;</span>: metrics.get(<span class="st">&#39;critical_count&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Unit&#39;</span>: <span class="st">&#39;Count&#39;</span>,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Timestamp&#39;</span>: timestamp,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Dimensions&#39;</span>: [</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;Name&#39;</span>: <span class="st">&#39;BuildId&#39;</span>, <span class="st">&#39;Value&#39;</span>: build_id},</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;Name&#39;</span>: <span class="st">&#39;Pipeline&#39;</span>, <span class="st">&#39;Value&#39;</span>: <span class="st">&#39;SECURAA-Main&#39;</span>}</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;MetricName&#39;</span>: <span class="st">&#39;HighVulnerabilities&#39;</span>,</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Value&#39;</span>: metrics.get(<span class="st">&#39;high_count&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Unit&#39;</span>: <span class="st">&#39;Count&#39;</span>,</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Timestamp&#39;</span>: timestamp,</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Dimensions&#39;</span>: [</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;Name&#39;</span>: <span class="st">&#39;BuildId&#39;</span>, <span class="st">&#39;Value&#39;</span>: build_id},</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;Name&#39;</span>: <span class="st">&#39;Pipeline&#39;</span>, <span class="st">&#39;Value&#39;</span>: <span class="st">&#39;SECURAA-Main&#39;</span>}</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;MetricName&#39;</span>: <span class="st">&#39;SecurityGatesPassed&#39;</span>,</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Value&#39;</span>: <span class="dv">1</span> <span class="cf">if</span> metrics.get(<span class="st">&#39;passed&#39;</span>) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Unit&#39;</span>: <span class="st">&#39;Count&#39;</span>,</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Timestamp&#39;</span>: timestamp,</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Dimensions&#39;</span>: [</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;Name&#39;</span>: <span class="st">&#39;BuildId&#39;</span>, <span class="st">&#39;Value&#39;</span>: build_id},</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;Name&#39;</span>: <span class="st">&#39;Pipeline&#39;</span>, <span class="st">&#39;Value&#39;</span>: <span class="st">&#39;SECURAA-Main&#39;</span>}</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;MetricName&#39;</span>: <span class="st">&#39;SecurityScanDuration&#39;</span>,</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Value&#39;</span>: metrics.get(<span class="st">&#39;scan_duration_seconds&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Unit&#39;</span>: <span class="st">&#39;Seconds&#39;</span>,</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Timestamp&#39;</span>: timestamp,</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Dimensions&#39;</span>: [</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;Name&#39;</span>: <span class="st">&#39;BuildId&#39;</span>, <span class="st">&#39;Value&#39;</span>: build_id}</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cloudwatch.put_metric_data(</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>            Namespace<span class="op">=</span>namespace,</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>            MetricData<span class="op">=</span>metric_data</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;✅ Published </span><span class="sc">{</span><span class="bu">len</span>(metric_data)<span class="sc">}</span><span class="ss"> security metrics to CloudWatch&quot;</span>)</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_security_trends(<span class="va">self</span>, days: <span class="bu">int</span> <span class="op">=</span> <span class="dv">7</span>) <span class="op">-&gt;</span> Dict:</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Analyze security trends over time&quot;&quot;&quot;</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>        end_time <span class="op">=</span> datetime.utcnow()</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>        start_time <span class="op">=</span> end_time <span class="op">-</span> timedelta(days<span class="op">=</span>days)</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get critical vulnerabilities trend</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> <span class="va">self</span>.cloudwatch.get_metric_statistics(</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>            Namespace<span class="op">=</span><span class="st">&#39;SECURAA/Security/Pipeline&#39;</span>,</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>            MetricName<span class="op">=</span><span class="st">&#39;CriticalVulnerabilities&#39;</span>,</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>            Dimensions<span class="op">=</span>[</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;Name&#39;</span>: <span class="st">&#39;Pipeline&#39;</span>, <span class="st">&#39;Value&#39;</span>: <span class="st">&#39;SECURAA-Main&#39;</span>}</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>            StartTime<span class="op">=</span>start_time,</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>            EndTime<span class="op">=</span>end_time,</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>            Period<span class="op">=</span><span class="dv">86400</span>,  <span class="co"># 1 day</span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>            Statistics<span class="op">=</span>[<span class="st">&#39;Sum&#39;</span>, <span class="st">&#39;Average&#39;</span>, <span class="st">&#39;Maximum&#39;</span>]</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>        trend <span class="op">=</span> {</span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;critical_vulnerabilities&#39;</span>: response[<span class="st">&#39;Datapoints&#39;</span>],</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;period_days&#39;</span>: days,</span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;analysis&#39;</span>: <span class="va">self</span>._analyze_trend(response[<span class="st">&#39;Datapoints&#39;</span>])</span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> trend</span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _analyze_trend(<span class="va">self</span>, datapoints: List) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Analyze if security is improving or degrading&quot;&quot;&quot;</span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(datapoints) <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;Insufficient data&quot;</span></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>        sorted_points <span class="op">=</span> <span class="bu">sorted</span>(datapoints, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">&#39;Timestamp&#39;</span>])</span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>        first_half <span class="op">=</span> sorted_points[:<span class="bu">len</span>(sorted_points)<span class="op">//</span><span class="dv">2</span>]</span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>        second_half <span class="op">=</span> sorted_points[<span class="bu">len</span>(sorted_points)<span class="op">//</span><span class="dv">2</span>:]</span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>        first_avg <span class="op">=</span> <span class="bu">sum</span>(p[<span class="st">&#39;Average&#39;</span>] <span class="cf">for</span> p <span class="kw">in</span> first_half) <span class="op">/</span> <span class="bu">len</span>(first_half)</span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>        second_avg <span class="op">=</span> <span class="bu">sum</span>(p[<span class="st">&#39;Average&#39;</span>] <span class="cf">for</span> p <span class="kw">in</span> second_half) <span class="op">/</span> <span class="bu">len</span>(second_half)</span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> second_avg <span class="op">&lt;</span> first_avg <span class="op">*</span> <span class="fl">0.8</span>:</span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;✅ Improving - vulnerabilities decreasing&quot;</span></span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> second_avg <span class="op">&gt;</span> first_avg <span class="op">*</span> <span class="fl">1.2</span>:</span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;⚠️ Degrading - vulnerabilities increasing&quot;</span></span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;➡️ Stable - no significant change&quot;</span></span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage in buildspec</span></span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a>monitor <span class="op">=</span> PipelineSecurityMonitor()</span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>monitor.publish_security_metrics(</span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a>    build_id<span class="op">=</span>os.getenv(<span class="st">&#39;CODEBUILD_BUILD_ID&#39;</span>),</span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a>    metrics<span class="op">=</span>{</span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;critical_count&#39;</span>: gate.critical_count,</span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;high_count&#39;</span>: gate.high_count,</span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;passed&#39;</span>: gate.passed,</span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;scan_duration_seconds&#39;</span>: scan_duration</span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<hr />
<h2 id="security-metrics-and-reporting">Security Metrics and
Reporting</h2>
<h3 id="security-dashboard-metrics">Security Dashboard Metrics</h3>
<div class="sourceCode" id="cb9"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CloudWatch Dashboard for CI/CD Security</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">security_metrics</span><span class="kw">:</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">vulnerability_metrics</span><span class="kw">:</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">metric</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;CriticalVulnerabilities&quot;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">threshold</span><span class="kw">:</span><span class="at"> </span><span class="dv">0</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">alert</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Immediate&quot;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">metric</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;HighVulnerabilities&quot;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">threshold</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">alert</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Within 24 hours&quot;</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">metric</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;MediumVulnerabilities&quot;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">threshold</span><span class="kw">:</span><span class="at"> </span><span class="dv">50</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">alert</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Within 1 week&quot;</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pipeline_metrics</span><span class="kw">:</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">metric</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;SecurityScanDuration&quot;</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">target</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;&lt; 5 minutes&quot;</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">metric</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;SecurityGatePassRate&quot;</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">target</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;&gt; 95%&quot;</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">metric</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;BuildFailuresDueToSecurity&quot;</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">target</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;&lt; 5% of total builds&quot;</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">compliance_metrics</span><span class="kw">:</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">metric</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;SecurityApprovalTime&quot;</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">target</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;&lt; 2 hours&quot;</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">metric</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;VulnerabilityRemediationTime&quot;</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">critical_target</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;&lt; 24 hours&quot;</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">high_target</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;&lt; 7 days&quot;</span></span></code></pre></div>
<h3 id="weekly-security-report-generator">Weekly Security Report
Generator</h3>
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scripts/generate-weekly-security-report.py</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">Generate weekly security report for CI/CD pipeline</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> boto3</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> jinja2 <span class="im">import</span> Template</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_weekly_report():</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Generate comprehensive weekly security report&quot;&quot;&quot;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    cloudwatch <span class="op">=</span> boto3.client(<span class="st">&#39;cloudwatch&#39;</span>, region_name<span class="op">=</span><span class="st">&#39;us-east-2&#39;</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get metrics for the past week</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    end_time <span class="op">=</span> datetime.utcnow()</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    start_time <span class="op">=</span> end_time <span class="op">-</span> timedelta(days<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    report_data <span class="op">=</span> {</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;period&#39;</span>: <span class="ss">f&quot;</span><span class="sc">{</span>start_time<span class="sc">.</span>strftime(<span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st">&#39;</span>)<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>end_time<span class="sc">.</span>strftime(<span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st">&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;total_builds&#39;</span>: get_total_builds(cloudwatch, start_time, end_time),</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;security_gate_pass_rate&#39;</span>: get_pass_rate(cloudwatch, start_time, end_time),</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;vulnerabilities_found&#39;</span>: get_vulnerabilities_summary(cloudwatch, start_time, end_time),</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;top_security_issues&#39;</span>: get_top_issues(start_time, end_time),</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;remediation_metrics&#39;</span>: get_remediation_metrics(start_time, end_time),</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;trend_analysis&#39;</span>: analyze_trends(cloudwatch, start_time, end_time)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate HTML report</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    template <span class="op">=</span> Template(REPORT_TEMPLATE)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    html_report <span class="op">=</span> template.render(<span class="op">**</span>report_data)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save report</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f&#39;security-report-</span><span class="sc">{</span>end_time<span class="sc">.</span>strftime(<span class="st">&quot;%Y%m</span><span class="sc">%d</span><span class="st">&quot;</span>)<span class="sc">}</span><span class="ss">.html&#39;</span>, <span class="st">&#39;w&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>        f.write(html_report)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Send to stakeholders</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    send_report_email(html_report)</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> report_data</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>REPORT_TEMPLATE <span class="op">=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;!DOCTYPE html&gt;</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;html&gt;</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;head&gt;</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;title&gt;SECURAA CI/CD Security Report&lt;/title&gt;</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;style&gt;</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="st">        body { font-family: Arial, sans-serif; margin: 40px; }</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="st">        .header { background: #2c3e50; color: white; padding: 20px; }</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="st">        .metric { background: #ecf0f1; padding: 15px; margin: 10px 0; }</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="st">        .critical { color: #e74c3c; font-weight: bold; }</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="st">        .success { color: #27ae60; font-weight: bold; }</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/style&gt;</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/head&gt;</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;body&gt;</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;h1&gt;🔒 SECURAA CI/CD Security Report&lt;/h1&gt;</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p&gt;Period: </span><span class="sc">{{</span><span class="st"> period </span><span class="sc">}}</span><span class="st">&lt;/p&gt;</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;div class=&quot;metric&quot;&gt;</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;h2&gt;📊 Pipeline Metrics&lt;/h2&gt;</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p&gt;Total Builds: </span><span class="sc">{{</span><span class="st"> total_builds </span><span class="sc">}}</span><span class="st">&lt;/p&gt;</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p class=&quot;</span><span class="sc">{{</span><span class="st"> &#39;success&#39; if security_gate_pass_rate &gt; 95 else &#39;critical&#39; </span><span class="sc">}}</span><span class="st">&quot;&gt;</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="st">            Security Gate Pass Rate: </span><span class="sc">{{</span><span class="st"> security_gate_pass_rate </span><span class="sc">}}</span><span class="st">%</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/p&gt;</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;div class=&quot;metric&quot;&gt;</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;h2&gt;🔍 Vulnerabilities Detected&lt;/h2&gt;</span></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p class=&quot;critical&quot;&gt;Critical: </span><span class="sc">{{</span><span class="st"> vulnerabilities_found.critical </span><span class="sc">}}</span><span class="st">&lt;/p&gt;</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p&gt;High: </span><span class="sc">{{</span><span class="st"> vulnerabilities_found.high </span><span class="sc">}}</span><span class="st">&lt;/p&gt;</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p&gt;Medium: </span><span class="sc">{{</span><span class="st"> vulnerabilities_found.medium </span><span class="sc">}}</span><span class="st">&lt;/p&gt;</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p&gt;Low: </span><span class="sc">{{</span><span class="st"> vulnerabilities_found.low </span><span class="sc">}}</span><span class="st">&lt;/p&gt;</span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;div class=&quot;metric&quot;&gt;</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;h2&gt;🎯 Top Security Issues&lt;/h2&gt;</span></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;ol&gt;</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a><span class="st">        {</span><span class="sc">% f</span><span class="st">or issue in top_security_issues %}</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;li&gt;</span><span class="sc">{{</span><span class="st"> issue.title </span><span class="sc">}}</span><span class="st"> (</span><span class="sc">{{</span><span class="st"> issue.count </span><span class="sc">}}</span><span class="st"> occurrences)&lt;/li&gt;</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a><span class="st">        {</span><span class="sc">% e</span><span class="st">ndfor %}</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/ol&gt;</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;div class=&quot;metric&quot;&gt;</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;h2&gt;⏱️ Remediation Metrics&lt;/h2&gt;</span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p&gt;Average Time to Fix Critical: </span><span class="sc">{{</span><span class="st"> remediation_metrics.critical_avg_hours </span><span class="sc">}}</span><span class="st"> hours&lt;/p&gt;</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p&gt;Average Time to Fix High: </span><span class="sc">{{</span><span class="st"> remediation_metrics.high_avg_hours </span><span class="sc">}}</span><span class="st"> hours&lt;/p&gt;</span></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;div class=&quot;metric&quot;&gt;</span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;h2&gt;📈 Trend Analysis&lt;/h2&gt;</span></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p&gt;</span><span class="sc">{{</span><span class="st"> trend_analysis </span><span class="sc">}}</span><span class="st">&lt;/p&gt;</span></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/body&gt;</span></span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/html&gt;</span></span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span></code></pre></div>
<hr />
<h2 id="phase-exit-criteria">Phase Exit Criteria</h2>
<h3 id="cicd-security-pipeline-maturity-checklist">CI/CD Security
Pipeline Maturity Checklist</h3>
<p>✅ <strong>Pre-Commit Hooks Implemented</strong> - Secrets detection
configured - SAST scanning active - Dependency checking enabled -
Pre-commit hooks installed on all developer machines</p>
<p>✅ <strong>AWS CodeBuild Security Integration</strong> - Security
scanning phase implemented - All security tools installed and configured
- Security gate script functional - Reports generated and stored</p>
<p>✅ <strong>Security Gates Configured</strong> - Gate thresholds
defined - Gate criteria documented - Automated gate evaluation
implemented - Manual approval process established</p>
<p>✅ <strong>Container Security Implemented</strong> - Container
scanning integrated - Image signing configured - SBOM generation active
- ECR security policies applied</p>
<p>✅ <strong>Monitoring and Alerting Active</strong> - CloudWatch
metrics publishing - Security alerts configured - Dashboard created -
Weekly reports automated</p>
<p>✅ <strong>Documentation Complete</strong> - Pipeline security
documented - Runbooks created - Team trained on security pipeline -
Incident response procedures defined</p>
<hr />
<h2 id="pipeline-security-best-practices">Pipeline Security Best
Practices</h2>
<h3 id="principle-of-least-privilege">1. Principle of Least
Privilege</h3>
<div class="sourceCode" id="cb11"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;Version&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-10-17&quot;</span><span class="fu">,</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;Statement&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Sid&quot;</span><span class="fu">:</span> <span class="st">&quot;CodeBuildMinimalPermissions&quot;</span><span class="fu">,</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Effect&quot;</span><span class="fu">:</span> <span class="st">&quot;Allow&quot;</span><span class="fu">,</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Action&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;logs:CreateLogGroup&quot;</span><span class="ot">,</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;logs:CreateLogStream&quot;</span><span class="ot">,</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;logs:PutLogEvents&quot;</span><span class="ot">,</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;s3:GetObject&quot;</span><span class="ot">,</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;s3:PutObject&quot;</span><span class="ot">,</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:GetAuthorizationToken&quot;</span><span class="ot">,</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:BatchCheckLayerAvailability&quot;</span><span class="ot">,</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:PutImage&quot;</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Resource&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;arn:aws:logs:us-east-2:665853670667:log-group:/aws/codebuild/securaa-*&quot;</span><span class="ot">,</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;arn:aws:s3:::securaa-artifacts/*&quot;</span><span class="ot">,</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;arn:aws:ecr:us-east-2:665853670667:repository/securaa/*&quot;</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 id="immutable-artifacts">2. Immutable Artifacts</h3>
<ul>
<li>All build artifacts are versioned and immutable</li>
<li>ECR images tagged with build number (not just
<code>latest</code>)</li>
<li>Artifacts signed with cryptographic signatures</li>
<li>Audit trail maintained for all artifacts</li>
</ul>
<h3 id="security-scanning-at-every-stage">3. Security Scanning at Every
Stage</h3>
<ul>
<li><strong>Pre-Commit</strong>: Developer workstation</li>
<li><strong>Commit</strong>: Git hooks</li>
<li><strong>Build</strong>: AWS CodeBuild</li>
<li><strong>Container</strong>: Image scanning</li>
<li><strong>Deployment</strong>: DAST in staging</li>
<li><strong>Runtime</strong>: Production monitoring</li>
</ul>
<h3 id="fail-fast-fail-secure">4. Fail Fast, Fail Secure</h3>
<ul>
<li>Stop pipeline immediately when critical issues found</li>
<li>No automatic fallback to insecure configurations</li>
<li>Clear error messages with remediation guidance</li>
<li>Automated rollback on security failures</li>
</ul>
<h3 id="continuous-improvement">5. Continuous Improvement</h3>
<ul>
<li>Track security metrics over time</li>
<li>Regular security pipeline audits</li>
<li>Update security tools regularly</li>
<li>Incorporate lessons learned from incidents</li>
</ul>
<hr />
<h2 id="summary">Summary</h2>
<p>The SECURAA CI/CD Security Pipeline provides:</p>
<ul>
<li><strong>Comprehensive Security Coverage</strong>: From pre-commit to
production</li>
<li><strong>Automated Security Testing</strong>: SAST, DAST, dependency
scanning, container scanning</li>
<li><strong>Security Gates</strong>: Enforced security criteria at every
stage</li>
<li><strong>Continuous Monitoring</strong>: Real-time security metrics
and alerting</li>
<li><strong>Compliance Validation</strong>: Automated compliance
checking</li>
<li><strong>Immutable Artifacts</strong>: Secure, traceable build
artifacts</li>
<li><strong>Defense in Depth</strong>: Multiple layers of security
validation</li>
</ul>
<p>The pipeline ensures that security is integrated into every phase of
the development lifecycle, enabling rapid, secure software delivery.</p>
<hr />
<p><strong>Related Documents:</strong> - <a
href="01_SDLC_Overview.md">01_SDLC_Overview.md</a> - SDLC process
overview - <a href="04_Development_Phase.md">04_Development_Phase.md</a>
- Secure development practices - <a
href="05_Testing_Build_Deployment_Operations.md">05_Testing_Build_Deployment_Operations.md</a>
- Testing and deployment</p>
<hr />
<p><em>This document is part of the SECURAA Secure SDLC documentation
suite. For questions, contact security@securaa.com</em></p>

</body>
</html>