<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>05 Testing Build Deployment Operations</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 30px;
            background-color: #fff;
        }

        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-top: 40px;
        }

        h2 {
            color: #34495e;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
            margin-top: 30px;
        }

        h3, h4, h5, h6 {
            color: #7f8c8d;
            margin-top: 20px;
        }

        code {
            background-color: #f7f9fc;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
        }

        pre {
            background-color: #2d3436;
            color: #dfe6e9;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.85em;
        }

        pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            font-size: 0.9em;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 10px 12px;
            text-align: left;
        }

        th {
            background-color: #3498db;
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        blockquote {
            border-left: 4px solid #3498db;
            margin: 20px 0;
            padding: 10px 20px;
            background-color: #ecf0f1;
            font-style: italic;
        }

        a {
            color: #3498db;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .diagram {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background-color: #fafafa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow-x: auto;
        }

        .diagram svg {
            max-width: 100%;
            height: auto;
        }

        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }

        ul, ol {
            padding-left: 25px;
        }

        li {
            margin-bottom: 5px;
        }

        hr {
            border: none;
            border-top: 2px solid #ecf0f1;
            margin: 30px 0;
        }

        #TOC {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
        }

        #TOC ul {
            list-style-type: none;
            padding-left: 0;
        }

        #TOC li {
            padding: 3px 0;
        }

        .header-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            margin: -30px -30px 30px -30px;
            text-align: center;
        }

        .header-section h1 {
            color: white;
            border: none;
            margin: 0;
        }

        .header-section p {
            margin: 10px 0 0 0;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="header-section">
        <h1>05 Testing Build Deployment Operations</h1>
        <p>SECURAA Security Documentation</p>
    </div>
    <h1
id="securaa-secure-sdlc---testing-build-deployment-operations">SECURAA
Secure SDLC - Testing, Build, Deployment &amp; Operations</h1>
<h2 id="comprehensive-guide-for-remaining-sdlc-phases">Comprehensive
Guide for Remaining SDLC Phases</h2>
<hr />
<h2 id="document-control">Document Control</h2>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 74%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Document Title</strong></th>
<th>SECURAA SDLC - Testing, Build, Deployment &amp; Operations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Document ID</strong></td>
<td>SECURAA-SDLC-005-008 (Consolidated)</td>
</tr>
<tr class="even">
<td><strong>Version</strong></td>
<td>2.0</td>
</tr>
<tr class="odd">
<td><strong>Date</strong></td>
<td>November 13, 2025</td>
</tr>
<tr class="even">
<td><strong>Classification</strong></td>
<td>Customer-Facing - Confidential</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="document-overview">Document Overview</h2>
<p>This consolidated document covers the remaining phases of the SECURAA
Secure SDLC:</p>
<ul>
<li><strong>Phase 5: Security Testing</strong> - SAST, DAST, Penetration
Testing</li>
<li><strong>Phase 6: Build &amp; Deployment</strong> - AWS CodeBuild,
ECR, IAM, Container Security</li>
<li><strong>Phase 7: Operations &amp; Monitoring</strong> - Production
Operations, Security Monitoring</li>
<li><strong>Phase 8: CI/CD Security Pipeline</strong> - Automated
Security Integration</li>
</ul>
<hr />
<h1 id="phase-5-security-testing">PHASE 5: SECURITY TESTING</h1>
<h2 id="testing-phase-overview">Testing Phase Overview</h2>
<p>The Security Testing Phase validates that security controls are
properly implemented and effective before production deployment.</p>
<h3 id="testing-objectives">Testing Objectives</h3>
<ol type="1">
<li><strong>Validate Security Controls</strong> - Verify all security
requirements are met</li>
<li><strong>Find Vulnerabilities</strong> - Identify security weaknesses
before production</li>
<li><strong>Test Security Scenarios</strong> - Validate security under
various attack scenarios</li>
<li><strong>Verify Compliance</strong> - Ensure compliance requirements
are satisfied</li>
</ol>
<div class="diagram">
<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 1732.82px; background-color: white;" viewBox="0 0 1732.8203125 278" role="graphics-document document" aria-roledescription="flowchart-v2" preserveAspectRatio="xMidYMid meet"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path d="M800.633,42.663L693.367,50.052C586.102,57.442,371.57,72.221,264.305,83.11C157.039,94,157.039,101,157.039,104.5L157.039,108" id="L_A_B_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A_B_0" data-points="W3sieCI6ODAwLjYzMjgxMjUsInkiOjQyLjY2MjkxOTk1MjgwMzgyNn0seyJ4IjoxNTcuMDM5MDYyNSwieSI6ODd9LHsieCI6MTU3LjAzOTA2MjUsInkiOjExMn1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M800.633,51.47L760.641,57.392C720.648,63.314,640.664,75.157,600.672,84.578C560.68,94,560.68,101,560.68,104.5L560.68,108" id="L_A_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A_C_0" data-points="W3sieCI6ODAwLjYzMjgxMjUsInkiOjUxLjQ3MDM2ODM5Mjk1MjQ4fSx7IngiOjU2MC42Nzk2ODc1LCJ5Ijo4N30seyJ4Ijo1NjAuNjc5Njg3NSwieSI6MTEyfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M911.867,62L911.867,66.167C911.867,70.333,911.867,78.667,911.867,86.333C911.867,94,911.867,101,911.867,104.5L911.867,108" id="L_A_D_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A_D_0" data-points="W3sieCI6OTExLjg2NzE4NzUsInkiOjYyfSx7IngiOjkxMS44NjcxODc1LCJ5Ijo4N30seyJ4Ijo5MTEuODY3MTg3NSwieSI6MTEyfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1023.102,49.29L1072.026,55.575C1120.951,61.86,1218.799,74.43,1267.724,84.215C1316.648,94,1316.648,101,1316.648,104.5L1316.648,108" id="L_A_E_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A_E_0" data-points="W3sieCI6MTAyMy4xMDE1NjI1LCJ5Ijo0OS4yODk2NjI2MjY0MTg1OX0seyJ4IjoxMzE2LjY0ODQzNzUsInkiOjg3fSx7IngiOjEzMTYuNjQ4NDM3NSwieSI6MTEyfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1023.102,43.468L1118.402,50.724C1213.703,57.979,1404.305,72.489,1499.605,83.245C1594.906,94,1594.906,101,1594.906,104.5L1594.906,108" id="L_A_F_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A_F_0" data-points="W3sieCI6MTAyMy4xMDE1NjI1LCJ5Ijo0My40NjgzMTE0Mjk4NDU5M30seyJ4IjoxNTk0LjkwNjI1LCJ5Ijo4N30seyJ4IjoxNTk0LjkwNjI1LCJ5IjoxMTJ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M107.931,166L100.353,170.167C92.774,174.333,77.618,182.667,70.039,190.333C62.461,198,62.461,205,62.461,208.5L62.461,212" id="L_B_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_G_0" data-points="W3sieCI6MTA3LjkzMTE4OTkwMzg0NjE2LCJ5IjoxNjZ9LHsieCI6NjIuNDYwOTM3NSwieSI6MTkxfSx7IngiOjYyLjQ2MDkzNzUsInkiOjIxNn1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M206.147,166L213.725,170.167C221.304,174.333,236.46,182.667,244.039,190.333C251.617,198,251.617,205,251.617,208.5L251.617,212" id="L_B_H_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_H_0" data-points="W3sieCI6MjA2LjE0NjkzNTA5NjE1Mzg0LCJ5IjoxNjZ9LHsieCI6MjUxLjYxNzE4NzUsInkiOjE5MX0seyJ4IjoyNTEuNjE3MTg3NSwieSI6MjE2fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M510.189,166L502.397,170.167C494.605,174.333,479.021,182.667,471.229,190.333C463.438,198,463.438,205,463.438,208.5L463.438,212" id="L_C_I_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_I_0" data-points="W3sieCI6NTEwLjE4ODU1MTY4MjY5MjMsInkiOjE2Nn0seyJ4Ijo0NjMuNDM3NSwieSI6MTkxfSx7IngiOjQ2My40Mzc1LCJ5IjoyMTZ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M611.171,166L618.963,170.167C626.755,174.333,642.338,182.667,650.13,190.333C657.922,198,657.922,205,657.922,208.5L657.922,212" id="L_C_J_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_J_0" data-points="W3sieCI6NjExLjE3MDgyMzMxNzMwNzcsInkiOjE2Nn0seyJ4Ijo2NTcuOTIxODc1LCJ5IjoxOTF9LHsieCI6NjU3LjkyMTg3NSwieSI6MjE2fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M868.3,166L861.577,170.167C854.854,174.333,841.407,182.667,834.684,190.333C827.961,198,827.961,205,827.961,208.5L827.961,212" id="L_D_K_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D_K_0" data-points="W3sieCI6ODY4LjMwMDQ4MDc2OTIzMDcsInkiOjE2Nn0seyJ4Ijo4MjcuOTYwOTM3NSwieSI6MTkxfSx7IngiOjgyNy45NjA5Mzc1LCJ5IjoyMTZ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M955.434,166L962.157,170.167C968.88,174.333,982.327,182.667,989.05,190.333C995.773,198,995.773,205,995.773,208.5L995.773,212" id="L_D_L_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D_L_0" data-points="W3sieCI6OTU1LjQzMzg5NDIzMDc2OTMsInkiOjE2Nn0seyJ4Ijo5OTUuNzczNDM3NSwieSI6MTkxfSx7IngiOjk5NS43NzM0Mzc1LCJ5IjoyMTZ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1256.264,166L1246.945,170.167C1237.626,174.333,1218.989,182.667,1209.67,190.333C1200.352,198,1200.352,205,1200.352,208.5L1200.352,212" id="L_E_M_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E_M_0" data-points="W3sieCI6MTI1Ni4yNjM1MjE2MzQ2MTU1LCJ5IjoxNjZ9LHsieCI6MTIwMC4zNTE1NjI1LCJ5IjoxOTF9LHsieCI6MTIwMC4zNTE1NjI1LCJ5IjoyMTZ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1377.033,166L1386.352,170.167C1395.671,174.333,1414.308,182.667,1423.627,190.333C1432.945,198,1432.945,205,1432.945,208.5L1432.945,212" id="L_E_N_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E_N_0" data-points="W3sieCI6MTM3Ny4wMzMzNTMzNjUzODQ1LCJ5IjoxNjZ9LHsieCI6MTQzMi45NDUzMTI1LCJ5IjoxOTF9LHsieCI6MTQzMi45NDUzMTI1LCJ5IjoyMTZ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" data-id="L_A_B_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_A_C_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_A_D_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_A_E_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_A_F_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_B_G_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_B_H_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_C_I_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_C_J_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_D_K_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_D_L_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_E_M_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_E_N_0" transform="translate(0, 0)"></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-0" transform="translate(911.8671875, 35)"><rect class="basic label-container" style="" x="-111.234375" y="-27" width="222.46875" height="54"/><g class="label" style="" transform="translate(-81.234375, -12)"><text x="81.234375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Security Testing Phase</text></g></g><g class="node default" id="flowchart-B-1" transform="translate(157.0390625, 139)"><rect class="basic label-container" style="fill:#e3f2fd !important" x="-109.4375" y="-27" width="218.875" height="54"/><g class="label" style="" transform="translate(-79.4375, -12)"><text x="79.4375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">SAST - Static Analysis</text></g></g><g class="node default" id="flowchart-C-3" transform="translate(560.6796875, 139)"><rect class="basic label-container" style="fill:#f3e5f5 !important" x="-120.9921875" y="-27" width="241.984375" height="54"/><g class="label" style="" transform="translate(-90.9921875, -12)"><text x="90.9921875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">DAST - Dynamic Analysis</text></g></g><g class="node default" id="flowchart-D-5" transform="translate(911.8671875, 139)"><rect class="basic label-container" style="fill:#fff3e0 !important" x="-110.5078125" y="-27" width="221.015625" height="54"/><g class="label" style="" transform="translate(-80.5078125, -12)"><text x="80.5078125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Dependency Scanning</text></g></g><g class="node default" id="flowchart-E-7" transform="translate(1316.6484375, 139)"><rect class="basic label-container" style="fill:#ffebee !important" x="-98.34375" y="-27" width="196.6875" height="54"/><g class="label" style="" transform="translate(-68.34375, -12)"><text x="68.34375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Penetration Testing</text></g></g><g class="node default" id="flowchart-F-9" transform="translate(1594.90625, 139)"><rect class="basic label-container" style="fill:#e8f5e9 !important" x="-129.9140625" y="-27" width="259.828125" height="54"/><g class="label" style="" transform="translate(-99.9140625, -12)"><text x="99.9140625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Security Acceptance Testing</text></g></g><g class="node default" id="flowchart-G-11" transform="translate(62.4609375, 243)"><rect class="basic label-container" style="" x="-54.4609375" y="-27" width="108.921875" height="54"/><g class="label" style="" transform="translate(-24.4609375, -12)"><text x="24.4609375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">GoSec</text></g></g><g class="node default" id="flowchart-H-13" transform="translate(251.6171875, 243)"><rect class="basic label-container" style="" x="-84.6953125" y="-27" width="169.390625" height="54"/><g class="label" style="" transform="translate(-54.6953125, -12)"><text x="54.6953125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">ESLint Security</text></g></g><g class="node default" id="flowchart-I-15" transform="translate(463.4375, 243)"><rect class="basic label-container" style="" x="-77.125" y="-27" width="154.25" height="54"/><g class="label" style="" transform="translate(-47.125, -12)"><text x="47.125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">OWASP ZAP</text></g></g><g class="node default" id="flowchart-J-17" transform="translate(657.921875, 243)"><rect class="basic label-container" style="" x="-67.359375" y="-27" width="134.71875" height="54"/><g class="label" style="" transform="translate(-37.359375, -12)"><text x="37.359375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Burp Suite</text></g></g><g class="node default" id="flowchart-K-19" transform="translate(827.9609375, 243)"><rect class="basic label-container" style="" x="-52.6796875" y="-27" width="105.359375" height="54"/><g class="label" style="" transform="translate(-22.6796875, -12)"><text x="22.6796875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Nancy</text></g></g><g class="node default" id="flowchart-L-21" transform="translate(995.7734375, 243)"><rect class="basic label-container" style="" x="-65.1328125" y="-27" width="130.265625" height="54"/><g class="label" style="" transform="translate(-35.1328125, -12)"><text x="35.1328125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">npm audit</text></g></g><g class="node default" id="flowchart-M-23" transform="translate(1200.3515625, 243)"><rect class="basic label-container" style="" x="-89.4453125" y="-27" width="178.890625" height="54"/><g class="label" style="" transform="translate(-59.4453125, -12)"><text x="59.4453125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Manual Pen Test</text></g></g><g class="node default" id="flowchart-N-25" transform="translate(1432.9453125, 243)"><rect class="basic label-container" style="" x="-93.1484375" y="-27" width="186.296875" height="54"/><g class="label" style="" transform="translate(-63.1484375, -12)"><text x="63.1484375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Automated Scans</text></g></g></g></g></g></svg>
</div>
<hr />
<h2 id="static-application-security-testing-sast">Static Application
Security Testing (SAST)</h2>
<h3 id="gosec-for-go-code">GoSec for Go Code</h3>
<p><strong>Configuration:</strong></p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .gosec.yml</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">&quot;global&quot;</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;nosec&quot;</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span><span class="kw">,</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;show-ignored&quot;</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span><span class="kw">,</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;confidence&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;medium&quot;</span><span class="kw">,</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;severity&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;medium&quot;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">},</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">&quot;rules&quot;</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;G101&quot;</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">&quot;description&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Look for hardcoded credentials&quot;</span><span class="kw">,</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">&quot;enabled&quot;</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">},</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;G102&quot;</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">&quot;description&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Bind to all interfaces&quot;</span><span class="kw">,</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">&quot;enabled&quot;</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">},</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;G103&quot;</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">&quot;description&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Audit unsafe block&quot;</span><span class="kw">,</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">&quot;enabled&quot;</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">},</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;G104&quot;</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">&quot;description&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Audit errors not checked&quot;</span><span class="kw">,</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">&quot;enabled&quot;</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">},</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;G201&quot;</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">&quot;description&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;SQL query construction using string building&quot;</span><span class="kw">,</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">&quot;enabled&quot;</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">},</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;G401&quot;</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">&quot;description&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Detect MD5 usage&quot;</span><span class="kw">,</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">&quot;enabled&quot;</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">},</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;G501&quot;</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">&quot;description&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Import blocklist: crypto/md5&quot;</span><span class="kw">,</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">&quot;enabled&quot;</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">}</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">}</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<p><strong>Running GoSec:</strong></p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install GoSec</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> install github.com/securego/gosec/v2/cmd/gosec@latest</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Run scan on entire project</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="ex">gosec</span> <span class="at">-fmt</span><span class="op">=</span>json <span class="at">-out</span><span class="op">=</span>gosec-report.json ./...</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Run with specific rules</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="ex">gosec</span> <span class="at">-include</span><span class="op">=</span>G101,G102,G103 ./...</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude test files</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="ex">gosec</span> <span class="at">-exclude-dir</span><span class="op">=</span>test ./...</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Set severity threshold</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="ex">gosec</span> <span class="at">-severity</span><span class="op">=</span>high ./...</span></code></pre></div>
<p><strong>Example GoSec Report:</strong></p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;Issues&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;severity&quot;</span><span class="fu">:</span> <span class="st">&quot;HIGH&quot;</span><span class="fu">,</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;confidence&quot;</span><span class="fu">:</span> <span class="st">&quot;HIGH&quot;</span><span class="fu">,</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;rule_id&quot;</span><span class="fu">:</span> <span class="st">&quot;G101&quot;</span><span class="fu">,</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;details&quot;</span><span class="fu">:</span> <span class="st">&quot;Potential hardcoded credentials&quot;</span><span class="fu">,</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;file&quot;</span><span class="fu">:</span> <span class="st">&quot;/src/config/config.go&quot;</span><span class="fu">,</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;password := </span><span class="ch">\&quot;</span><span class="st">hardcoded_password</span><span class="ch">\&quot;</span><span class="st">&quot;</span><span class="fu">,</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;line&quot;</span><span class="fu">:</span> <span class="st">&quot;45&quot;</span><span class="fu">,</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;column&quot;</span><span class="fu">:</span> <span class="st">&quot;12&quot;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;severity&quot;</span><span class="fu">:</span> <span class="st">&quot;MEDIUM&quot;</span><span class="fu">,</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;confidence&quot;</span><span class="fu">:</span> <span class="st">&quot;HIGH&quot;</span><span class="fu">,</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;rule_id&quot;</span><span class="fu">:</span> <span class="st">&quot;G104&quot;</span><span class="fu">,</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;details&quot;</span><span class="fu">:</span> <span class="st">&quot;Errors unhandled&quot;</span><span class="fu">,</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;file&quot;</span><span class="fu">:</span> <span class="st">&quot;/src/api/handler.go&quot;</span><span class="fu">,</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;db.Query(sql)&quot;</span><span class="fu">,</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;line&quot;</span><span class="fu">:</span> <span class="st">&quot;123&quot;</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;Stats&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;files&quot;</span><span class="fu">:</span> <span class="dv">150</span><span class="fu">,</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;lines&quot;</span><span class="fu">:</span> <span class="dv">25000</span><span class="fu">,</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;nosec&quot;</span><span class="fu">:</span> <span class="dv">5</span><span class="fu">,</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;found&quot;</span><span class="fu">:</span> <span class="dv">2</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 id="eslint-security-plugin-for-javascript">ESLint Security Plugin
for JavaScript</h3>
<p><strong>Configuration:</strong></p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">// .eslintrc.js</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> {</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">plugins</span><span class="op">:</span> [<span class="st">&#39;security&#39;</span>]<span class="op">,</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">extends</span><span class="op">:</span> [<span class="st">&#39;plugin:security/recommended&#39;</span>]<span class="op">,</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">rules</span><span class="op">:</span> {</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;security/detect-object-injection&#39;</span><span class="op">:</span> <span class="st">&#39;error&#39;</span><span class="op">,</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;security/detect-non-literal-regexp&#39;</span><span class="op">:</span> <span class="st">&#39;warn&#39;</span><span class="op">,</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;security/detect-unsafe-regex&#39;</span><span class="op">:</span> <span class="st">&#39;error&#39;</span><span class="op">,</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;security/detect-buffer-noassert&#39;</span><span class="op">:</span> <span class="st">&#39;error&#39;</span><span class="op">,</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;security/detect-child-process&#39;</span><span class="op">:</span> <span class="st">&#39;warn&#39;</span><span class="op">,</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;security/detect-disable-mustache-escape&#39;</span><span class="op">:</span> <span class="st">&#39;error&#39;</span><span class="op">,</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;security/detect-eval-with-expression&#39;</span><span class="op">:</span> <span class="st">&#39;error&#39;</span><span class="op">,</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;security/detect-no-csrf-before-method-override&#39;</span><span class="op">:</span> <span class="st">&#39;error&#39;</span><span class="op">,</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;security/detect-non-literal-fs-filename&#39;</span><span class="op">:</span> <span class="st">&#39;warn&#39;</span><span class="op">,</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;security/detect-non-literal-require&#39;</span><span class="op">:</span> <span class="st">&#39;warn&#39;</span><span class="op">,</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;security/detect-possible-timing-attacks&#39;</span><span class="op">:</span> <span class="st">&#39;warn&#39;</span><span class="op">,</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;security/detect-pseudoRandomBytes&#39;</span><span class="op">:</span> <span class="st">&#39;error&#39;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p><strong>Running ESLint:</strong></p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install ESLint and security plugin</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install <span class="at">--save-dev</span> eslint eslint-plugin-security</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Run ESLint security scan</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="ex">eslint</span> <span class="at">--ext</span> .js,.jsx src/ <span class="at">--format</span> json <span class="at">--output-file</span> eslint-report.json</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Run with auto-fix for some issues</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="ex">eslint</span> <span class="at">--ext</span> .js,.jsx src/ <span class="at">--fix</span></span></code></pre></div>
<hr />
<h2 id="dynamic-application-security-testing-dast">Dynamic Application
Security Testing (DAST)</h2>
<h3 id="owasp-zap-integration">OWASP ZAP Integration</h3>
<p><strong>ZAP Configuration:</strong></p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zap-config.yaml</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">contexts</span><span class="kw">:</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;SECURAA Application&quot;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">urls</span><span class="kw">:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;https://test.securaa.io&quot;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">includePaths</span><span class="kw">:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;https://test.securaa.io/api/.*&quot;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">excludePaths</span><span class="kw">:</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;https://test.securaa.io/logout&quot;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">authentication</span><span class="kw">:</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;form&quot;</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">loginUrl</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;https://test.securaa.io/login&quot;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">loginRequestData</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;username={%username%}&amp;password={%password%}&quot;</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">usernameParameter</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;username&quot;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">passwordParameter</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;password&quot;</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">users</span><span class="kw">:</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;test_user&quot;</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">credentials</span><span class="kw">:</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">username</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;test@securaa.io&quot;</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">password</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Test123!@#&quot;</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">scanners</span><span class="kw">:</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">passive</span><span class="kw">:</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> </span><span class="dv">10010</span><span class="co">  # Cookie Poisoning</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> </span><span class="dv">10015</span><span class="co">  # Incomplete or No Cache-control</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> </span><span class="dv">10017</span><span class="co">  # Cross-Domain JavaScript Source File Inclusion</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> </span><span class="dv">10019</span><span class="co">  # Content-Type Header Missing</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> </span><span class="dv">10020</span><span class="co">  # X-Frame-Options Header Not Set</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> </span><span class="dv">10021</span><span class="co">  # X-Content-Type-Options Header Missing</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">active</span><span class="kw">:</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> </span><span class="dv">40012</span><span class="co">  # Cross Site Scripting (Reflected)</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> </span><span class="dv">40014</span><span class="co">  # Cross Site Scripting (Persistent)</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> </span><span class="dv">40016</span><span class="co">  # Cross Site Scripting (Persistent - Prime)</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> </span><span class="dv">40017</span><span class="co">  # Cross Site Scripting (Persistent - Spider)</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> </span><span class="dv">40018</span><span class="co">  # SQL Injection</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> </span><span class="dv">90019</span><span class="co">  # Server Side Include</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> </span><span class="dv">90020</span><span class="co">  # Remote OS Command Injection</span></span></code></pre></div>
<p><strong>Running OWASP ZAP:</strong></p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># run-zap-scan.sh</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Start ZAP in daemon mode</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> <span class="at">--name</span> zap <span class="dt">\</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">-p</span> 8080:8080 <span class="dt">\</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">-v</span> <span class="va">$(</span><span class="bu">pwd</span><span class="va">)</span>/zap-config:/zap/config:rw <span class="dt">\</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  owasp/zap2docker-stable zap.sh <span class="at">-daemon</span> <span class="dt">\</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">-host</span> 0.0.0.0 <span class="at">-port</span> 8080 <span class="dt">\</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">-config</span> api.key=securaa-zap-key</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wait for ZAP to start</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">sleep</span> 30</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Run spider scan</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="st">&quot;http://localhost:8080/JSON/spider/action/scan/&quot;</span> <span class="dt">\</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">--data</span> <span class="st">&quot;url=https://test.securaa.io&amp;apikey=securaa-zap-key&quot;</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Run active scan</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="st">&quot;http://localhost:8080/JSON/ascan/action/scan/&quot;</span> <span class="dt">\</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">--data</span> <span class="st">&quot;url=https://test.securaa.io&amp;apikey=securaa-zap-key&quot;</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Wait for scan to complete</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="bu">[</span> <span class="va">$(</span><span class="ex">curl</span> <span class="st">&quot;http://localhost:8080/JSON/ascan/view/status/?apikey=securaa-zap-key&quot;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.status&#39;</span><span class="va">)</span> <span class="ot">-ne</span> <span class="st">&quot;100&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;Scan in progress...&quot;</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sleep</span> 30</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate HTML report</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="st">&quot;http://localhost:8080/OTHER/core/other/htmlreport/?apikey=securaa-zap-key&quot;</span> <span class="dt">\</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">-o</span> zap-report.html</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate JSON report</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="st">&quot;http://localhost:8080/JSON/core/view/alerts/?apikey=securaa-zap-key&quot;</span> <span class="dt">\</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">-o</span> zap-report.json</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Stop ZAP</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> stop zap <span class="kw">&amp;&amp;</span> <span class="ex">docker</span> rm zap</span></code></pre></div>
<p><strong>ZAP Report Analysis:</strong></p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># analyze-zap-results.py</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> analyze_zap_report(report_file):</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(report_file, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> json.load(f)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    alerts <span class="op">=</span> data.get(<span class="st">&#39;alerts&#39;</span>, [])</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Categorize by risk level</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    critical <span class="op">=</span> [a <span class="cf">for</span> a <span class="kw">in</span> alerts <span class="cf">if</span> a[<span class="st">&#39;risk&#39;</span>] <span class="op">==</span> <span class="st">&#39;High&#39;</span>]</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    high <span class="op">=</span> [a <span class="cf">for</span> a <span class="kw">in</span> alerts <span class="cf">if</span> a[<span class="st">&#39;risk&#39;</span>] <span class="op">==</span> <span class="st">&#39;Medium&#39;</span>]</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    medium <span class="op">=</span> [a <span class="cf">for</span> a <span class="kw">in</span> alerts <span class="cf">if</span> a[<span class="st">&#39;risk&#39;</span>] <span class="op">==</span> <span class="st">&#39;Low&#39;</span>]</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;OWASP ZAP Security Scan Results&quot;</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;================================&quot;</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Total Alerts: </span><span class="sc">{</span><span class="bu">len</span>(alerts)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Critical (High): </span><span class="sc">{</span><span class="bu">len</span>(critical)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;High (Medium): </span><span class="sc">{</span><span class="bu">len</span>(high)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Medium (Low): </span><span class="sc">{</span><span class="bu">len</span>(medium)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print critical issues</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> critical:</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;CRITICAL ISSUES:&quot;</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> alert <span class="kw">in</span> critical:</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;  - </span><span class="sc">{</span>alert[<span class="st">&#39;alert&#39;</span>]<span class="sc">}</span><span class="ss"> at </span><span class="sc">{</span>alert[<span class="st">&#39;url&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;    </span><span class="sc">{</span>alert[<span class="st">&#39;description&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>()</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fail if critical issues found</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> critical:</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    sys.exit(<span class="dv">0</span>)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    analyze_zap_report(<span class="st">&#39;zap-report.json&#39;</span>)</span></code></pre></div>
<hr />
<h2 id="dependency-vulnerability-scanning">Dependency Vulnerability
Scanning</h2>
<h3 id="nancy-for-go-dependencies">Nancy for Go Dependencies</h3>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install Nancy</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> install github.com/sonatype-nexus-community/nancy@latest</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Scan dependencies</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> list <span class="at">-json</span> <span class="at">-m</span> all <span class="kw">|</span> <span class="ex">nancy</span> sleuth</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Output to JSON</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> list <span class="at">-json</span> <span class="at">-m</span> all <span class="kw">|</span> <span class="ex">nancy</span> sleuth <span class="at">-output</span> json <span class="op">&gt;</span> nancy-report.json</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set severity threshold</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> list <span class="at">-json</span> <span class="at">-m</span> all <span class="kw">|</span> <span class="ex">nancy</span> sleuth <span class="at">-exclude-vulnerability</span> CVE-2021-12345</span></code></pre></div>
<h3 id="npm-audit-for-javascript">npm audit for JavaScript</h3>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run npm audit</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> audit <span class="at">--json</span> <span class="op">&gt;</span> npm-audit-report.json</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix vulnerabilities automatically</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> audit fix</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Force fix (may introduce breaking changes)</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> audit fix <span class="at">--force</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Check specific package</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> audit <span class="at">--package</span><span class="op">=</span>lodash</span></code></pre></div>
<h3 id="govulncheck-for-go-vulnerabilities">govulncheck for Go
Vulnerabilities</h3>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install govulncheck</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> install golang.org/x/vuln/cmd/govulncheck@latest</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Run vulnerability check</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="ex">govulncheck</span> ./...</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Output to JSON</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="ex">govulncheck</span> <span class="at">-json</span> ./... <span class="op">&gt;</span> govulncheck-report.json</span></code></pre></div>
<hr />
<h2 id="penetration-testing">Penetration Testing</h2>
<h3 id="penetration-testing-scope">Penetration Testing Scope</h3>
<div class="sourceCode" id="cb12"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">penetration_testing</span><span class="kw">:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">scope</span><span class="kw">:</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">in_scope</span><span class="kw">:</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Web application (https://test.securaa.io)</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> API endpoints (/api/*)</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Authentication mechanisms</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Authorization controls</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Input validation</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Session management</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Integration endpoints</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">out_of_scope</span><span class="kw">:</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Third-party services</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Physical security</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Social engineering</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Denial of Service testing</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Production systems</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">methodology</span><span class="kw">:</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> OWASP Testing Guide v4.2</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> PTES (Penetration Testing Execution Standard)</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> NIST SP 800-115</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">test_scenarios</span><span class="kw">:</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">authentication</span><span class="kw">:</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Brute force attacks</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Credential stuffing</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Session hijacking</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Token manipulation</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> MFA bypass attempts</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">authorization</span><span class="kw">:</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Privilege escalation</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Horizontal privilege escalation</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Direct object references</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Missing function level access control</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">injection</span><span class="kw">:</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> SQL injection</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> NoSQL injection</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Command injection</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> LDAP injection</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> XPath injection</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">xss</span><span class="kw">:</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Reflected XSS</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Stored XSS</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> DOM-based XSS</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> XSS in file uploads</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">business_logic</span><span class="kw">:</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Payment bypass</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Rate limiting bypass</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Workflow manipulation</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Price manipulation</span></span></code></pre></div>
<h3 id="penetration-testing-checklist">Penetration Testing
Checklist</h3>
<div class="sourceCode" id="cb13"><pre
class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">## Authentication Testing</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test password policy enforcement</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test account lockout mechanism</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test password reset functionality</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test remember me functionality</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test browser cache for credentials</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test autocomplete on password forms</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test weak credentials (admin/admin)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test for username enumeration</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test multi-factor authentication</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test session timeout</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## Authorization Testing</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test directory traversal</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test forced browsing</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test privilege escalation</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test insecure direct object references</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test missing function level access control</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test horizontal privilege escalation</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test API authorization</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="fu">## Input Validation Testing</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test SQL injection (all parameters)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test NoSQL injection</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test command injection</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test LDAP injection</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test XSS (reflected, stored, DOM)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test XXE injection</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test file upload vulnerabilities</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test buffer overflow</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test format string vulnerabilities</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session Management Testing</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test session fixation</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test session hijacking</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test CSRF protection</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test session timeout</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test logout functionality</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test concurrent sessions</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test session token randomness</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cryptography Testing</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test SSL/TLS configuration</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test weak cipher suites</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test certificate validation</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test sensitive data encryption</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test password storage</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test random number generation</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="fu">## Business Logic Testing</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test payment processing</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test workflow bypass</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test price manipulation</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test quantity limits</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test race conditions</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test rate limiting</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a><span class="fu">## API Security Testing</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test authentication mechanisms</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test authorization controls</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test rate limiting</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test input validation</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test error handling</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test API versioning</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Test CORS configuration</span></code></pre></div>
<hr />
<h2 id="security-acceptance-testing">Security Acceptance Testing</h2>
<h3 id="security-test-cases">Security Test Cases</h3>
<pre class="gherkin"><code>Feature: Secure Authentication

  Scenario: Successful login with valid credentials
    Given the user has valid credentials
    When the user attempts to login
    Then the login should succeed
    And a secure session should be created
    And the login event should be logged
    
  Scenario: Failed login with invalid credentials
    Given the user has invalid credentials
    When the user attempts to login
    Then the login should fail
    And a generic error message should be displayed
    And the failed login attempt should be logged
    And no sensitive information should be exposed
    
  Scenario: Account lockout after multiple failed attempts
    Given the user has made 4 failed login attempts
    When the user makes a 5th failed login attempt
    Then the account should be locked
    And the user should be notified of the lockout
    And the security team should be alerted
    And the lockout event should be logged
    
  Scenario: SQL injection attempt blocked
    Given the user submits malicious SQL in login form
    When the system processes the input
    Then the SQL injection should be blocked
    And the user should receive an error message
    And the attack attempt should be logged
    And the input should not affect the database

Feature: Secure Data Handling

  Scenario: Sensitive data encrypted at rest
    Given sensitive data needs to be stored
    When the data is saved to the database
    Then the data should be encrypted with AES-256
    And the encryption key should be stored securely
    And unencrypted data should never be logged
    
  Scenario: PII data masked in logs
    Given an operation involves PII data
    When the operation is logged
    Then PII data should be masked
    And email addresses should be partially masked
    And phone numbers should be partially masked
    And credit card numbers should not appear in logs</code></pre>
<hr />
<h1 id="phase-6-build-deployment">PHASE 6: BUILD &amp; DEPLOYMENT</h1>
<h2 id="aws-codebuild-integration">AWS CodeBuild Integration</h2>
<h3 id="codebuild-project-configuration">CodeBuild Project
Configuration</h3>
<div class="sourceCode" id="cb15"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Core_BuildSpec.yaml (Detailed)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.2</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">variables</span><span class="kw">:</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">GO111MODULE</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;on&quot;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">GOPATH</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;/go&quot;</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ECR_REGISTRY</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;665853670667.dkr.ecr.us-east-2.amazonaws.com&quot;</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">IMAGE_TAG</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;latest&quot;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">parameter-store</span><span class="kw">:</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">DOCKER_USERNAME</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;/securaa/docker/username&quot;</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">DOCKER_PASSWORD</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;/securaa/docker/password&quot;</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">secrets-manager</span><span class="kw">:</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">DB_PASSWORD</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;securaa/prod/db:password&quot;</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ENCRYPTION_KEY</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;securaa/prod/encryption:key&quot;</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="fu">phases</span><span class="kw">:</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">install</span><span class="kw">:</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">runtime-versions</span><span class="kw">:</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">golang</span><span class="kw">:</span><span class="at"> </span><span class="fl">1.17</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">nodejs</span><span class="kw">:</span><span class="at"> </span><span class="dv">16</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">python</span><span class="kw">:</span><span class="at"> </span><span class="fl">3.9</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Installing dependencies...&quot;</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> apt-get update -y</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> apt-get install -y jq unzip</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co">      # Install security tools</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go install github.com/securego/gosec/v2/cmd/gosec@latest</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go install github.com/sonatype-nexus-community/nancy@latest</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go install golang.org/x/vuln/cmd/govulncheck@latest</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> npm install -g snyk</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pre_build</span><span class="kw">:</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Pre-build phase started...&quot;</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Current directory:&quot; &amp;&amp; pwd</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Listing files:&quot; &amp;&amp; ls -la</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a><span class="co">      # Download dependencies from internal repo</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> wget https://repo.securaa.io/github.com.zip</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> unzip -q github.com.zip -d $GOPATH/src/</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> wget https://repo.securaa.io/gopkg.in.zip</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> unzip -q gopkg.in.zip -d $GOPATH/src/</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a><span class="co">      # ECR Login</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Logging into Amazon ECR...&quot;</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> aws ecr get-login-password --region us-east-2 | docker login --username AWS --password-stdin $ECR_REGISTRY</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a><span class="co">      # Security Scans</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running GoSec security scan...&quot;</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> gosec -fmt=json -out=gosec-report.json ./... || true</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running dependency vulnerability scan...&quot;</span></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go list -json -m all | nancy sleuth -output json &gt; nancy-report.json || true</span></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running govulncheck...&quot;</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> govulncheck ./... || true</span></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a><span class="co">      # Analyze scan results</span></span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Analyzing security scan results...&quot;</span></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> python3 scripts/analyze-security-results.py</span></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">build</span><span class="kw">:</span></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Build phase started...&quot;</span></span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cd $CODEBUILD_SRC_DIR</span></span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a><span class="co">      # Go build</span></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Building Go services...&quot;</span></span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> export GO111MODULE=on</span></span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go mod tidy -compat=1.17</span></span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go mod verify</span></span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> make clean</span></span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> make vendor</span></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> make build</span></span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a><span class="co">      # Run tests</span></span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running unit tests...&quot;</span></span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go test ./... -v -coverprofile=coverage.out</span></span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go tool cover -func=coverage.out</span></span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a><span class="co">      # Build Docker images</span></span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Building Docker images...&quot;</span></span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>        for service in zona_user zona_integrations zona_siem; do</span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>          echo &quot;Building $service...&quot;</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>          docker build \</span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>            --build-arg BUILD_DATE=$(date -u +&#39;%Y-%m-%dT%H:%M:%SZ&#39;) \</span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>            --build-arg VCS_REF=$(git rev-parse --short HEAD) \</span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>            --build-arg VERSION=$IMAGE_TAG \</span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a>            --tag $ECR_REGISTRY/securaa/$service:$IMAGE_TAG \</span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>            --tag $ECR_REGISTRY/securaa/$service:$CODEBUILD_BUILD_NUMBER \</span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>            -f zona_services/$service/Dockerfile \</span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>            .</span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>          # Scan image for vulnerabilities</span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>          echo &quot;Scanning $service image...&quot;</span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a>          docker scan $ECR_REGISTRY/securaa/$service:$IMAGE_TAG || true</span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a>        done</span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a><span class="co">      # Build RPM packages</span></span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Building RPM packages...&quot;</span></span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cd $CODEBUILD_SRC_DIR/pkg</span></span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> make clean rpm_mssp_core</span></span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">post_build</span><span class="kw">:</span></span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Post-build phase started...&quot;</span></span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a><span class="co">      # Push Docker images to ECR</span></span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Pushing images to ECR...&quot;</span></span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a>        for service in zona_user zona_integrations zona_siem; do</span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a>          docker push $ECR_REGISTRY/securaa/$service:$IMAGE_TAG</span>
<span id="cb15-118"><a href="#cb15-118" aria-hidden="true" tabindex="-1"></a>          docker push $ECR_REGISTRY/securaa/$service:$CODEBUILD_BUILD_NUMBER</span>
<span id="cb15-119"><a href="#cb15-119" aria-hidden="true" tabindex="-1"></a>        done</span>
<span id="cb15-120"><a href="#cb15-120" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb15-121"><a href="#cb15-121" aria-hidden="true" tabindex="-1"></a><span class="co">      # Generate build metadata</span></span>
<span id="cb15-122"><a href="#cb15-122" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Generating build metadata...&quot;</span></span>
<span id="cb15-123"><a href="#cb15-123" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb15-124"><a href="#cb15-124" aria-hidden="true" tabindex="-1"></a>        cat &gt; build-metadata.json &lt;&lt;EOF</span>
<span id="cb15-125"><a href="#cb15-125" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb15-126"><a href="#cb15-126" aria-hidden="true" tabindex="-1"></a>          &quot;build_number&quot;: &quot;$CODEBUILD_BUILD_NUMBER&quot;,</span>
<span id="cb15-127"><a href="#cb15-127" aria-hidden="true" tabindex="-1"></a>          &quot;build_id&quot;: &quot;$CODEBUILD_BUILD_ID&quot;,</span>
<span id="cb15-128"><a href="#cb15-128" aria-hidden="true" tabindex="-1"></a>          &quot;commit_id&quot;: &quot;$(git rev-parse HEAD)&quot;,</span>
<span id="cb15-129"><a href="#cb15-129" aria-hidden="true" tabindex="-1"></a>          &quot;commit_message&quot;: &quot;$(git log -1 --pretty=%B)&quot;,</span>
<span id="cb15-130"><a href="#cb15-130" aria-hidden="true" tabindex="-1"></a>          &quot;build_timestamp&quot;: &quot;$(date -u +&#39;%Y-%m-%dT%H:%M:%SZ&#39;)&quot;,</span>
<span id="cb15-131"><a href="#cb15-131" aria-hidden="true" tabindex="-1"></a>          &quot;images&quot;: [</span>
<span id="cb15-132"><a href="#cb15-132" aria-hidden="true" tabindex="-1"></a>            &quot;$ECR_REGISTRY/securaa/zona_user:$CODEBUILD_BUILD_NUMBER&quot;,</span>
<span id="cb15-133"><a href="#cb15-133" aria-hidden="true" tabindex="-1"></a>            &quot;$ECR_REGISTRY/securaa/zona_integrations:$CODEBUILD_BUILD_NUMBER&quot;,</span>
<span id="cb15-134"><a href="#cb15-134" aria-hidden="true" tabindex="-1"></a>            &quot;$ECR_REGISTRY/securaa/zona_siem:$CODEBUILD_BUILD_NUMBER&quot;</span>
<span id="cb15-135"><a href="#cb15-135" aria-hidden="true" tabindex="-1"></a>          ]</span>
<span id="cb15-136"><a href="#cb15-136" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-137"><a href="#cb15-137" aria-hidden="true" tabindex="-1"></a>        EOF</span>
<span id="cb15-138"><a href="#cb15-138" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb15-139"><a href="#cb15-139" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Build completed successfully!&quot;</span></span>
<span id="cb15-140"><a href="#cb15-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-141"><a href="#cb15-141" aria-hidden="true" tabindex="-1"></a><span class="fu">artifacts</span><span class="kw">:</span></span>
<span id="cb15-142"><a href="#cb15-142" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">files</span><span class="kw">:</span></span>
<span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;**/*&#39;</span></span>
<span id="cb15-144"><a href="#cb15-144" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> securaa-build-$CODEBUILD_BUILD_NUMBER</span></span>
<span id="cb15-145"><a href="#cb15-145" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">base-directory</span><span class="kw">:</span><span class="at"> $CODEBUILD_SRC_DIR</span></span>
<span id="cb15-146"><a href="#cb15-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-147"><a href="#cb15-147" aria-hidden="true" tabindex="-1"></a><span class="fu">reports</span><span class="kw">:</span></span>
<span id="cb15-148"><a href="#cb15-148" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">SecurityReports</span><span class="kw">:</span></span>
<span id="cb15-149"><a href="#cb15-149" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">files</span><span class="kw">:</span></span>
<span id="cb15-150"><a href="#cb15-150" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;gosec-report.json&#39;</span></span>
<span id="cb15-151"><a href="#cb15-151" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;nancy-report.json&#39;</span></span>
<span id="cb15-152"><a href="#cb15-152" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">file-format</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;JSON&#39;</span></span>
<span id="cb15-153"><a href="#cb15-153" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb15-154"><a href="#cb15-154" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">TestReports</span><span class="kw">:</span></span>
<span id="cb15-155"><a href="#cb15-155" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">files</span><span class="kw">:</span></span>
<span id="cb15-156"><a href="#cb15-156" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;coverage.out&#39;</span></span>
<span id="cb15-157"><a href="#cb15-157" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">file-format</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;GOCOVERPROFILE&#39;</span></span>
<span id="cb15-158"><a href="#cb15-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-159"><a href="#cb15-159" aria-hidden="true" tabindex="-1"></a><span class="fu">cache</span><span class="kw">:</span></span>
<span id="cb15-160"><a href="#cb15-160" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">paths</span><span class="kw">:</span></span>
<span id="cb15-161"><a href="#cb15-161" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;/root/.cache/go-build/**/*&#39;</span></span>
<span id="cb15-162"><a href="#cb15-162" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;/go/pkg/mod/**/*&#39;</span></span></code></pre></div>
<h3 id="build-security-gates">Build Security Gates</h3>
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scripts/analyze-security-results.py</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> analyze_gosec_report():</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Analyze GoSec results and fail build if critical issues found&quot;&quot;&quot;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;gosec-report.json&#39;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>            report <span class="op">=</span> json.load(f)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        issues <span class="op">=</span> report.get(<span class="st">&#39;Issues&#39;</span>, [])</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        critical <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> issues <span class="cf">if</span> i[<span class="st">&#39;severity&#39;</span>] <span class="op">==</span> <span class="st">&#39;HIGH&#39;</span> <span class="kw">and</span> i[<span class="st">&#39;confidence&#39;</span>] <span class="op">==</span> <span class="st">&#39;HIGH&#39;</span>]</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        high <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> issues <span class="cf">if</span> i[<span class="st">&#39;severity&#39;</span>] <span class="op">==</span> <span class="st">&#39;MEDIUM&#39;</span> <span class="kw">and</span> i[<span class="st">&#39;confidence&#39;</span>] <span class="op">==</span> <span class="st">&#39;HIGH&#39;</span>]</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">=== GoSec Results ===&quot;</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Critical Issues: </span><span class="sc">{</span><span class="bu">len</span>(critical)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;High Issues: </span><span class="sc">{</span><span class="bu">len</span>(high)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> critical:</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">CRITICAL ISSUES FOUND:&quot;</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> issue <span class="kw">in</span> critical:</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;  </span><span class="sc">{</span>issue[<span class="st">&#39;rule_id&#39;</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>issue[<span class="st">&#39;details&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;  File: </span><span class="sc">{</span>issue[<span class="st">&#39;file&#39;</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>issue[<span class="st">&#39;line&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Error analyzing GoSec report: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span>  <span class="co"># Don&#39;t fail build on analysis error</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> analyze_nancy_report():</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Analyze Nancy dependency scan results&quot;&quot;&quot;</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;nancy-report.json&#39;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>            report <span class="op">=</span> json.load(f)</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>        vulnerable <span class="op">=</span> report.get(<span class="st">&#39;vulnerable&#39;</span>, [])</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>        critical_vulns <span class="op">=</span> [v <span class="cf">for</span> v <span class="kw">in</span> vulnerable <span class="cf">if</span> v.get(<span class="st">&#39;cvss_score&#39;</span>, <span class="dv">0</span>) <span class="op">&gt;=</span> <span class="fl">9.0</span>]</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">=== Nancy Dependency Scan ===&quot;</span>)</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Total Vulnerable Dependencies: </span><span class="sc">{</span><span class="bu">len</span>(vulnerable)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Critical Vulnerabilities (CVSS &gt;= 9.0): </span><span class="sc">{</span><span class="bu">len</span>(critical_vulns)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> critical_vulns:</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">CRITICAL VULNERABILITIES FOUND:&quot;</span>)</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> vuln <span class="kw">in</span> critical_vulns:</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;  </span><span class="sc">{</span>vuln[<span class="st">&#39;coordinates&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;  CVE: </span><span class="sc">{</span>vuln[<span class="st">&#39;cve&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;  CVSS: </span><span class="sc">{</span>vuln[<span class="st">&#39;cvss_score&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Error analyzing Nancy report: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>    gosec_ok <span class="op">=</span> analyze_gosec_report()</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>    nancy_ok <span class="op">=</span> analyze_nancy_report()</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> gosec_ok <span class="kw">or</span> <span class="kw">not</span> nancy_ok:</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> BUILD FAILED: Critical security issues found!&quot;</span>)</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Security checks passed!&quot;</span>)</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">0</span>)</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<hr />
<h2 id="container-security">Container Security</h2>
<h3 id="secure-dockerfile">Secure Dockerfile</h3>
<div class="sourceCode" id="cb17"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multi-stage build for security and size optimization</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> golang:1.17-alpine <span class="kw">AS</span> builder</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Add CA certificates</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">apk</span> <span class="at">--no-cache</span> add ca-certificates git</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Create non-root user</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">addgroup</span> <span class="at">-S</span> appgroup <span class="kw">&amp;&amp;</span> <span class="ex">adduser</span> <span class="at">-S</span> appuser <span class="at">-G</span> appgroup</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="kw">WORKDIR</span> /build</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy go mod files</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> go.mod go.sum ./</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">go</span> mod download <span class="kw">&amp;&amp;</span> <span class="ex">go</span> mod verify</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy source code</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> . .</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Build with security flags</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="va">CGO_ENABLED</span><span class="op">=</span>0 <span class="va">GOOS</span><span class="op">=</span>linux <span class="va">GOARCH</span><span class="op">=</span>amd64 <span class="dt">\</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="ex">go</span> build <span class="at">-a</span> <span class="at">-installsuffix</span> cgo <span class="dt">\</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">-ldflags</span><span class="op">=</span><span class="st">&#39;-w -s -extldflags &quot;-static&quot;&#39;</span> <span class="dt">\</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">-o</span> /app/main ./cmd/main.go</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Final stage - minimal image</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> alpine:3.18</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Install only CA certificates and upgrade packages</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">apk</span> <span class="at">--no-cache</span> add ca-certificates tzdata <span class="kw">&amp;&amp;</span> <span class="dt">\</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    <span class="ex">apk</span> <span class="at">--no-cache</span> upgrade <span class="kw">&amp;&amp;</span> <span class="dt">\</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span> <span class="at">-rf</span> /var/cache/apk/<span class="pp">*</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Create non-root user</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">addgroup</span> <span class="at">-S</span> appgroup <span class="kw">&amp;&amp;</span> <span class="ex">adduser</span> <span class="at">-S</span> appuser <span class="at">-G</span> appgroup</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Create necessary directories with proper permissions</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="fu">mkdir</span> <span class="at">-p</span> /app/logs /app/data <span class="kw">&amp;&amp;</span> <span class="dt">\</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">chown</span> <span class="at">-R</span> appuser:appgroup /app</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Switch to non-root user</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="kw">USER</span> appuser</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="kw">WORKDIR</span> /app</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy binary from builder with proper ownership</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> <span class="op">--from=builder</span> <span class="op">--chown=appuser:appgroup</span> /app/main .</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Use non-privileged port</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPOSE</span> 8080</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Define health check</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a><span class="kw">HEALTHCHECK</span> <span class="op">--interval=30s</span> <span class="op">--timeout=3s</span> <span class="op">--start-period=5s</span> <span class="op">--retries=3</span> \</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  <span class="kw">CMD</span> <span class="fu">wget</span> <span class="at">--no-verbose</span> <span class="at">--tries</span><span class="op">=</span>1 <span class="at">--spider</span> http://localhost:8080/health <span class="kw">||</span> <span class="bu">exit</span> 1</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Set read-only root filesystem (add volumes for writable dirs)</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="kw">VOLUME</span> [<span class="st">&quot;/app/logs&quot;</span>, <span class="st">&quot;/app/data&quot;</span>]</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Drop all capabilities and add only required ones</span></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="co"># These are enforced at runtime via docker-compose or kubernetes</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Run application</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;./main&quot;</span>]</span></code></pre></div>
<h3 id="container-scanning">Container Scanning</h3>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># scan-container.sh</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="va">IMAGE</span><span class="op">=</span><span class="va">$1</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Scanning Docker image: </span><span class="va">$IMAGE</span><span class="st">&quot;</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Scan with Docker Scout (if available)</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">command</span> <span class="at">-v</span> docker scout <span class="op">&amp;&gt;</span> /dev/null<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Running Docker Scout scan...&quot;</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="ex">docker</span> scout cves <span class="va">$IMAGE</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Scan with Trivy</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Running Trivy scan...&quot;</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">--rm</span> <span class="dt">\</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">-v</span> /var/run/docker.sock:/var/run/docker.sock <span class="dt">\</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    aquasec/trivy image <span class="dt">\</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">--severity</span> HIGH,CRITICAL <span class="dt">\</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">--format</span> json <span class="dt">\</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">--output</span> trivy-report.json <span class="dt">\</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="va">$IMAGE</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Analyze results</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> <span class="op">&lt;&lt; &#39;EOF&#39;</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="st">import json</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="st">with open(&#39;trivy-report.json&#39;, &#39;r&#39;) as f:</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="st">    report = json.load(f)</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="st">critical = 0</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="st">high = 0</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="st">for result in report.get(&#39;Results&#39;, []):</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="st">    for vuln in result.get(&#39;Vulnerabilities&#39;, []):</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="st">        severity = vuln.get(&#39;Severity&#39;, &#39;&#39;)</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="st">        if severity == &#39;CRITICAL&#39;:</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="st">            critical += 1</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="st">        elif severity == &#39;HIGH&#39;:</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="st">            high += 1</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a><span class="st">print(f&quot;\nScan Summary:&quot;)</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a><span class="st">print(f&quot;Critical: {critical}&quot;)</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a><span class="st">print(f&quot;High: {high}&quot;)</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a><span class="st">if critical &gt; 0:</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a><span class="st">    print(&quot;\n CRITICAL vulnerabilities found!&quot;)</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a><span class="st">    exit(1)</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a><span class="st">else:</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a><span class="st">    print(&quot;\n No critical vulnerabilities!&quot;)</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a><span class="st">    exit(0)</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span></code></pre></div>
<hr />
<h2 id="amazon-ecr-security">Amazon ECR Security</h2>
<h3 id="ecr-repository-configuration">ECR Repository Configuration</h3>
<div class="sourceCode" id="cb19"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;repositoryName&quot;</span><span class="fu">:</span> <span class="st">&quot;securaa/zona_services&quot;</span><span class="fu">,</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;imageScanningConfiguration&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;scanOnPush&quot;</span><span class="fu">:</span> <span class="kw">true</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;encryptionConfiguration&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;encryptionType&quot;</span><span class="fu">:</span> <span class="st">&quot;KMS&quot;</span><span class="fu">,</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;kmsKey&quot;</span><span class="fu">:</span> <span class="st">&quot;arn:aws:kms:us-east-2:665853670667:key/securaa-ecr-key&quot;</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;imageTagMutability&quot;</span><span class="fu">:</span> <span class="st">&quot;IMMUTABLE&quot;</span><span class="fu">,</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;lifecyclePolicy&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;rules&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;rulePriority&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Keep last 10 production images&quot;</span><span class="fu">,</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;selection&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;tagStatus&quot;</span><span class="fu">:</span> <span class="st">&quot;tagged&quot;</span><span class="fu">,</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;tagPrefixList&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;prod&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;countType&quot;</span><span class="fu">:</span> <span class="st">&quot;imageCountMoreThan&quot;</span><span class="fu">,</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;countNumber&quot;</span><span class="fu">:</span> <span class="dv">10</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;action&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;expire&quot;</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;rulePriority&quot;</span><span class="fu">:</span> <span class="dv">2</span><span class="fu">,</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Remove untagged images after 7 days&quot;</span><span class="fu">,</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;selection&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;tagStatus&quot;</span><span class="fu">:</span> <span class="st">&quot;untagged&quot;</span><span class="fu">,</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;countType&quot;</span><span class="fu">:</span> <span class="st">&quot;sinceImagePushed&quot;</span><span class="fu">,</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;countUnit&quot;</span><span class="fu">:</span> <span class="st">&quot;days&quot;</span><span class="fu">,</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;countNumber&quot;</span><span class="fu">:</span> <span class="dv">7</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;action&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;expire&quot;</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 id="ecr-access-policy-iam">ECR Access Policy (IAM)</h3>
<div class="sourceCode" id="cb20"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;Version&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-10-17&quot;</span><span class="fu">,</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;Statement&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Sid&quot;</span><span class="fu">:</span> <span class="st">&quot;AllowCodeBuildPush&quot;</span><span class="fu">,</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Effect&quot;</span><span class="fu">:</span> <span class="st">&quot;Allow&quot;</span><span class="fu">,</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Principal&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;Service&quot;</span><span class="fu">:</span> <span class="st">&quot;codebuild.amazonaws.com&quot;</span><span class="fu">,</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;AWS&quot;</span><span class="fu">:</span> <span class="st">&quot;arn:aws:iam::665853670667:role/SecuraaCodeBuildRole&quot;</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">},</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Action&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:BatchCheckLayerAvailability&quot;</span><span class="ot">,</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:CompleteLayerUpload&quot;</span><span class="ot">,</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:InitiateLayerUpload&quot;</span><span class="ot">,</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:PutImage&quot;</span><span class="ot">,</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:UploadLayerPart&quot;</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Sid&quot;</span><span class="fu">:</span> <span class="st">&quot;AllowEC2Pull&quot;</span><span class="fu">,</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Effect&quot;</span><span class="fu">:</span> <span class="st">&quot;Allow&quot;</span><span class="fu">,</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Principal&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;AWS&quot;</span><span class="fu">:</span> <span class="st">&quot;arn:aws:iam::665853670667:role/SecuraaEC2Role&quot;</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">},</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Action&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:GetDownloadUrlForLayer&quot;</span><span class="ot">,</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:BatchGetImage&quot;</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Sid&quot;</span><span class="fu">:</span> <span class="st">&quot;DenyUnencryptedPush&quot;</span><span class="fu">,</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Effect&quot;</span><span class="fu">:</span> <span class="st">&quot;Deny&quot;</span><span class="fu">,</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Principal&quot;</span><span class="fu">:</span> <span class="st">&quot;*&quot;</span><span class="fu">,</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Action&quot;</span><span class="fu">:</span> <span class="st">&quot;ecr:PutImage&quot;</span><span class="fu">,</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Condition&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;StringNotEquals&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;ecr:ImageEncryption&quot;</span><span class="fu">:</span> <span class="st">&quot;KMS&quot;</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<hr />
<h2 id="deployment-process">Deployment Process</h2>
<h3 id="deployment-pipeline">Deployment Pipeline</h3>
<div class="diagram">
<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 784.445px; background-color: white;" viewBox="0 0 784.4453125 2498.734375" role="graphics-document document" aria-roledescription="flowchart-v2" preserveAspectRatio="xMidYMid meet"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path d="M236.832,62L236.832,66.167C236.832,70.333,236.832,78.667,236.832,86.333C236.832,94,236.832,101,236.832,104.5L236.832,108" id="L_A_B_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A_B_0" data-points="W3sieCI6MjM2LjgzMjAzMTI1LCJ5Ijo2Mn0seyJ4IjoyMzYuODMyMDMxMjUsInkiOjg3fSx7IngiOjIzNi44MzIwMzEyNSwieSI6MTEyfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M236.832,166L236.832,170.167C236.832,174.333,236.832,182.667,236.832,190.333C236.832,198,236.832,205,236.832,208.5L236.832,212" id="L_B_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_C_0" data-points="W3sieCI6MjM2LjgzMjAzMTI1LCJ5IjoxNjZ9LHsieCI6MjM2LjgzMjAzMTI1LCJ5IjoxOTF9LHsieCI6MjM2LjgzMjAzMTI1LCJ5IjoyMTZ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M184.052,372.845L168.874,387.809C153.696,402.772,123.34,432.698,108.162,458.328C92.984,483.958,92.984,505.292,92.984,524.625C92.984,543.958,92.984,561.292,92.984,578.625C92.984,595.958,92.984,613.292,92.984,630.625C92.984,647.958,92.984,665.292,92.984,693.816C92.984,722.341,92.984,762.057,92.984,803.773C92.984,845.49,92.984,889.206,92.984,921.73C92.984,954.255,92.984,975.589,92.984,996.922C92.984,1018.255,92.984,1039.589,92.984,1060.922C92.984,1082.255,92.984,1103.589,92.984,1122.922C92.984,1142.255,92.984,1159.589,92.984,1176.922C92.984,1194.255,92.984,1211.589,92.984,1228.922C92.984,1246.255,92.984,1263.589,92.984,1280.922C92.984,1298.255,92.984,1315.589,92.984,1332.922C92.984,1350.255,92.984,1367.589,92.984,1392.111C92.984,1416.633,92.984,1448.344,92.984,1482.055C92.984,1515.766,92.984,1551.477,95.612,1574.896C98.24,1598.315,103.495,1609.443,106.123,1615.007L108.751,1620.571" id="L_C_D_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_D_0" data-points="W3sieCI6MTg0LjA1MjQxODMzOTkzNjk2LCJ5IjozNzIuODQ1Mzg3MDg5OTM2OTN9LHsieCI6OTIuOTg0Mzc1LCJ5Ijo0NjIuNjI1fSx7IngiOjkyLjk4NDM3NSwieSI6NTI2LjYyNX0seyJ4Ijo5Mi45ODQzNzUsInkiOjU3OC42MjV9LHsieCI6OTIuOTg0Mzc1LCJ5Ijo2MzAuNjI1fSx7IngiOjkyLjk4NDM3NSwieSI6NjgyLjYyNX0seyJ4Ijo5Mi45ODQzNzUsInkiOjgwMS43NzM0Mzc1fSx7IngiOjkyLjk4NDM3NSwieSI6OTMyLjkyMTg3NX0seyJ4Ijo5Mi45ODQzNzUsInkiOjk5Ni45MjE4NzV9LHsieCI6OTIuOTg0Mzc1LCJ5IjoxMDYwLjkyMTg3NX0seyJ4Ijo5Mi45ODQzNzUsInkiOjExMjQuOTIxODc1fSx7IngiOjkyLjk4NDM3NSwieSI6MTE3Ni45MjE4NzV9LHsieCI6OTIuOTg0Mzc1LCJ5IjoxMjI4LjkyMTg3NX0seyJ4Ijo5Mi45ODQzNzUsInkiOjEyODAuOTIxODc1fSx7IngiOjkyLjk4NDM3NSwieSI6MTMzMi45MjE4NzV9LHsieCI6OTIuOTg0Mzc1LCJ5IjoxMzg0LjkyMTg3NX0seyJ4Ijo5Mi45ODQzNzUsInkiOjE0ODAuMDU0Njg3NX0seyJ4Ijo5Mi45ODQzNzUsInkiOjE1ODcuMTg3NX0seyJ4IjoxMTAuNDU5MTA2NDQ1MzEyNSwieSI6MTYyNC4xODc1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M271.273,391.184L277.101,403.091C282.928,414.997,294.583,438.811,300.411,456.218C306.238,473.625,306.238,484.625,306.238,490.125L306.238,495.625" id="L_C_E_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_E_0" data-points="W3sieCI6MjcxLjI3MzMwMzk5NzQ0Nzg0LCJ5IjozOTEuMTgzNzI3MjUyNTUyMTZ9LHsieCI6MzA2LjIzODI4MTI1LCJ5Ijo0NjIuNjI1fSx7IngiOjMwNi4yMzgyODEyNSwieSI6NDk5LjYyNX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M306.238,553.625L306.238,557.792C306.238,561.958,306.238,570.292,306.238,577.958C306.238,585.625,306.238,592.625,306.238,596.125L306.238,599.625" id="L_E_F_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E_F_0" data-points="W3sieCI6MzA2LjIzODI4MTI1LCJ5Ijo1NTMuNjI1fSx7IngiOjMwNi4yMzgyODEyNSwieSI6NTc4LjYyNX0seyJ4IjozMDYuMjM4MjgxMjUsInkiOjYwMy42MjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M306.238,657.625L306.238,661.792C306.238,665.958,306.238,674.292,306.238,681.958C306.238,689.625,306.238,696.625,306.238,700.125L306.238,703.625" id="L_F_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_F_G_0" data-points="W3sieCI6MzA2LjIzODI4MTI1LCJ5Ijo2NTcuNjI1fSx7IngiOjMwNi4yMzgyODEyNSwieSI6NjgyLjYyNX0seyJ4IjozMDYuMjM4MjgxMjUsInkiOjcwNy42MjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M259.601,849.285L245.918,863.224C232.236,877.164,204.87,905.043,191.187,929.649C177.504,954.255,177.504,975.589,177.504,996.922C177.504,1018.255,177.504,1039.589,177.504,1060.922C177.504,1082.255,177.504,1103.589,177.504,1122.922C177.504,1142.255,177.504,1159.589,177.504,1176.922C177.504,1194.255,177.504,1211.589,177.504,1228.922C177.504,1246.255,177.504,1263.589,177.504,1280.922C177.504,1298.255,177.504,1315.589,177.504,1332.922C177.504,1350.255,177.504,1367.589,177.504,1392.111C177.504,1416.633,177.504,1448.344,177.504,1482.055C177.504,1515.766,177.504,1551.477,172.704,1574.99C167.904,1598.504,158.304,1609.821,153.503,1615.479L148.703,1621.137" id="L_G_D_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_G_D_0" data-points="W3sieCI6MjU5LjYwMTMzNjkyMDM3NDI1LCJ5Ijo4NDkuMjg0OTMwNjcwMzc0M30seyJ4IjoxNzcuNTAzOTA2MjUsInkiOjkzMi45MjE4NzV9LHsieCI6MTc3LjUwMzkwNjI1LCJ5Ijo5OTYuOTIxODc1fSx7IngiOjE3Ny41MDM5MDYyNSwieSI6MTA2MC45MjE4NzV9LHsieCI6MTc3LjUwMzkwNjI1LCJ5IjoxMTI0LjkyMTg3NX0seyJ4IjoxNzcuNTAzOTA2MjUsInkiOjExNzYuOTIxODc1fSx7IngiOjE3Ny41MDM5MDYyNSwieSI6MTIyOC45MjE4NzV9LHsieCI6MTc3LjUwMzkwNjI1LCJ5IjoxMjgwLjkyMTg3NX0seyJ4IjoxNzcuNTAzOTA2MjUsInkiOjEzMzIuOTIxODc1fSx7IngiOjE3Ny41MDM5MDYyNSwieSI6MTM4NC45MjE4NzV9LHsieCI6MTc3LjUwMzkwNjI1LCJ5IjoxNDgwLjA1NDY4NzV9LHsieCI6MTc3LjUwMzkwNjI1LCJ5IjoxNTg3LjE4NzV9LHsieCI6MTQ2LjExNTc4MzY5MTQwNjI1LCJ5IjoxNjI0LjE4NzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M342.4,859.761L350.004,871.954C357.607,884.148,372.815,908.535,380.419,926.228C388.023,943.922,388.023,954.922,388.023,960.422L388.023,965.922" id="L_G_H_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_G_H_0" data-points="W3sieCI6MzQyLjM5OTUzMDA5NzcwOTY2LCJ5Ijo4NTkuNzYwNjI2MTUyMjkwM30seyJ4IjozODguMDIzNDM3NSwieSI6OTMyLjkyMTg3NX0seyJ4IjozODguMDIzNDM3NSwieSI6OTY5LjkyMTg3NX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M388.023,1023.922L388.023,1030.089C388.023,1036.255,388.023,1048.589,388.023,1060.255C388.023,1071.922,388.023,1082.922,388.023,1088.422L388.023,1093.922" id="L_H_I_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_H_I_0" data-points="W3sieCI6Mzg4LjAyMzQzNzUsInkiOjEwMjMuOTIxODc1fSx7IngiOjM4OC4wMjM0Mzc1LCJ5IjoxMDYwLjkyMTg3NX0seyJ4IjozODguMDIzNDM3NSwieSI6MTA5Ny45MjE4NzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M388.023,1151.922L388.023,1156.089C388.023,1160.255,388.023,1168.589,388.023,1176.255C388.023,1183.922,388.023,1190.922,388.023,1194.422L388.023,1197.922" id="L_I_J_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_I_J_0" data-points="W3sieCI6Mzg4LjAyMzQzNzUsInkiOjExNTEuOTIxODc1fSx7IngiOjM4OC4wMjM0Mzc1LCJ5IjoxMTc2LjkyMTg3NX0seyJ4IjozODguMDIzNDM3NSwieSI6MTIwMS45MjE4NzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M388.023,1255.922L388.023,1260.089C388.023,1264.255,388.023,1272.589,388.023,1280.255C388.023,1287.922,388.023,1294.922,388.023,1298.422L388.023,1301.922" id="L_J_K_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_J_K_0" data-points="W3sieCI6Mzg4LjAyMzQzNzUsInkiOjEyNTUuOTIxODc1fSx7IngiOjM4OC4wMjM0Mzc1LCJ5IjoxMjgwLjkyMTg3NX0seyJ4IjozODguMDIzNDM3NSwieSI6MTMwNS45MjE4NzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M388.023,1359.922L388.023,1364.089C388.023,1368.255,388.023,1376.589,388.023,1384.255C388.023,1391.922,388.023,1398.922,388.023,1402.422L388.023,1405.922" id="L_K_L_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_K_L_0" data-points="W3sieCI6Mzg4LjAyMzQzNzUsInkiOjEzNTkuOTIxODc1fSx7IngiOjM4OC4wMjM0Mzc1LCJ5IjoxMzg0LjkyMTg3NX0seyJ4IjozODguMDIzNDM3NSwieSI6MTQwOS45MjE4NzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M351.926,1514.09L339.006,1526.273C326.085,1538.456,300.244,1562.822,273.369,1580.911C246.494,1599.001,218.586,1610.815,204.632,1616.721L190.678,1622.628" id="L_L_D_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_L_D_0" data-points="W3sieCI6MzUxLjkyNjM3ODExMjExNTgsInkiOjE1MTQuMDkwNDQwNjEyMTE1OH0seyJ4IjoyNzQuNDAyMzQzNzUsInkiOjE1ODcuMTg3NX0seyJ4IjoxODYuOTk0ODEyMDExNzE4NzUsInkiOjE2MjQuMTg3NX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M399.809,1538.402L401.452,1546.533C403.094,1554.664,406.379,1570.926,408.022,1584.557C409.664,1598.188,409.664,1609.188,409.664,1614.688L409.664,1620.188" id="L_L_M_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_L_M_0" data-points="W3sieCI6Mzk5LjgwOTM5MjE1NzgyOTMsInkiOjE1MzguNDAxNTQ1MzQyMTcwN30seyJ4Ijo0MDkuNjY0MDYyNSwieSI6MTU4Ny4xODc1fSx7IngiOjQwOS42NjQwNjI1LCJ5IjoxNjI0LjE4NzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M409.664,1678.188L409.664,1682.354C409.664,1686.521,409.664,1694.854,409.664,1702.521C409.664,1710.188,409.664,1717.188,409.664,1720.688L409.664,1724.188" id="L_M_N_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_M_N_0" data-points="W3sieCI6NDA5LjY2NDA2MjUsInkiOjE2NzguMTg3NX0seyJ4Ijo0MDkuNjY0MDYyNSwieSI6MTcwMy4xODc1fSx7IngiOjQwOS42NjQwNjI1LCJ5IjoxNzI4LjE4NzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M373.11,1823.024L357.732,1835.283C342.354,1847.542,311.599,1872.06,296.221,1889.819C280.844,1907.578,280.844,1918.578,280.844,1924.078L280.844,1929.578" id="L_N_O_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_N_O_0" data-points="W3sieCI6MzczLjEwOTc2NjQ5NDk4ODksInkiOjE4MjMuMDIzODI4OTk0OTg5fSx7IngiOjI4MC44NDM3NSwieSI6MTg5Ni41NzgxMjV9LHsieCI6MjgwLjg0Mzc1LCJ5IjoxOTMzLjU3ODEyNX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M446.218,1823.024L461.596,1835.283C476.974,1847.542,507.729,1872.06,523.107,1889.819C538.484,1907.578,538.484,1918.578,538.484,1924.078L538.484,1929.578" id="L_N_P_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_N_P_0" data-points="W3sieCI6NDQ2LjIxODM1ODUwNTAxMTEsInkiOjE4MjMuMDIzODI4OTk0OTg5fSx7IngiOjUzOC40ODQzNzUsInkiOjE4OTYuNTc4MTI1fSx7IngiOjUzOC40ODQzNzUsInkiOjE5MzMuNTc4MTI1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M538.484,1987.578L538.484,1991.745C538.484,1995.911,538.484,2004.245,538.484,2011.911C538.484,2019.578,538.484,2026.578,538.484,2030.078L538.484,2033.578" id="L_P_Q_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_P_Q_0" data-points="W3sieCI6NTM4LjQ4NDM3NSwieSI6MTk4Ny41NzgxMjV9LHsieCI6NTM4LjQ4NDM3NSwieSI6MjAxMi41NzgxMjV9LHsieCI6NTM4LjQ4NDM3NSwieSI6MjAzNy41NzgxMjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M538.484,2091.578L538.484,2095.745C538.484,2099.911,538.484,2108.245,538.484,2115.911C538.484,2123.578,538.484,2130.578,538.484,2134.078L538.484,2137.578" id="L_Q_R_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Q_R_0" data-points="W3sieCI6NTM4LjQ4NDM3NSwieSI6MjA5MS41NzgxMjV9LHsieCI6NTM4LjQ4NDM3NSwieSI6MjExNi41NzgxMjV9LHsieCI6NTM4LjQ4NDM3NSwieSI6MjE0MS41NzgxMjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M504.857,2225.107L488.993,2236.879C473.129,2248.65,441.4,2272.192,425.536,2289.463C409.672,2306.734,409.672,2317.734,409.672,2323.234L409.672,2328.734" id="L_R_S_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_R_S_0" data-points="W3sieCI6NTA0Ljg1NzMyNTE3NzU2NDIzLCJ5IjoyMjI1LjEwNzMyNTE3NzU2NDJ9LHsieCI6NDA5LjY3MTg3NSwieSI6MjI5NS43MzQzNzV9LHsieCI6NDA5LjY3MTg3NSwieSI6MjMzMi43MzQzNzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M572.111,2225.107L587.976,2236.879C603.84,2248.65,635.568,2272.192,651.433,2289.463C667.297,2306.734,667.297,2317.734,667.297,2323.234L667.297,2328.734" id="L_R_T_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_R_T_0" data-points="W3sieCI6NTcyLjExMTQyNDgyMjQzNTgsInkiOjIyMjUuMTA3MzI1MTc3NTY0Mn0seyJ4Ijo2NjcuMjk2ODc1LCJ5IjoyMjk1LjczNDM3NX0seyJ4Ijo2NjcuMjk2ODc1LCJ5IjoyMzMyLjczNDM3NX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M409.672,2386.734L409.672,2390.901C409.672,2395.068,409.672,2403.401,409.672,2411.068C409.672,2418.734,409.672,2425.734,409.672,2429.234L409.672,2432.734" id="L_S_U_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_S_U_0" data-points="W3sieCI6NDA5LjY3MTg3NSwieSI6MjM4Ni43MzQzNzV9LHsieCI6NDA5LjY3MTg3NSwieSI6MjQxMS43MzQzNzV9LHsieCI6NDA5LjY3MTg3NSwieSI6MjQzNi43MzQzNzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" data-id="L_A_B_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_B_C_0" transform="translate(0, 0)"></g></g><g class="edgeLabel" transform="translate(92.984375, 1060.921875)"><g class="label" transform="translate(-10.2265625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">No</text></g></g><g class="edgeLabel" transform="translate(306.23828125, 462.625)"><g class="label" transform="translate(-13.0546875, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Yes</text></g></g><g class="edgeLabel"><g class="label" data-id="L_E_F_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_F_G_0" transform="translate(0, 0)"></g></g><g class="edgeLabel" transform="translate(177.50390625, 1228.921875)"><g class="label" transform="translate(-10.2265625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">No</text></g></g><g class="edgeLabel" transform="translate(388.0234375, 932.921875)"><g class="label" transform="translate(-13.0546875, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Yes</text></g></g><g class="edgeLabel"><g class="label" data-id="L_H_I_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_I_J_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_J_K_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_K_L_0" transform="translate(0, 0)"></g></g><g class="edgeLabel" transform="translate(278.63503, 1583.19652)"><g class="label" transform="translate(-10.2265625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">No</text></g></g><g class="edgeLabel" transform="translate(409.6640625, 1587.1875)"><g class="label" transform="translate(-13.0546875, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Yes</text></g></g><g class="edgeLabel"><g class="label" data-id="L_M_N_0" transform="translate(0, 0)"></g></g><g class="edgeLabel" transform="translate(280.84375, 1896.578125)"><g class="label" transform="translate(-10.2265625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">No</text></g></g><g class="edgeLabel" transform="translate(538.484375, 1896.578125)"><g class="label" transform="translate(-13.0546875, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Yes</text></g></g><g class="edgeLabel"><g class="label" data-id="L_P_Q_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_Q_R_0" transform="translate(0, 0)"></g></g><g class="edgeLabel" transform="translate(409.671875, 2295.734375)"><g class="label" transform="translate(-10.2265625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">No</text></g></g><g class="edgeLabel" transform="translate(667.296875, 2295.734375)"><g class="label" transform="translate(-13.0546875, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Yes</text></g></g><g class="edgeLabel"><g class="label" data-id="L_S_U_0" transform="translate(0, 0)"></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-0" transform="translate(236.83203125, 35)"><rect class="basic label-container" style="" x="-106.9296875" y="-27" width="213.859375" height="54"/><g class="label" style="" transform="translate(-76.9296875, -12)"><text x="76.9296875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Code Merged to main</text></g></g><g class="node default" id="flowchart-B-1" transform="translate(236.83203125, 139)"><rect class="basic label-container" style="" x="-102.9375" y="-27" width="205.875" height="54"/><g class="label" style="" transform="translate(-72.9375, -12)"><text x="72.9375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">CodeBuild Triggered</text></g></g><g class="node default" id="flowchart-C-3" transform="translate(236.83203125, 320.8125)"><polygon points="104.8125,0 209.625,-104.8125 104.8125,-209.625 0,-104.8125" class="label-container" transform="translate(-104.3125, 104.8125)" style="fill:#fff3e0 !important"/><g class="label" style="" transform="translate(-77.8125, -12)"><text x="77.8125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Security Scans Pass?</text></g></g><g class="node default" id="flowchart-D-5" transform="translate(123.2109375, 1651.1875)"><rect class="basic label-container" style="" x="-115.2109375" y="-27" width="230.421875" height="54"/><g class="label" style="" transform="translate(-85.2109375, -12)"><text x="85.2109375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Notify Team - Fix Issues</text></g></g><g class="node default" id="flowchart-E-7" transform="translate(306.23828125, 526.625)"><rect class="basic label-container" style="" x="-103.8125" y="-27" width="207.625" height="54"/><g class="label" style="" transform="translate(-73.8125, -12)"><text x="73.8125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Build Docker Images</text></g></g><g class="node default" id="flowchart-F-9" transform="translate(306.23828125, 630.625)"><rect class="basic label-container" style="" x="-76.6953125" y="-27" width="153.390625" height="54"/><g class="label" style="" transform="translate(-46.6953125, -12)"><text x="46.6953125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Scan Images</text></g></g><g class="node default" id="flowchart-G-11" transform="translate(306.23828125, 801.7734375)"><polygon points="94.1484375,0 188.296875,-94.1484375 94.1484375,-188.296875 0,-94.1484375" class="label-container" transform="translate(-93.6484375, 94.1484375)" style="fill:#fff3e0 !important"/><g class="label" style="" transform="translate(-67.1484375, -12)"><text x="67.1484375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Image Scan Pass?</text></g></g><g class="node default" id="flowchart-H-15" transform="translate(388.0234375, 996.921875)"><rect class="basic label-container" style="" x="-76.2421875" y="-27" width="152.484375" height="54"/><g class="label" style="" transform="translate(-46.2421875, -12)"><text x="46.2421875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Push to ECR</text></g></g><g class="node default" id="flowchart-I-17" transform="translate(388.0234375, 1124.921875)"><rect class="basic label-container" style="" x="-128.5703125" y="-27" width="257.140625" height="54"/><g class="label" style="" transform="translate(-98.5703125, -12)"><text x="98.5703125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Update ECS Task Definition</text></g></g><g class="node default" id="flowchart-J-19" transform="translate(388.0234375, 1228.921875)"><rect class="basic label-container" style="" x="-93.15625" y="-27" width="186.3125" height="54"/><g class="label" style="" transform="translate(-63.15625, -12)"><text x="63.15625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Deploy to Staging</text></g></g><g class="node default" id="flowchart-K-21" transform="translate(388.0234375, 1332.921875)"><rect class="basic label-container" style="" x="-105.453125" y="-27" width="210.90625" height="54"/><g class="label" style="" transform="translate(-75.453125, -12)"><text x="75.453125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Run Integration Tests</text></g></g><g class="node default" id="flowchart-L-23" transform="translate(388.0234375, 1480.0546875)"><polygon points="70.1328125,0 140.265625,-70.1328125 70.1328125,-140.265625 0,-70.1328125" class="label-container" transform="translate(-69.6328125, 70.1328125)" style="fill:#fff3e0 !important"/><g class="label" style="" transform="translate(-43.1328125, -12)"><text x="43.1328125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Tests Pass?</text></g></g><g class="node default" id="flowchart-M-27" transform="translate(409.6640625, 1651.1875)"><rect class="basic label-container" style="" x="-92.2578125" y="-27" width="184.515625" height="54"/><g class="label" style="" transform="translate(-62.2578125, -12)"><text x="62.2578125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Security Approval</text></g></g><g class="node default" id="flowchart-N-29" transform="translate(409.6640625, 1793.8828125)"><polygon points="65.6953125,0 131.390625,-65.6953125 65.6953125,-131.390625 0,-65.6953125" class="label-container" transform="translate(-65.1953125, 65.6953125)" style="fill:#ffebee !important"/><g class="label" style="" transform="translate(-38.6953125, -12)"><text x="38.6953125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Approved?</text></g></g><g class="node default" id="flowchart-O-31" transform="translate(280.84375, 1960.578125)"><rect class="basic label-container" style="" x="-103.375" y="-27" width="206.75" height="54"/><g class="label" style="" transform="translate(-73.375, -12)"><text x="73.375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Deployment Blocked</text></g></g><g class="node default" id="flowchart-P-33" transform="translate(538.484375, 1960.578125)"><rect class="basic label-container" style="" x="-104.265625" y="-27" width="208.53125" height="54"/><g class="label" style="" transform="translate(-74.265625, -12)"><text x="74.265625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Deploy to Production</text></g></g><g class="node default" id="flowchart-Q-35" transform="translate(538.484375, 2064.578125)"><rect class="basic label-container" style="" x="-82.0234375" y="-27" width="164.046875" height="54"/><g class="label" style="" transform="translate(-52.0234375, -12)"><text x="52.0234375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Health Checks</text></g></g><g class="node default" id="flowchart-R-37" transform="translate(538.484375, 2200.15625)"><polygon points="58.578125,0 117.15625,-58.578125 58.578125,-117.15625 0,-58.578125" class="label-container" transform="translate(-58.078125, 58.578125)" style="fill:#e8f5e9 !important"/><g class="label" style="" transform="translate(-31.578125, -12)"><text x="31.578125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Healthy?</text></g></g><g class="node default" id="flowchart-S-39" transform="translate(409.671875, 2359.734375)"><rect class="basic label-container" style="" x="-98.4765625" y="-27" width="196.953125" height="54"/><g class="label" style="" transform="translate(-68.4765625, -12)"><text x="68.4765625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Automatic Rollback</text></g></g><g class="node default" id="flowchart-T-41" transform="translate(667.296875, 2359.734375)"><rect class="basic label-container" style="" x="-109.1484375" y="-27" width="218.296875" height="54"/><g class="label" style="" transform="translate(-79.1484375, -12)"><text x="79.1484375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Deployment Complete</text></g></g><g class="node default" id="flowchart-U-43" transform="translate(409.671875, 2463.734375)"><rect class="basic label-container" style="" x="-94.0390625" y="-27" width="188.078125" height="54"/><g class="label" style="" transform="translate(-64.0390625, -12)"><text x="64.0390625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Investigate Issues</text></g></g></g></g></g></svg>
</div>
<h3 id="deployment-script">Deployment Script</h3>
<div class="sourceCode" id="cb21"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># deploy.sh</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="at">-euo</span> pipefail</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="va">ENVIRONMENT</span><span class="op">=</span><span class="va">$1</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="va">VERSION</span><span class="op">=</span><span class="va">$2</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;=== Deploying SECURAA to </span><span class="va">$ENVIRONMENT</span><span class="st"> ===&quot;</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Version: </span><span class="va">$VERSION</span><span class="st">&quot;</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Pre-deployment checks</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Running pre-deployment checks...&quot;</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="ex">./scripts/pre-deploy-checks.sh</span> <span class="va">$ENVIRONMENT</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Update task definitions</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Updating ECS task definitions...&quot;</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> ecs register-task-definition <span class="dt">\</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">--cli-input-json</span> file://task-definitions/<span class="va">$ENVIRONMENT</span>/zona-services.json</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Update services</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Updating ECS services...&quot;</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> ecs update-service <span class="dt">\</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">--cluster</span> securaa-<span class="va">$ENVIRONMENT</span> <span class="dt">\</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">--service</span> zona-services <span class="dt">\</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">--task-definition</span> zona-services:<span class="va">$VERSION</span> <span class="dt">\</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">--force-new-deployment</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Wait for deployment</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Waiting for deployment to complete...&quot;</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> ecs wait services-stable <span class="dt">\</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">--cluster</span> securaa-<span class="va">$ENVIRONMENT</span> <span class="dt">\</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">--services</span> zona-services</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Post-deployment validation</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Running post-deployment validation...&quot;</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="ex">./scripts/post-deploy-validation.sh</span> <span class="va">$ENVIRONMENT</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Health checks</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Performing health checks...&quot;</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">10</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="ex">curl</span> <span class="at">-sf</span> https://<span class="va">$ENVIRONMENT</span>.securaa.io/health <span class="op">&gt;</span> /dev/null<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot; Health check passed!&quot;</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">fi</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;Waiting for service to be healthy... (</span><span class="va">$i</span><span class="st">/10)&quot;</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sleep</span> 30</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;=== Deployment completed successfully! ===&quot;</span></span></code></pre></div>
<hr />
<h1 id="phase-7-operations-monitoring">PHASE 7: OPERATIONS &amp;
MONITORING</h1>
<h2 id="security-monitoring">Security Monitoring</h2>
<h3 id="cloudwatch-dashboards">CloudWatch Dashboards</h3>
<div class="sourceCode" id="cb22"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;widgets&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;metric&quot;</span><span class="fu">,</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;properties&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;metrics&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>          <span class="ot">[</span><span class="st">&quot;SECURAA&quot;</span><span class="ot">,</span> <span class="st">&quot;AuthenticationFailures&quot;</span><span class="ot">,</span> <span class="fu">{</span><span class="dt">&quot;stat&quot;</span><span class="fu">:</span> <span class="st">&quot;Sum&quot;</span><span class="fu">}</span><span class="ot">],</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>          <span class="ot">[</span><span class="st">&quot;.&quot;</span><span class="ot">,</span> <span class="st">&quot;AuthenticationSuccess&quot;</span><span class="ot">,</span> <span class="fu">{</span><span class="dt">&quot;stat&quot;</span><span class="fu">:</span> <span class="st">&quot;Sum&quot;</span><span class="fu">}</span><span class="ot">]</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;period&quot;</span><span class="fu">:</span> <span class="dv">300</span><span class="fu">,</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;stat&quot;</span><span class="fu">:</span> <span class="st">&quot;Sum&quot;</span><span class="fu">,</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;region&quot;</span><span class="fu">:</span> <span class="st">&quot;us-east-2&quot;</span><span class="fu">,</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Authentication Events&quot;</span><span class="fu">,</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;yAxis&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;left&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;min&quot;</span><span class="fu">:</span> <span class="dv">0</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">}</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;metric&quot;</span><span class="fu">,</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;properties&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;metrics&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>          <span class="ot">[</span><span class="st">&quot;SECURAA&quot;</span><span class="ot">,</span> <span class="st">&quot;API4xxErrors&quot;</span><span class="ot">,</span> <span class="fu">{</span><span class="dt">&quot;stat&quot;</span><span class="fu">:</span> <span class="st">&quot;Sum&quot;</span><span class="fu">}</span><span class="ot">],</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>          <span class="ot">[</span><span class="st">&quot;.&quot;</span><span class="ot">,</span> <span class="st">&quot;API5xxErrors&quot;</span><span class="ot">,</span> <span class="fu">{</span><span class="dt">&quot;stat&quot;</span><span class="fu">:</span> <span class="st">&quot;Sum&quot;</span><span class="fu">}</span><span class="ot">]</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>        <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;period&quot;</span><span class="fu">:</span> <span class="dv">300</span><span class="fu">,</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;stat&quot;</span><span class="fu">:</span> <span class="st">&quot;Sum&quot;</span><span class="fu">,</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;region&quot;</span><span class="fu">:</span> <span class="st">&quot;us-east-2&quot;</span><span class="fu">,</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;API Errors&quot;</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;log&quot;</span><span class="fu">,</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;properties&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;query&quot;</span><span class="fu">:</span> <span class="st">&quot;SOURCE &#39;/aws/securaa/api&#39;</span><span class="ch">\n</span><span class="st">| fields @timestamp, @message</span><span class="ch">\n</span><span class="st">| filter @message like /security_event/</span><span class="ch">\n</span><span class="st">| sort @timestamp desc&quot;</span><span class="fu">,</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;region&quot;</span><span class="fu">:</span> <span class="st">&quot;us-east-2&quot;</span><span class="fu">,</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Security Events&quot;</span><span class="fu">,</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;stacked&quot;</span><span class="fu">:</span> <span class="kw">false</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 id="security-event-logging">Security Event Logging</h3>
<div class="sourceCode" id="cb23"><pre
class="sourceCode go"><code class="sourceCode go"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Security event logging structure</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="kw">package</span> monitoring</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="op">(</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;go.uber.org/zap&quot;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;time&quot;</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="kw">type</span> SecurityEvent <span class="kw">struct</span> <span class="op">{</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    Timestamp   time<span class="op">.</span>Time <span class="st">`json:&quot;timestamp&quot;`</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    EventType   <span class="dt">string</span>    <span class="st">`json:&quot;event_type&quot;`</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    Severity    <span class="dt">string</span>    <span class="st">`json:&quot;severity&quot;`</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    UserID      <span class="dt">string</span>    <span class="st">`json:&quot;user_id,omitempty&quot;`</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    IPAddress   <span class="dt">string</span>    <span class="st">`json:&quot;ip_address&quot;`</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    Resource    <span class="dt">string</span>    <span class="st">`json:&quot;resource,omitempty&quot;`</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    Action      <span class="dt">string</span>    <span class="st">`json:&quot;action&quot;`</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    Result      <span class="dt">string</span>    <span class="st">`json:&quot;result&quot;`</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    Details     <span class="dt">string</span>    <span class="st">`json:&quot;details,omitempty&quot;`</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="kw">func</span> LogSecurityEvent<span class="op">(</span>logger <span class="op">*</span>zap<span class="op">.</span>Logger<span class="op">,</span> event SecurityEvent<span class="op">)</span> <span class="op">{</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    event<span class="op">.</span>Timestamp <span class="op">=</span> time<span class="op">.</span>Now<span class="op">().</span>UTC<span class="op">()</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    logger<span class="op">.</span>Info<span class="op">(</span><span class="st">&quot;security_event&quot;</span><span class="op">,</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>Time<span class="op">(</span><span class="st">&quot;timestamp&quot;</span><span class="op">,</span> event<span class="op">.</span>Timestamp<span class="op">),</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;event_type&quot;</span><span class="op">,</span> event<span class="op">.</span>EventType<span class="op">),</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;severity&quot;</span><span class="op">,</span> event<span class="op">.</span>Severity<span class="op">),</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;user_id&quot;</span><span class="op">,</span> event<span class="op">.</span>UserID<span class="op">),</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;ip_address&quot;</span><span class="op">,</span> event<span class="op">.</span>IPAddress<span class="op">),</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;resource&quot;</span><span class="op">,</span> event<span class="op">.</span>Resource<span class="op">),</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;action&quot;</span><span class="op">,</span> event<span class="op">.</span>Action<span class="op">),</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;result&quot;</span><span class="op">,</span> event<span class="op">.</span>Result<span class="op">),</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;details&quot;</span><span class="op">,</span> event<span class="op">.</span>Details<span class="op">),</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Send critical events to SIEM</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> event<span class="op">.</span>Severity <span class="op">==</span> <span class="st">&quot;CRITICAL&quot;</span> <span class="op">||</span> event<span class="op">.</span>Severity <span class="op">==</span> <span class="st">&quot;HIGH&quot;</span> <span class="op">{</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>        sendToSIEM<span class="op">(</span>event<span class="op">)</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a><span class="co">// Example usage</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a><span class="kw">func</span> HandleLogin<span class="op">(</span>w http<span class="op">.</span>ResponseWriter<span class="op">,</span> r <span class="op">*</span>http<span class="op">.</span>Request<span class="op">)</span> <span class="op">{</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>    username <span class="op">:=</span> r<span class="op">.</span>FormValue<span class="op">(</span><span class="st">&quot;username&quot;</span><span class="op">)</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>    password <span class="op">:=</span> r<span class="op">.</span>FormValue<span class="op">(</span><span class="st">&quot;password&quot;</span><span class="op">)</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>    user<span class="op">,</span> err <span class="op">:=</span> authenticateUser<span class="op">(</span>username<span class="op">,</span> password<span class="op">)</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> err <span class="op">!=</span> <span class="ot">nil</span> <span class="op">{</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>        LogSecurityEvent<span class="op">(</span>logger<span class="op">,</span> SecurityEvent<span class="op">{</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>            EventType<span class="op">:</span>  <span class="st">&quot;authentication&quot;</span><span class="op">,</span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>            Severity<span class="op">:</span>   <span class="st">&quot;MEDIUM&quot;</span><span class="op">,</span></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>            UserID<span class="op">:</span>     username<span class="op">,</span></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>            IPAddress<span class="op">:</span>  getClientIP<span class="op">(</span>r<span class="op">),</span></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>            Action<span class="op">:</span>     <span class="st">&quot;login&quot;</span><span class="op">,</span></span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>            Result<span class="op">:</span>     <span class="st">&quot;failure&quot;</span><span class="op">,</span></span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>            Details<span class="op">:</span>    <span class="st">&quot;Invalid credentials&quot;</span><span class="op">,</span></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>        <span class="op">})</span></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>        http<span class="op">.</span>Error<span class="op">(</span>w<span class="op">,</span> <span class="st">&quot;Authentication failed&quot;</span><span class="op">,</span> http<span class="op">.</span>StatusUnauthorized<span class="op">)</span></span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>    LogSecurityEvent<span class="op">(</span>logger<span class="op">,</span> SecurityEvent<span class="op">{</span></span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>        EventType<span class="op">:</span>  <span class="st">&quot;authentication&quot;</span><span class="op">,</span></span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>        Severity<span class="op">:</span>   <span class="st">&quot;INFO&quot;</span><span class="op">,</span></span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>        UserID<span class="op">:</span>     user<span class="op">.</span>ID<span class="op">,</span></span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>        IPAddress<span class="op">:</span>  getClientIP<span class="op">(</span>r<span class="op">),</span></span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>        Action<span class="op">:</span>     <span class="st">&quot;login&quot;</span><span class="op">,</span></span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>        Result<span class="op">:</span>     <span class="st">&quot;success&quot;</span><span class="op">,</span></span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>    <span class="op">})</span></span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Continue with successful login...</span></span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="alerting-rules">Alerting Rules</h3>
<div class="sourceCode" id="cb24"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CloudWatch Alarms</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">alarms</span><span class="kw">:</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">high_authentication_failures</span><span class="kw">:</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metric</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;AuthenticationFailures&quot;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">threshold</span><span class="kw">:</span><span class="at"> </span><span class="dv">50</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">period</span><span class="kw">:</span><span class="at"> </span><span class="dv">300</span><span class="co">  # 5 minutes</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">evaluation_periods</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">comparison_operator</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;GreaterThanThreshold&quot;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">actions</span><span class="kw">:</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;arn:aws:sns:us-east-2:665853670667:security-alerts&quot;</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Alert when authentication failures exceed threshold&quot;</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">critical_api_errors</span><span class="kw">:</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metric</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;API5xxErrors&quot;</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">threshold</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">period</span><span class="kw">:</span><span class="at"> </span><span class="dv">300</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">evaluation_periods</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">comparison_operator</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;GreaterThanThreshold&quot;</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">actions</span><span class="kw">:</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;arn:aws:sns:us-east-2:665853670667:ops-alerts&quot;</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Alert when API 5xx errors exceed threshold&quot;</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">unauthorized_access_attempts</span><span class="kw">:</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">query</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;fields @timestamp | filter @message like /401|403/ | stats count() as attempts&quot;</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">threshold</span><span class="kw">:</span><span class="at"> </span><span class="dv">30</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">period</span><span class="kw">:</span><span class="at"> </span><span class="dv">300</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">actions</span><span class="kw">:</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;arn:aws:sns:us-east-2:665853670667:security-alerts&quot;</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Alert on excessive unauthorized access attempts&quot;</span></span></code></pre></div>
<hr />
<h2 id="incident-response">Incident Response</h2>
<h3 id="incident-response-plan">Incident Response Plan</h3>
<div class="sourceCode" id="cb25"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">incident_response</span><span class="kw">:</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">severity_levels</span><span class="kw">:</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">critical</span><span class="kw">:</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Production system compromised or data breach&quot;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">response_time</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Immediate (&lt; 15 minutes)&quot;</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">escalation</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;CISO, CTO, CEO&quot;</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">actions</span><span class="kw">:</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Activate incident response team</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Isolate affected systems</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Preserve evidence</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Notify stakeholders</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Engage external security firm if needed</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">high</span><span class="kw">:</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Security vulnerability actively exploited&quot;</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">response_time</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;&lt; 1 hour&quot;</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">escalation</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Security team lead, Engineering director&quot;</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">actions</span><span class="kw">:</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Assess impact and scope</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Implement containment measures</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Deploy patches/fixes</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Monitor for continued activity</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">medium</span><span class="kw">:</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Security vulnerability discovered&quot;</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">response_time</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;&lt; 4 hours&quot;</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">escalation</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Security team&quot;</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">actions</span><span class="kw">:</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Analyze vulnerability</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Develop remediation plan</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Schedule deployment</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Update documentation</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">low</span><span class="kw">:</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Potential security issue identified&quot;</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">response_time</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;&lt; 1 business day&quot;</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">escalation</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Development team&quot;</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">actions</span><span class="kw">:</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Investigate issue</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Assess risk</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Create ticket for resolution</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">communication</span><span class="kw">:</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">internal</span><span class="kw">:</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Security team via Slack</span><span class="co"> #security-incidents</span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Engineering team via Slack</span><span class="co"> #engineering-alerts</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Management via email and phone</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">external</span><span class="kw">:</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Customers (if affected) within 72 hours</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Regulators (if required) per compliance requirements</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Law enforcement (if criminal activity)</span></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">documentation</span><span class="kw">:</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Incident timeline</span></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Actions taken</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Systems affected</span></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Data compromised (if any)</span></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Root cause analysis</span></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Remediation steps</span></span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Lessons learned</span></span></code></pre></div>
<hr />
<h1 id="phase-8-cicd-security-pipeline">PHASE 8: CI/CD SECURITY
PIPELINE</h1>
<h2 id="integrated-security-pipeline">Integrated Security Pipeline</h2>
<div class="sourceCode" id="cb26"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete security integration in CodeBuild</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.2</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">phases</span><span class="kw">:</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">install</span><span class="kw">:</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">      # Install all security tools</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./scripts/install-security-tools.sh</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pre_build</span><span class="kw">:</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co">      # 1. Secrets scanning</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> gitleaks detect --source . --verbose</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co">      # 2. SAST scanning</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> gosec -fmt=json -out=gosec.json ./...</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> eslint --format json --output-file eslint.json src/</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co">      # 3. Dependency scanning</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go list -json -m all | nancy sleuth</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> npm audit --json &gt; npm-audit.json</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="co">      # 4. License compliance</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go-licenses check ./...</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="co">      # 5. Analyze results</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> python3 scripts/security-gate.py</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">build</span><span class="kw">:</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="co">      # Build if security checks pass</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> make build</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> make test</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">post_build</span><span class="kw">:</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a><span class="co">      # Container scanning</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> docker build -t app:latest .</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> trivy image --severity HIGH,CRITICAL app:latest</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a><span class="co">      # DAST scanning (for staging deployments)</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="ch">|</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>        if [ &quot;$ENVIRONMENT&quot; = &quot;staging&quot; ]; then</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>          ./scripts/run-dast-scan.sh</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>        fi</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a><span class="co">      # Generate security report</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./scripts/generate-security-report.sh</span></span></code></pre></div>
<h3 id="security-gate-script">Security Gate Script</h3>
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scripts/security-gate.py</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SecurityGate:</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.passed <span class="op">=</span> <span class="va">True</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.critical_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.high_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.findings <span class="op">=</span> []</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_gosec(<span class="va">self</span>):</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Check GoSec results&quot;&quot;&quot;</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;gosec.json&#39;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> issue <span class="kw">in</span> data.get(<span class="st">&#39;Issues&#39;</span>, []):</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>                severity <span class="op">=</span> issue.get(<span class="st">&#39;severity&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>                confidence <span class="op">=</span> issue.get(<span class="st">&#39;confidence&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> severity <span class="op">==</span> <span class="st">&#39;HIGH&#39;</span> <span class="kw">and</span> confidence <span class="op">==</span> <span class="st">&#39;HIGH&#39;</span>:</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.critical_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.findings.append({</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;tool&#39;</span>: <span class="st">&#39;GoSec&#39;</span>,</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;severity&#39;</span>: <span class="st">&#39;CRITICAL&#39;</span>,</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;issue&#39;</span>: issue.get(<span class="st">&#39;details&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;file&#39;</span>: issue.get(<span class="st">&#39;file&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;line&#39;</span>: issue.get(<span class="st">&#39;line&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> severity <span class="op">==</span> <span class="st">&#39;MEDIUM&#39;</span> <span class="kw">and</span> confidence <span class="op">==</span> <span class="st">&#39;HIGH&#39;</span>:</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.high_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Error checking GoSec: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_nancy(<span class="va">self</span>):</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Check Nancy dependency scan&quot;&quot;&quot;</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;nancy.json&#39;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> vuln <span class="kw">in</span> data.get(<span class="st">&#39;vulnerable&#39;</span>, []):</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>                cvss <span class="op">=</span> vuln.get(<span class="st">&#39;cvss_score&#39;</span>, <span class="dv">0</span>)</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> cvss <span class="op">&gt;=</span> <span class="fl">9.0</span>:</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.critical_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.findings.append({</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;tool&#39;</span>: <span class="st">&#39;Nancy&#39;</span>,</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;severity&#39;</span>: <span class="st">&#39;CRITICAL&#39;</span>,</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;issue&#39;</span>: <span class="ss">f&quot;</span><span class="sc">{</span>vuln<span class="sc">.</span>get(<span class="st">&#39;cve&#39;</span>, <span class="st">&#39;&#39;</span>)<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>vuln<span class="sc">.</span>get(<span class="st">&#39;title&#39;</span>, <span class="st">&#39;&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;package&#39;</span>: vuln.get(<span class="st">&#39;coordinates&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> cvss <span class="op">&gt;=</span> <span class="fl">7.0</span>:</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.high_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Error checking Nancy: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_eslint(<span class="va">self</span>):</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Check ESLint security plugin results&quot;&quot;&quot;</span></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;eslint.json&#39;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> file_result <span class="kw">in</span> data:</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> message <span class="kw">in</span> file_result.get(<span class="st">&#39;messages&#39;</span>, []):</span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> message.get(<span class="st">&#39;severity&#39;</span>, <span class="dv">0</span>) <span class="op">==</span> <span class="dv">2</span>:  <span class="co"># Error</span></span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>                        rule_id <span class="op">=</span> message.get(<span class="st">&#39;ruleId&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="st">&#39;security&#39;</span> <span class="kw">in</span> rule_id:</span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>                            <span class="va">self</span>.high_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>                            <span class="va">self</span>.findings.append({</span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;tool&#39;</span>: <span class="st">&#39;ESLint&#39;</span>,</span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;severity&#39;</span>: <span class="st">&#39;HIGH&#39;</span>,</span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;issue&#39;</span>: message.get(<span class="st">&#39;message&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;file&#39;</span>: file_result.get(<span class="st">&#39;filePath&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;line&#39;</span>: message.get(<span class="st">&#39;line&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>                            })</span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Error checking ESLint: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> evaluate(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Evaluate if security gate passes&quot;&quot;&quot;</span></span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;SECURITY GATE EVALUATION&quot;</span>)</span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.check_gosec()</span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.check_nancy()</span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.check_eslint()</span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Findings Summary:&quot;</span>)</span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;  Critical: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>critical_count<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;  High: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>high_count<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.critical_count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> SECURITY GATE FAILED: Critical issues found!&quot;</span>)</span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.passed <span class="op">=</span> <span class="va">False</span></span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="va">self</span>.high_count <span class="op">&gt;</span> <span class="dv">5</span>:</span>
<span id="cb27-101"><a href="#cb27-101" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss"> SECURITY GATE FAILED: Too many high severity issues (</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>high_count<span class="sc">}</span><span class="ss">)!&quot;</span>)</span>
<span id="cb27-102"><a href="#cb27-102" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.passed <span class="op">=</span> <span class="va">False</span></span>
<span id="cb27-103"><a href="#cb27-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb27-104"><a href="#cb27-104" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> SECURITY GATE PASSED!&quot;</span>)</span>
<span id="cb27-105"><a href="#cb27-105" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-106"><a href="#cb27-106" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print detailed findings</span></span>
<span id="cb27-107"><a href="#cb27-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.passed:</span>
<span id="cb27-108"><a href="#cb27-108" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Detailed Findings:&quot;</span>)</span>
<span id="cb27-109"><a href="#cb27-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> finding <span class="kw">in</span> <span class="va">self</span>.findings[:<span class="dv">10</span>]:  <span class="co"># Show first 10</span></span>
<span id="cb27-110"><a href="#cb27-110" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">[</span><span class="sc">{</span>finding[<span class="st">&#39;tool&#39;</span>]<span class="sc">}</span><span class="ss">] </span><span class="sc">{</span>finding[<span class="st">&#39;severity&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb27-111"><a href="#cb27-111" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;  </span><span class="sc">{</span>finding[<span class="st">&#39;issue&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb27-112"><a href="#cb27-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">&#39;file&#39;</span> <span class="kw">in</span> finding:</span>
<span id="cb27-113"><a href="#cb27-113" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;  Location: </span><span class="sc">{</span>finding[<span class="st">&#39;file&#39;</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>finding<span class="sc">.</span>get(<span class="st">&#39;line&#39;</span>, <span class="st">&#39;&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb27-114"><a href="#cb27-114" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-115"><a href="#cb27-115" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span><span class="op">*</span><span class="dv">60</span> <span class="op">+</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb27-116"><a href="#cb27-116" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-117"><a href="#cb27-117" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.passed</span>
<span id="cb27-118"><a href="#cb27-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-119"><a href="#cb27-119" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb27-120"><a href="#cb27-120" aria-hidden="true" tabindex="-1"></a>    gate <span class="op">=</span> SecurityGate()</span>
<span id="cb27-121"><a href="#cb27-121" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> gate.evaluate():</span>
<span id="cb27-122"><a href="#cb27-122" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">0</span>)</span>
<span id="cb27-123"><a href="#cb27-123" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb27-124"><a href="#cb27-124" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span></code></pre></div>
<hr />
<h2 id="testing-phase-exit-criteria">Testing Phase Exit Criteria</h2>
<p> <strong>All SAST scans completed and critical issues
resolved</strong><br />
 <strong>DAST scans completed with no high-risk
findings</strong><br />
 <strong>Dependency vulnerabilities addressed</strong><br />
 <strong>Penetration testing completed (for major
releases)</strong><br />
 <strong>Security acceptance tests passing</strong><br />
 <strong>Security team sign-off obtained</strong></p>
<h2 id="build-deployment-phase-exit-criteria">Build &amp; Deployment
Phase Exit Criteria</h2>
<p> <strong>Build completed successfully</strong><br />
 <strong>Container images scanned and approved</strong><br />
 <strong>Images pushed to ECR with proper tags</strong><br />
 <strong>Deployment to staging successful</strong><br />
 <strong>Integration tests passing</strong><br />
 <strong>Production deployment approved</strong><br />
 <strong>Health checks passing</strong></p>
<h2 id="operations-phase-exit-criteria">Operations Phase Exit
Criteria</h2>
<p> <strong>Monitoring dashboards configured</strong><br />
 <strong>Security alerts configured</strong><br />
 <strong>Logging properly configured</strong><br />
 <strong>Incident response procedures documented</strong><br />
 <strong>On-call rotation established</strong><br />
 <strong>Runbooks created and tested</strong></p>
<hr />
<h2 id="summary">Summary</h2>
<p>This consolidated document provides comprehensive coverage of the
remaining SDLC phases:</p>
<ul>
<li><strong>Testing</strong>: Complete security testing strategy with
SAST, DAST, dependency scanning, and penetration testing</li>
<li><strong>Build &amp; Deployment</strong>: AWS CodeBuild integration,
container security, ECR management, and secure deployment processes</li>
<li><strong>Operations</strong>: Security monitoring, logging, alerting,
and incident response</li>
<li><strong>CI/CD Pipeline</strong>: Integrated security automation
throughout the development pipeline</li>
</ul>
<p>For the complete SDLC process, refer to: - <a
href="01_SDLC_Overview.md">01_SDLC_Overview.md</a> - Process overview -
<a href="02_Requirements_Phase.md">02_Requirements_Phase.md</a> -
Security requirements - <a
href="03_Design_Phase.md">03_Design_Phase.md</a> - Secure architecture -
<a href="04_Development_Phase.md">04_Development_Phase.md</a> - Secure
coding</p>
<hr />
<p><em>This document is part of the SECURAA Secure SDLC documentation
suite. For questions, contact security@securaa.com</em></p>

</body>
</html>