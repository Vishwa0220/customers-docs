<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>03 Design Phase</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 30px;
            background-color: #fff;
        }

        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-top: 40px;
        }

        h2 {
            color: #34495e;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
            margin-top: 30px;
        }

        h3, h4, h5, h6 {
            color: #7f8c8d;
            margin-top: 20px;
        }

        code {
            background-color: #f7f9fc;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
        }

        pre {
            background-color: #2d3436;
            color: #dfe6e9;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.85em;
        }

        pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            font-size: 0.9em;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 10px 12px;
            text-align: left;
        }

        th {
            background-color: #3498db;
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        blockquote {
            border-left: 4px solid #3498db;
            margin: 20px 0;
            padding: 10px 20px;
            background-color: #ecf0f1;
            font-style: italic;
        }

        a {
            color: #3498db;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .diagram {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background-color: #fafafa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow-x: auto;
        }

        .diagram svg {
            max-width: 100%;
            height: auto;
        }

        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }

        ul, ol {
            padding-left: 25px;
        }

        li {
            margin-bottom: 5px;
        }

        hr {
            border: none;
            border-top: 2px solid #ecf0f1;
            margin: 30px 0;
        }

        #TOC {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
        }

        #TOC ul {
            list-style-type: none;
            padding-left: 0;
        }

        #TOC li {
            padding: 3px 0;
        }

        .header-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            margin: -30px -30px 30px -30px;
            text-align: center;
        }

        .header-section h1 {
            color: white;
            border: none;
            margin: 0;
        }

        .header-section p {
            margin: 10px 0 0 0;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="header-section">
        <h1>03 Design Phase</h1>
        <p>SECURAA Security Documentation</p>
    </div>
    <h1 id="securaa-secure-sdlc---design-phase">SECURAA Secure SDLC - Design
Phase</h1>
<h2 id="secure-architecture-design-and-security-review">Secure
Architecture Design and Security Review</h2>
<hr />
<h2 id="document-control">Document Control</h2>
<table>
<thead>
<tr class="header">
<th><strong>Document Title</strong></th>
<th>SECURAA SDLC - Design Phase</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Document ID</strong></td>
<td>SECURAA-SDLC-003</td>
</tr>
<tr class="even">
<td><strong>Version</strong></td>
<td>2.0</td>
</tr>
<tr class="odd">
<td><strong>Date</strong></td>
<td>November 13, 2025</td>
</tr>
<tr class="even">
<td><strong>Classification</strong></td>
<td>Customer-Facing - Confidential</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="phase-overview">Phase Overview</h2>
<p>The Design Phase translates security requirements into a secure
technical architecture. This phase ensures security controls are built
into the system design from the beginning, following the “Security by
Design” principle.</p>
<h3 id="phase-objectives">Phase Objectives</h3>
<ol type="1">
<li><strong>Design Secure Architecture</strong> - Create architecture
that implements security controls</li>
<li><strong>Define Security Controls</strong> - Specify technical
security mechanisms</li>
<li><strong>Review Data Flows</strong> - Ensure secure data handling
throughout the system</li>
<li><strong>Plan Security Testing</strong> - Define how security will be
tested</li>
<li><strong>Document Security Design</strong> - Create comprehensive
security design documentation</li>
</ol>
<h3 id="phase-duration">Phase Duration</h3>
<ul>
<li><strong>Simple Feature</strong>: 2-3 days</li>
<li><strong>Medium Feature</strong>: 1 week</li>
<li><strong>Major Feature/Project</strong>: 2-3 weeks</li>
</ul>
<hr />
<h2 id="secure-architecture-principles">Secure Architecture
Principles</h2>
<h3 id="defense-in-depth">Defense in Depth</h3>
<p>Implement multiple layers of security controls:</p>
<div class="diagram">
<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 290.953px; background-color: white;" viewBox="0 0 290.953125 1518" role="graphics-document document" aria-roledescription="flowchart-v2"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"><g class="cluster" id="subGraph3" data-look="classic"><rect style="" x="17.625" y="1198" width="255.703125" height="312"/><g class="cluster-label" transform="translate(45.4765625, 1198)"><text x="100.0" y="29.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Layer 4: Monitoring & Detection</text></g></g><g class="cluster" id="subGraph2" data-look="classic"><rect style="" x="8" y="836" width="274.953125" height="312"/><g class="cluster-label" transform="translate(66.328125, 836)"><text x="79.1484375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Layer 3: Data Security</text></g></g><g class="cluster" id="subGraph1" data-look="classic"><rect style="" x="25.9140625" y="370" width="239.125" height="416"/><g class="cluster-label" transform="translate(45.4765625, 370)"><text x="100.0" y="29.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Layer 2: Application Security</text></g></g><g class="cluster" id="subGraph0" data-look="classic"><rect style="" x="23.1171875" y="8" width="244.71875" height="312"/><g class="cluster-label" transform="translate(53.8828125, 8)"><text x="91.59375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Layer 1: Network Security</text></g></g></g><g class="edgePaths"><path d="M145.477,87L145.477,91.167C145.477,95.333,145.477,103.667,145.477,111.333C145.477,119,145.477,126,145.477,129.5L145.477,133" id="L_A1_A2_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A1_A2_0" data-points="W3sieCI6MTQ1LjQ3NjU2MjUsInkiOjg3fSx7IngiOjE0NS40NzY1NjI1LCJ5IjoxMTJ9LHsieCI6MTQ1LjQ3NjU2MjUsInkiOjEzN31d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M145.477,191L145.477,195.167C145.477,199.333,145.477,207.667,145.477,215.333C145.477,223,145.477,230,145.477,233.5L145.477,237" id="L_A2_A3_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A2_A3_0" data-points="W3sieCI6MTQ1LjQ3NjU2MjUsInkiOjE5MX0seyJ4IjoxNDUuNDc2NTYyNSwieSI6MjE2fSx7IngiOjE0NS40NzY1NjI1LCJ5IjoyNDF9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M145.477,449L145.477,453.167C145.477,457.333,145.477,465.667,145.477,473.333C145.477,481,145.477,488,145.477,491.5L145.477,495" id="L_B1_B2_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B1_B2_0" data-points="W3sieCI6MTQ1LjQ3NjU2MjUsInkiOjQ0OX0seyJ4IjoxNDUuNDc2NTYyNSwieSI6NDc0fSx7IngiOjE0NS40NzY1NjI1LCJ5Ijo0OTl9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M145.477,553L145.477,557.167C145.477,561.333,145.477,569.667,145.477,577.333C145.477,585,145.477,592,145.477,595.5L145.477,599" id="L_B2_B3_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B2_B3_0" data-points="W3sieCI6MTQ1LjQ3NjU2MjUsInkiOjU1M30seyJ4IjoxNDUuNDc2NTYyNSwieSI6NTc4fSx7IngiOjE0NS40NzY1NjI1LCJ5Ijo2MDN9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M145.477,657L145.477,661.167C145.477,665.333,145.477,673.667,145.477,681.333C145.477,689,145.477,696,145.477,699.5L145.477,703" id="L_B3_B4_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B3_B4_0" data-points="W3sieCI6MTQ1LjQ3NjU2MjUsInkiOjY1N30seyJ4IjoxNDUuNDc2NTYyNSwieSI6NjgyfSx7IngiOjE0NS40NzY1NjI1LCJ5Ijo3MDd9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M145.477,915L145.477,919.167C145.477,923.333,145.477,931.667,145.477,939.333C145.477,947,145.477,954,145.477,957.5L145.477,961" id="L_C1_C2_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C1_C2_0" data-points="W3sieCI6MTQ1LjQ3NjU2MjUsInkiOjkxNX0seyJ4IjoxNDUuNDc2NTYyNSwieSI6OTQwfSx7IngiOjE0NS40NzY1NjI1LCJ5Ijo5NjV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M145.477,1019L145.477,1023.167C145.477,1027.333,145.477,1035.667,145.477,1043.333C145.477,1051,145.477,1058,145.477,1061.5L145.477,1065" id="L_C2_C3_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C2_C3_0" data-points="W3sieCI6MTQ1LjQ3NjU2MjUsInkiOjEwMTl9LHsieCI6MTQ1LjQ3NjU2MjUsInkiOjEwNDR9LHsieCI6MTQ1LjQ3NjU2MjUsInkiOjEwNjl9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M145.477,1277L145.477,1281.167C145.477,1285.333,145.477,1293.667,145.477,1301.333C145.477,1309,145.477,1316,145.477,1319.5L145.477,1323" id="L_D1_D2_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D1_D2_0" data-points="W3sieCI6MTQ1LjQ3NjU2MjUsInkiOjEyNzd9LHsieCI6MTQ1LjQ3NjU2MjUsInkiOjEzMDJ9LHsieCI6MTQ1LjQ3NjU2MjUsInkiOjEzMjd9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M145.477,1381L145.477,1385.167C145.477,1389.333,145.477,1397.667,145.477,1405.333C145.477,1413,145.477,1420,145.477,1423.5L145.477,1427" id="L_D2_D3_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D2_D3_0" data-points="W3sieCI6MTQ1LjQ3NjU2MjUsInkiOjEzODF9LHsieCI6MTQ1LjQ3NjU2MjUsInkiOjE0MDZ9LHsieCI6MTQ1LjQ3NjU2MjUsInkiOjE0MzF9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M145.477,295L145.477,299.167C145.477,303.333,145.477,311.667,145.477,320C145.477,328.333,145.477,336.667,145.477,345C145.477,353.333,145.477,361.667,145.477,369.333C145.477,377,145.477,384,145.477,387.5L145.477,391" id="L_A3_B1_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A3_B1_0" data-points="W3sieCI6MTQ1LjQ3NjU2MjUsInkiOjI5NX0seyJ4IjoxNDUuNDc2NTYyNSwieSI6MzIwfSx7IngiOjE0NS40NzY1NjI1LCJ5IjozNDV9LHsieCI6MTQ1LjQ3NjU2MjUsInkiOjM3MH0seyJ4IjoxNDUuNDc2NTYyNSwieSI6Mzk1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M145.477,761L145.477,765.167C145.477,769.333,145.477,777.667,145.477,786C145.477,794.333,145.477,802.667,145.477,811C145.477,819.333,145.477,827.667,145.477,835.333C145.477,843,145.477,850,145.477,853.5L145.477,857" id="L_B4_C1_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B4_C1_0" data-points="W3sieCI6MTQ1LjQ3NjU2MjUsInkiOjc2MX0seyJ4IjoxNDUuNDc2NTYyNSwieSI6Nzg2fSx7IngiOjE0NS40NzY1NjI1LCJ5Ijo4MTF9LHsieCI6MTQ1LjQ3NjU2MjUsInkiOjgzNn0seyJ4IjoxNDUuNDc2NTYyNSwieSI6ODYxfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M145.477,1123L145.477,1127.167C145.477,1131.333,145.477,1139.667,145.477,1148C145.477,1156.333,145.477,1164.667,145.477,1173C145.477,1181.333,145.477,1189.667,145.477,1197.333C145.477,1205,145.477,1212,145.477,1215.5L145.477,1219" id="L_C3_D1_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C3_D1_0" data-points="W3sieCI6MTQ1LjQ3NjU2MjUsInkiOjExMjN9LHsieCI6MTQ1LjQ3NjU2MjUsInkiOjExNDh9LHsieCI6MTQ1LjQ3NjU2MjUsInkiOjExNzN9LHsieCI6MTQ1LjQ3NjU2MjUsInkiOjExOTh9LHsieCI6MTQ1LjQ3NjU2MjUsInkiOjEyMjN9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" data-id="L_A1_A2_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_A2_A3_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_B1_B2_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_B2_B3_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_B3_B4_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_C1_C2_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_C2_C3_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_D1_D2_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_D2_D3_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_A3_B1_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_B4_C1_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_C3_D1_0" transform="translate(0, 0)"></g></g></g><g class="nodes"><g class="node default" id="flowchart-A1-0" transform="translate(145.4765625, 60)"><rect class="basic label-container" style="fill:#e3f2fd !important" x="-66.6015625" y="-27" width="133.203125" height="54"/><g class="label" style="" transform="translate(-36.6015625, -12)"><text x="36.6015625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">AWS VPC</text></g></g><g class="node default" id="flowchart-A2-1" transform="translate(145.4765625, 164)"><rect class="basic label-container" style="" x="-87.359375" y="-27" width="174.71875" height="54"/><g class="label" style="" transform="translate(-57.359375, -12)"><text x="57.359375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Security Groups</text></g></g><g class="node default" id="flowchart-A3-3" transform="translate(145.4765625, 268)"><rect class="basic label-container" style="" x="-80.6875" y="-27" width="161.375" height="54"/><g class="label" style="" transform="translate(-50.6875, -12)"><text x="50.6875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Network ACLs</text></g></g><g class="node default" id="flowchart-B1-4" transform="translate(145.4765625, 422)"><rect class="basic label-container" style="fill:#f3e5f5 !important" x="-76.6875" y="-27" width="153.375" height="54"/><g class="label" style="" transform="translate(-46.6875, -12)"><text x="46.6875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">API Gateway</text></g></g><g class="node default" id="flowchart-B2-5" transform="translate(145.4765625, 526)"><rect class="basic label-container" style="" x="-80.703125" y="-27" width="161.40625" height="54"/><g class="label" style="" transform="translate(-50.703125, -12)"><text x="50.703125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Authentication</text></g></g><g class="node default" id="flowchart-B3-7" transform="translate(145.4765625, 630)"><rect class="basic label-container" style="" x="-76.6953125" y="-27" width="153.390625" height="54"/><g class="label" style="" transform="translate(-46.6953125, -12)"><text x="46.6953125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Authorization</text></g></g><g class="node default" id="flowchart-B4-9" transform="translate(145.4765625, 734)"><rect class="basic label-container" style="" x="-84.5625" y="-27" width="169.125" height="54"/><g class="label" style="" transform="translate(-54.5625, -12)"><text x="54.5625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Input Validation</text></g></g><g class="node default" id="flowchart-C1-10" transform="translate(145.4765625, 888)"><rect class="basic label-container" style="fill:#e8f5e9 !important" x="-102.4765625" y="-27" width="204.953125" height="54"/><g class="label" style="" transform="translate(-72.4765625, -12)"><text x="72.4765625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Encryption in Transit</text></g></g><g class="node default" id="flowchart-C2-11" transform="translate(145.4765625, 992)"><rect class="basic label-container" style="" x="-95.3671875" y="-27" width="190.734375" height="54"/><g class="label" style="" transform="translate(-65.3671875, -12)"><text x="65.3671875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Encryption at Rest</text></g></g><g class="node default" id="flowchart-C3-13" transform="translate(145.4765625, 1096)"><rect class="basic label-container" style="" x="-78.9140625" y="-27" width="157.828125" height="54"/><g class="label" style="" transform="translate(-48.9140625, -12)"><text x="48.9140625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Data Masking</text></g></g><g class="node default" id="flowchart-D1-14" transform="translate(145.4765625, 1250)"><rect class="basic label-container" style="fill:#fff3e0 !important" x="-92.8515625" y="-27" width="185.703125" height="54"/><g class="label" style="" transform="translate(-62.8515625, -12)"><text x="62.8515625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">CloudWatch Logs</text></g></g><g class="node default" id="flowchart-D2-15" transform="translate(145.4765625, 1354)"><rect class="basic label-container" style="" x="-85.578125" y="-27" width="171.15625" height="54"/><g class="label" style="" transform="translate(-55.578125, -12)"><text x="55.578125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Security Events</text></g></g><g class="node default" id="flowchart-D3-17" transform="translate(145.4765625, 1458)"><rect class="basic label-container" style="" x="-89.5859375" y="-27" width="179.171875" height="54"/><g class="label" style="" transform="translate(-59.5859375, -12)"><text x="59.5859375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">SIEM Integration</text></g></g></g></g></g></svg>
</div>
<h3 id="least-privilege">Least Privilege</h3>
<p>Every component operates with minimum necessary permissions:</p>
<div class="diagram">
<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 1110.66px; background-color: white;" viewBox="0 0 1110.65625 382" role="graphics-document document" aria-roledescription="flowchart-v2"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path d="M101.781,243L114.103,243C126.424,243,151.068,243,175.044,243C199.021,243,222.331,243,233.986,243L245.641,243" id="L_A_B_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A_B_0" data-points="W3sieCI6MTAxLjc4MTI1LCJ5IjoyNDN9LHsieCI6MTc1LjcxMDkzNzUsInkiOjI0M30seyJ4IjoyNDkuNjQwNjI1LCJ5IjoyNDN9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M345.004,216L365.885,194.5C386.766,173,428.527,130,462.469,108.5C496.411,87,522.534,87,535.595,87L548.656,87" id="L_B_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_C_0" data-points="W3sieCI6MzQ1LjAwMzc1NjAwOTYxNTM2LCJ5IjoyMTZ9LHsieCI6NDcwLjI4OTA2MjUsInkiOjg3fSx7IngiOjU1Mi42NTYyNSwieSI6ODd9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M387.922,243L401.65,243C415.378,243,442.833,243,472.164,243C501.495,243,532.701,243,548.303,243L563.906,243" id="L_B_D_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_D_0" data-points="W3sieCI6Mzg3LjkyMTg3NSwieSI6MjQzfSx7IngiOjQ3MC4yODkwNjI1LCJ5IjoyNDN9LHsieCI6NTY3LjkwNjI1LCJ5IjoyNDN9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M358.115,270L376.811,282.833C395.506,295.667,432.898,321.333,465.122,334.167C497.346,347,524.404,347,537.932,347L551.461,347" id="L_B_E_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_E_0" data-points="W3sieCI6MzU4LjExNTAwOTAxNDQyMzEsInkiOjI3MH0seyJ4Ijo0NzAuMjg5MDYyNSwieSI6MzQ3fSx7IngiOjU1NS40NjA5Mzc1LCJ5IjozNDd9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M714.313,63.543L730.704,58.786C747.096,54.029,779.88,44.514,814.667,39.757C849.453,35,886.242,35,904.637,35L923.031,35" id="L_C_C1_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_C1_0" data-points="W3sieCI6NzE0LjMxMjUsInkiOjYzLjU0Mjc1MTI1MzU0MjYyfSx7IngiOjgxMi42NjQwNjI1LCJ5IjozNX0seyJ4Ijo5MjcuMDMxMjUsInkiOjM1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M714.313,110.457L730.704,115.214C747.096,119.971,779.88,129.486,814.447,134.243C849.013,139,885.362,139,903.536,139L921.711,139" id="L_C_C2_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_C2_0" data-points="W3sieCI6NzE0LjMxMjUsInkiOjExMC40NTcyNDg3NDY0NTczOH0seyJ4Ijo4MTIuNjY0MDYyNSwieSI6MTM5fSx7IngiOjkyNS43MTA5Mzc1LCJ5IjoxMzl9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M699.063,243L717.996,243C736.93,243,774.797,243,809.531,243C844.266,243,875.867,243,891.668,243L907.469,243" id="L_D_D1_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D_D1_0" data-points="W3sieCI6Njk5LjA2MjUsInkiOjI0M30seyJ4Ijo4MTIuNjY0MDYyNSwieSI6MjQzfSx7IngiOjkxMS40Njg3NSwieSI6MjQzfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M711.508,347L728.367,347C745.227,347,778.945,347,811.53,347C844.115,347,875.565,347,891.29,347L907.016,347" id="L_E_E1_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E_E1_0" data-points="W3sieCI6NzExLjUwNzgxMjUsInkiOjM0N30seyJ4Ijo4MTIuNjY0MDYyNSwieSI6MzQ3fSx7IngiOjkxMS4wMTU2MjUsInkiOjM0N31d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(175.7109375, 243)"><g class="label" transform="translate(-48.9296875, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Authenticated</text></g></g><g class="edgeLabel" transform="translate(470.2890625, 87)"><g class="label" transform="translate(-32.8984375, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">IAM Role</text></g></g><g class="edgeLabel" transform="translate(470.2890625, 243)"><g class="label" transform="translate(-30.2265625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">DB User</text></g></g><g class="edgeLabel" transform="translate(470.2890625, 347)"><g class="label" transform="translate(-57.3671875, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Service Account</text></g></g><g class="edgeLabel" transform="translate(812.6640625, 35)"><g class="label" transform="translate(-73.3515625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Minimal Permissions</text></g></g><g class="edgeLabel" transform="translate(812.6640625, 139)"><g class="label" transform="translate(-73.3515625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Minimal Permissions</text></g></g><g class="edgeLabel" transform="translate(812.6640625, 243)"><g class="label" transform="translate(-73.3515625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Minimal Permissions</text></g></g><g class="edgeLabel" transform="translate(812.6640625, 347)"><g class="label" transform="translate(-73.3515625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Minimal Permissions</text></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-0" transform="translate(54.890625, 243)"><rect class="basic label-container" style="fill:#90caf9 !important" x="-46.890625" y="-27" width="93.78125" height="54"/><g class="label" style="" transform="translate(-16.890625, -12)"><text x="16.890625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">User</text></g></g><g class="node default" id="flowchart-B-1" transform="translate(318.78125, 243)"><rect class="basic label-container" style="fill:#a5d6a7 !important" x="-69.140625" y="-27" width="138.28125" height="54"/><g class="label" style="" transform="translate(-39.140625, -12)"><text x="39.140625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Application</text></g></g><g class="node default" id="flowchart-C-3" transform="translate(633.484375, 87)"><rect class="basic label-container" style="fill:#ffab91 !important" x="-80.828125" y="-27" width="161.65625" height="54"/><g class="label" style="" transform="translate(-50.828125, -12)"><text x="50.828125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">AWS Services</text></g></g><g class="node default" id="flowchart-D-5" transform="translate(633.484375, 243)"><rect class="basic label-container" style="fill:#fff176 !important" x="-65.578125" y="-27" width="131.15625" height="54"/><g class="label" style="" transform="translate(-35.578125, -12)"><text x="35.578125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">MongoDB</text></g></g><g class="node default" id="flowchart-E-7" transform="translate(633.484375, 347)"><rect class="basic label-container" style="fill:#ce93d8 !important" x="-78.0234375" y="-27" width="156.046875" height="54"/><g class="label" style="" transform="translate(-48.0234375, -12)"><text x="48.0234375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">External APIs</text></g></g><g class="node default" id="flowchart-C1-9" transform="translate(1006.8359375, 35)"><rect class="basic label-container" style="" x="-79.8046875" y="-27" width="159.609375" height="54"/><g class="label" style="" transform="translate(-49.8046875, -12)"><text x="49.8046875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">S3 Read Only</text></g></g><g class="node default" id="flowchart-C2-11" transform="translate(1006.8359375, 139)"><rect class="basic label-container" style="" x="-81.125" y="-27" width="162.25" height="54"/><g class="label" style="" transform="translate(-51.125, -12)"><text x="51.125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">ECR Pull Only</text></g></g><g class="node default" id="flowchart-D1-13" transform="translate(1006.8359375, 243)"><rect class="basic label-container" style="" x="-95.3671875" y="-27" width="190.734375" height="54"/><g class="label" style="" transform="translate(-65.3671875, -12)"><text x="65.3671875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Specific Collection</text></g></g><g class="node default" id="flowchart-E1-15" transform="translate(1006.8359375, 347)"><rect class="basic label-container" style="" x="-95.8203125" y="-27" width="191.640625" height="54"/><g class="label" style="" transform="translate(-65.8203125, -12)"><text x="65.8203125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Specific Endpoints</text></g></g></g></g></g></svg>
</div>
<h3 id="fail-secure">Fail Secure</h3>
<p>System fails in a secure state:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode go"><code class="sourceCode go"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Example: Fail secure pattern</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">func</span> AuthorizeRequest<span class="op">(</span>ctx context<span class="op">.</span>Context<span class="op">,</span> userID <span class="dt">string</span><span class="op">,</span> resource <span class="dt">string</span><span class="op">)</span> <span class="op">(</span><span class="dt">bool</span><span class="op">,</span> <span class="dt">error</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// If authorization service is unavailable, deny access (fail secure)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    permissions<span class="op">,</span> err <span class="op">:=</span> authService<span class="op">.</span>GetPermissions<span class="op">(</span>ctx<span class="op">,</span> userID<span class="op">)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> err <span class="op">!=</span> <span class="ot">nil</span> <span class="op">{</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        logger<span class="op">.</span>Error<span class="op">(</span><span class="st">&quot;Authorization service error&quot;</span><span class="op">,</span> <span class="st">&quot;error&quot;</span><span class="op">,</span> err<span class="op">)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ot">false</span><span class="op">,</span> err  <span class="co">// Deny access on error</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Check permissions</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> permissions<span class="op">.</span>HasAccess<span class="op">(</span>resource<span class="op">),</span> <span class="ot">nil</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h2 id="architecture-design-process">Architecture Design Process</h2>
<h3 id="step-1-component-diagram">Step 1: Component Diagram</h3>
<p>Define all system components and their interactions:</p>
<p><strong>Example: Integration Service Architecture</strong></p>
<div class="diagram">
<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="max-width: 876px; background-color: white;" viewBox="0 -70 876 842" role="graphics-document document" aria-roledescription="c4"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .person{stroke:hsl(240, 60%, 86.2745098039%);fill:#ECECFF;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g/><defs><symbol id="computer" width="24" height="24"><path transform="scale(.5)" d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z"/></symbol></defs><defs><symbol id="database" fill-rule="evenodd" clip-rule="evenodd"><path transform="scale(.5)" d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z"/></symbol></defs><defs><symbol id="clock" width="24" height="24"><path transform="scale(.5)" d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z"/></symbol></defs><g class="person-man"><rect x="150" y="166" fill="#08427B" stroke="#073B6F" width="260" height="134" rx="2.5" ry="2.5" stroke-width="0.5"/><text fill="#FFFFFF" font-family="&quot;Open Sans&quot;, sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="50" x="255" y="186">&lt;&lt;person&gt;&gt;</text><image width="48" height="48" x="256" y="196" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAIAAADYYG7QAAACD0lEQVR4Xu2YoU4EMRCGT+4j8Ai8AhaH4QHgAUjQuFMECUgMIUgwJAgMhgQsAYUiJCiQIBBY+EITsjfTdme6V24v4c8vyGbb+ZjOtN0bNcvjQXmkH83WvYBWto6PLm6v7p7uH1/w2fXD+PBycX1Pv2l3IdDm/vn7x+dXQiAubRzoURa7gRZWd0iGRIiJbOnhnfYBQZNJjNbuyY2eJG8fkDE3bbG4ep6MHUAsgYxmE3nVs6VsBWJSGccsOlFPmLIViMzLOB7pCVO2AtHJMohH7Fh6zqitQK7m0rJvAVYgGcEpe//PLdDz65sM4pF9N7ICcXDKIB5Nv6j7tD0NoSdM2QrU9Gg0ewE1LqBhHR3BBdvj2vapnidjHxD/q6vd7Pvhr31AwcY8eXMTXAKECZZJFXuEq27aLgQK5uLMohCenGGuGewOxSjBvYBqeG6B+Nqiblggdjnc+ZXDy+FNFpFzw76O3UBAROuXh6FoiAcf5g9eTvUgzy0nWg6I8cXHRUpg5bOVBCo+KDpFajOf23GgPme7RSQ+lacIENUgJ6gg1k6HjgOlqnLqip4tEuhv0hNEMXUD0clyXE3p6pZA0S2nnvTlXwLJEZWlb7cTQH1+USgTN4VhAenm/wea1OCAOmqo6fE1WCb9WSKBah+rbUWPWAmE2Rvk0ApiB45eOyNAzU8xcTvj8KvkKEoOaIYeHNA3ZuygAvFMUO0AAAAASUVORK5CYII="/><text x="280" y="252" dominant-baseline="middle" fill="#FFFFFF" style="text-anchor: middle; font-size: 16px; font-weight: bold; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">Security Analyst</tspan></text><text x="280" y="289" dominant-baseline="middle" fill="#FFFFFF" style="text-anchor: middle; font-size: 14px; font-weight: normal; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">SECURAA user managing integrations</tspan></text></g><g class="person-man"><rect x="510" y="166" fill="#1168BD" stroke="#3C7FC0" width="216" height="86" rx="2.5" ry="2.5" stroke-width="0.5"/><text fill="#FFFFFF" font-family="&quot;Open Sans&quot;, sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="52" x="592" y="186">&lt;&lt;system&gt;&gt;</text><text x="618" y="204" dominant-baseline="middle" fill="#FFFFFF" style="text-anchor: middle; font-size: 16px; font-weight: bold; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">SECURAA Platform</tspan></text><text x="618" y="241" dominant-baseline="middle" fill="#FFFFFF" style="text-anchor: middle; font-size: 14px; font-weight: normal; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">Security orchestration platform</tspan></text></g><g class="person-man"><rect x="150" y="400" fill="#999999" stroke="#8A8A8A" width="216" height="86" rx="2.5" ry="2.5" stroke-width="0.5"/><text fill="#FFFFFF" font-family="&quot;Open Sans&quot;, sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="101" x="207.5" y="420">&lt;&lt;external_system&gt;&gt;</text><text x="258" y="438" dominant-baseline="middle" fill="#FFFFFF" style="text-anchor: middle; font-size: 16px; font-weight: bold; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">ServiceNow</tspan></text><text x="258" y="475" dominant-baseline="middle" fill="#FFFFFF" style="text-anchor: middle; font-size: 14px; font-weight: normal; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">External ticketing system</tspan></text></g><g class="person-man"><rect x="466" y="400" fill="#999999" stroke="#8A8A8A" width="216" height="86" rx="2.5" ry="2.5" stroke-width="0.5"/><text fill="#FFFFFF" font-family="&quot;Open Sans&quot;, sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="101" x="523.5" y="420">&lt;&lt;external_system&gt;&gt;</text><text x="574" y="438" dominant-baseline="middle" fill="#FFFFFF" style="text-anchor: middle; font-size: 16px; font-weight: bold; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">Splunk</tspan></text><text x="574" y="475" dominant-baseline="middle" fill="#FFFFFF" style="text-anchor: middle; font-size: 14px; font-weight: normal; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">External SIEM</tspan></text></g><g class="person-man"><rect x="150" y="586" fill="#999999" stroke="#8A8A8A" width="216" height="86" rx="2.5" ry="2.5" stroke-width="0.5"/><text fill="#FFFFFF" font-family="&quot;Open Sans&quot;, sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="101" x="207.5" y="606">&lt;&lt;external_system&gt;&gt;</text><text x="258" y="624" dominant-baseline="middle" fill="#FFFFFF" style="text-anchor: middle; font-size: 16px; font-weight: bold; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">AWS Secrets Manager</tspan></text><text x="258" y="661" dominant-baseline="middle" fill="#FFFFFF" style="text-anchor: middle; font-size: 14px; font-weight: normal; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">Credential storage</tspan></text></g><defs><marker id="arrowhead" refX="9" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z"/></marker></defs><defs><marker id="arrowend" refX="1" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 10 0 L 0 5 L 10 10 z"/></marker></defs><defs><marker id="crosshead" markerWidth="15" markerHeight="8" orient="auto" refX="16" refY="4"><path fill="black" stroke="#000000" stroke-width="1px" d="M 9,2 V 6 L16,4 Z" style="stroke-dasharray: 0, 0;"/><path fill="none" stroke="#000000" stroke-width="1px" d="M 0,1 L 6,7 M 6,1 L 0,7" style="stroke-dasharray: 0, 0;"/></marker></defs><defs><marker id="filled-head" refX="18" refY="7" markerWidth="20" markerHeight="28" orient="auto"><path d="M 18,7 L9,13 L14,7 L9,1 Z"/></marker></defs><g><line x1="410" y1="244.94444444444446" x2="510" y2="240.4608695652174" stroke-width="1" stroke="#444444" marker-end="url(#arrowhead)" style="fill: none;"/><text x="473.5" y="242.70265700483094" dominant-baseline="middle" fill="#444444" style="text-anchor: middle; font-size: 12px; font-weight: normal; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">Uses</tspan></text><text x="479.5" y="259.70265700483094" dominant-baseline="middle" fill="#444444" font-style="italic" style="text-anchor: middle; font-size: 12px; font-weight: normal; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">[HTTPS]</tspan></text><path fill="none" stroke-width="1" stroke="#444444" d="M578.8808664259927,252 Q525.0009639556201,326 363.3612565445026,400" marker-end="url(#arrowhead)"/><text x="497.62106148524765" y="326" dominant-baseline="middle" fill="#444444" style="text-anchor: middle; font-size: 12px; font-weight: normal; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">Integrates</tspan></text><text x="519.1210614852477" y="343" dominant-baseline="middle" fill="#444444" font-style="italic" style="text-anchor: middle; font-size: 12px; font-weight: normal; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">[REST API/HTTPS]</tspan></text><path fill="none" stroke-width="1" stroke="#444444" d="M627.9350180505415,252 Q623.0062373598957,326 608.2198952879581,400" marker-end="url(#arrowhead)"/><text x="644.5774566692498" y="326" dominant-baseline="middle" fill="#444444" style="text-anchor: middle; font-size: 12px; font-weight: normal; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">Integrates</tspan></text><text x="663.0774566692498" y="343" dominant-baseline="middle" fill="#444444" font-style="italic" style="text-anchor: middle; font-size: 12px; font-weight: normal; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">[HEC API/HTTPS]</tspan></text><path fill="none" stroke-width="1" stroke="#444444" d="M594.5961123110151,252 Q523.7919118194682,419 311.37931034482756,586" marker-end="url(#arrowhead)"/><text x="508.9877113279213" y="419" dominant-baseline="middle" fill="#444444" style="text-anchor: middle; font-size: 12px; font-weight: normal; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">Retrieves credentials</tspan></text><text x="508.9877113279213" y="436" dominant-baseline="middle" fill="#444444" font-style="italic" style="text-anchor: middle; font-size: 12px; font-weight: normal; font-family: &quot;Open Sans&quot;, sans-serif;"><tspan dy="0" alignment-baseline="mathematical">[AWS SDK/TLS]</tspan></text></g><text x="188" y="20">System Context - Integration Service</text></svg>
</div>
<h3 id="step-2-data-flow-diagram">Step 2: Data Flow Diagram</h3>
<p>Map data flows with security controls:</p>
<div class="diagram">
<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 1070.48px; background-color: white;" viewBox="39.4453125 0 1070.484375 597.6015625" role="graphics-document document" aria-roledescription="flowchart-v2"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path d="M564.273,62L564.273,68.167C564.273,74.333,564.273,86.667,564.273,98.333C564.273,110,564.273,121,564.273,126.5L564.273,132" id="L_A_B_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A_B_0" data-points="W3sieCI6NTY0LjI3MzQzNzUsInkiOjYyfSx7IngiOjU2NC4yNzM0Mzc1LCJ5Ijo5OX0seyJ4Ijo1NjQuMjczNDM3NSwieSI6MTM2fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M564.273,190L564.273,196.167C564.273,202.333,564.273,214.667,564.273,226.333C564.273,238,564.273,249,564.273,254.5L564.273,260" id="L_B_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_C_0" data-points="W3sieCI6NTY0LjI3MzQzNzUsInkiOjE5MH0seyJ4Ijo1NjQuMjczNDM3NSwieSI6MjI3fSx7IngiOjU2NC4yNzM0Mzc1LCJ5IjoyNjR9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M471.117,303.123L404.677,311.769C338.237,320.415,205.357,337.708,147.352,353.393C89.348,369.079,106.219,383.159,114.655,390.198L123.09,397.238" id="L_C_D_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_D_0" data-points="W3sieCI6NDcxLjExNzE4NzUsInkiOjMwMy4xMjI4OTExODM0Nzg5NH0seyJ4Ijo3Mi40NzY1NjI1LCJ5IjozNTV9LHsieCI6MTI2LjE2MTQ2MTgwODg0ODgxLCJ5IjozOTkuODAwNzk2NTA4Nzg5MDZ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M190.87,399.801L199.817,392.334C208.765,384.867,226.66,369.934,272.714,355.039C318.768,340.144,392.982,325.289,430.088,317.861L467.195,310.433" id="L_D_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D_C_0" data-points="W3sieCI6MTkwLjg2OTc4ODE5MTE1MTIsInkiOjM5OS44MDA3OTY1MDg3ODkwNn0seyJ4IjoyNDQuNTU0Njg3NSwieSI6MzU1fSx7IngiOjQ3MS4xMTcxODc1LCJ5IjozMDkuNjQ3NjM5NTI2OTI3OTV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M497.301,318L482.005,324.167C466.708,330.333,436.116,342.667,427.175,355.454C418.234,368.242,430.946,381.484,437.301,388.105L443.657,394.726" id="L_C_E_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_E_0" data-points="W3sieCI6NDk3LjMwMDc4MTI1LCJ5IjozMTh9LHsieCI6NDA1LjUyMzQzNzUsInkiOjM1NX0seyJ4Ijo0NDYuNDI2NTM1Mjc2MDg4MDMsInkiOjM5Ny42MTExODkwMzMxNDQ5fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M636.961,318L653.563,324.167C670.164,330.333,703.367,342.667,726.373,355.809C749.379,368.951,762.187,382.903,768.591,389.879L774.995,396.854" id="L_C_F_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_F_0" data-points="W3sieCI6NjM2Ljk2MTE4MTY0MDYyNSwieSI6MzE4fSx7IngiOjczNi41NzAzMTI1LCJ5IjozNTV9LHsieCI6Nzc3LjcwMDQ2MjEzMzkyNDYsInkiOjM5OS44MDA3OTY1MDg3ODkwNn1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M827.276,399.801L834.131,392.334C840.986,384.867,854.696,369.934,827.041,355.205C799.385,340.476,730.365,325.951,695.854,318.689L661.344,311.427" id="L_F_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_F_C_0" data-points="W3sieCI6ODI3LjI3NjEwMDM2NjA3NTQsInkiOjM5OS44MDA3OTY1MDg3ODkwNn0seyJ4Ijo4NjguNDA2MjUsInkiOjM1NX0seyJ4Ijo2NTcuNDI5Njg3NSwieSI6MzEwLjYwMzI3Nzc2MjA3OTd9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M564.273,318L564.273,324.167C564.273,330.333,564.273,342.667,557.918,355.454C551.562,368.242,538.851,381.484,532.496,388.105L526.14,394.726" id="L_C_E_2" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_E_2" data-points="W3sieCI6NTY0LjI3MzQzNzUsInkiOjMxOH0seyJ4Ijo1NjQuMjczNDM3NSwieSI6MzU1fSx7IngiOjUyMy4zNzAzMzk3MjM5MTE5LCJ5IjozOTcuNjExMTg5MDMzMTQ0OX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M657.43,303.839L719.299,312.366C781.169,320.893,904.909,337.946,966.779,353.273C1028.648,368.6,1028.648,382.201,1028.648,389.001L1028.648,395.801" id="L_C_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_G_0" data-points="W3sieCI6NjU3LjQyOTY4NzUsInkiOjMwMy44Mzg3NjE3NzY1ODE0fSx7IngiOjEwMjguNjQ4NDM3NSwieSI6MzU1fSx7IngiOjEwMjguNjQ4NDM3NSwieSI6Mzk5LjgwMDc5NjUwODc4OTA2fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1028.648,453.801L1028.648,461.268C1028.648,468.734,1028.648,483.668,1028.648,496.635C1028.648,509.602,1028.648,520.602,1028.648,526.102L1028.648,531.602" id="L_G_H_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_G_H_0" data-points="W3sieCI6MTAyOC42NDg0Mzc1LCJ5Ijo0NTMuODAwNzk2NTA4Nzg5MDZ9LHsieCI6MTAyOC42NDg0Mzc1LCJ5Ijo0OTguNjAxNTkzMDE3NTc4MX0seyJ4IjoxMDI4LjY0ODQzNzUsInkiOjUzNS42MDE1OTMwMTc1NzgxfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(564.2734375, 99)"><g class="label" transform="translate(-83.6796875, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">1. HTTPS + Auth Token</text></g></g><g class="edgeLabel" transform="translate(564.2734375, 227)"><g class="label" transform="translate(-36.765625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">2. TLS 1.3</text></g></g><g class="edgeLabel" transform="translate(237.12787, 333.5731)"><g class="label" transform="translate(-64.4765625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">3. Get Credentials</text></g></g><g class="edgeLabel" transform="translate(244.5546875, 355)"><g class="label" transform="translate(-87.6015625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">4. Encrypted Credentials</text></g></g><g class="edgeLabel" transform="translate(405.5234375, 355)"><g class="label" transform="translate(-53.3671875, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">5. Store Config</text></g></g><g class="edgeLabel" transform="translate(715.27159, 347.08855)"><g class="label" transform="translate(-66.9140625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">6. HTTPS + OAuth</text></g></g><g class="edgeLabel" transform="translate(868.40625, 355)"><g class="label" transform="translate(-44.921875, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">7. Response</text></g></g><g class="edgeLabel" transform="translate(564.2734375, 355)"><g class="label" transform="translate(-85.3828125, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">8. Store Data Encrypted</text></g></g><g class="edgeLabel" transform="translate(1028.6484375, 355)"><g class="label" transform="translate(-44.921875, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">9. Log Event</text></g></g><g class="edgeLabel" transform="translate(1028.6484375, 498.6015930175781)"><g class="label" transform="translate(-42.6875, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">10. Forward</text></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-0" transform="translate(564.2734375, 35)"><rect class="basic label-container" style="fill:#90caf9 !important" x="-78.453125" y="-27" width="156.90625" height="54"/><g class="label" style="" transform="translate(-48.453125, -12)"><text x="48.453125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">User Browser</text></g></g><g class="node default" id="flowchart-B-1" transform="translate(564.2734375, 163)"><rect class="basic label-container" style="fill:#ce93d8 !important" x="-45.125" y="-27" width="90.25" height="54"/><g class="label" style="" transform="translate(-15.125, -12)"><text x="15.125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">ALB</text></g></g><g class="node default" id="flowchart-C-3" transform="translate(564.2734375, 291)"><rect class="basic label-container" style="fill:#a5d6a7 !important" x="-93.15625" y="-27" width="186.3125" height="54"/><g class="label" style="" transform="translate(-63.15625, -12)"><text x="63.15625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">zona_integrations</text></g></g><g class="node default" id="flowchart-D-5" transform="translate(158.515625, 426.80079650878906)"><rect class="basic label-container" style="fill:#f48fb1 !important" x="-111.0703125" y="-27" width="222.140625" height="54"/><g class="label" style="" transform="translate(-81.0703125, -12)"><text x="81.0703125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">AWS Secrets Manager</text></g></g><g class="node default" id="flowchart-E-9" transform="translate(484.8984375, 426.80079650878906)"><path d="M0,10.200532780819891 a43.078125,10.200532780819891 0,0,0 86.15625,0 a43.078125,10.200532780819891 0,0,0 -86.15625,0 l0,49.20053278081989 a43.078125,10.200532780819891 0,0,0 86.15625,0 l0,-49.20053278081989" class="basic label-container" style="fill:#ffab91 !important" transform="translate(-43.078125, -34.80079917122984)"/><g class="label" style="" transform="translate(-35.578125, -2)"><text x="35.578125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">MongoDB</text></g></g><g class="node default" id="flowchart-F-11" transform="translate(802.48828125, 426.80079650878906)"><rect class="basic label-container" style="fill:#fff176 !important" x="-87.359375" y="-27" width="174.71875" height="54"/><g class="label" style="" transform="translate(-57.359375, -12)"><text x="57.359375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">ServiceNow API</text></g></g><g class="node default" id="flowchart-G-17" transform="translate(1028.6484375, 426.80079650878906)"><rect class="basic label-container" style="fill:#80deea !important" x="-73.28125" y="-27" width="146.5625" height="54"/><g class="label" style="" transform="translate(-43.28125, -12)"><text x="43.28125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">CloudWatch</text></g></g><g class="node default" id="flowchart-H-19" transform="translate(1028.6484375, 562.6015930175781)"><rect class="basic label-container" style="fill:#bcaaa4 !important" x="-49.5625" y="-27" width="99.125" height="54"/><g class="label" style="" transform="translate(-19.5625, -12)"><text x="19.5625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">SIEM</text></g></g></g></g></g></svg>
</div>
<h3 id="step-3-security-control-design">Step 3: Security Control
Design</h3>
<p>For each component, design security controls:</p>
<h4 id="authentication-design">Authentication Design</h4>
<div class="sourceCode" id="cb2"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">component</span><span class="kw">:</span><span class="at"> API Authentication</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">authentication_methods</span><span class="kw">:</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">primary</span><span class="kw">:</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> JWT (JSON Web Token)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">algorithm</span><span class="kw">:</span><span class="at"> HS256</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">token_expiry</span><span class="kw">:</span><span class="at"> 1 hour</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">refresh_token_expiry</span><span class="kw">:</span><span class="at"> 7 days</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">secret_storage</span><span class="kw">:</span><span class="at"> AWS Secrets Manager</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">rotation_policy</span><span class="kw">:</span><span class="at"> 90 days</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">secondary</span><span class="kw">:</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> API Key</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">format</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;securaa_api_[random_32_chars]&quot;</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">storage</span><span class="kw">:</span><span class="at"> Hashed with bcrypt (cost factor 12)</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">rate_limiting</span><span class="kw">:</span><span class="at"> 1000 requests/hour</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">administrative</span><span class="kw">:</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> MFA (Multi-Factor Authentication)</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">methods</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">TOTP</span><span class="kw">,</span><span class="at"> SMS</span><span class="kw">,</span><span class="at"> Email</span><span class="kw">]</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enforcement</span><span class="kw">:</span><span class="at"> Required for admin operations</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">session_timeout</span><span class="kw">:</span><span class="at"> 15 minutes</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="fu">implementation</span><span class="kw">:</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">library</span><span class="kw">:</span><span class="at"> github.com/golang-jwt/jwt/v5</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">middleware</span><span class="kw">:</span><span class="at"> AuthenticationMiddleware()</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">error_handling</span><span class="kw">:</span><span class="at"> Generic error messages (no details)</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">logging</span><span class="kw">:</span><span class="at"> Authentication success/failure events</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="fu">security_features</span><span class="kw">:</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Token signature verification</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Token expiration validation</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Token revocation support (blacklist)</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Brute force protection (5 attempts, 15-minute lockout)</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Concurrent session detection</span></span></code></pre></div>
<h4 id="authorization-design">Authorization Design</h4>
<div class="sourceCode" id="cb3"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">component</span><span class="kw">:</span><span class="at"> Authorization &amp; Access Control</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">model</span><span class="kw">:</span><span class="at"> Role-Based Access Control (RBAC)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">roles</span><span class="kw">:</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> admin</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">permissions</span><span class="kw">:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> integration:create</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> integration:read</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> integration:update</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> integration:delete</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> integration:execute</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> user:manage</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> analyst</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">permissions</span><span class="kw">:</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> integration:read</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> integration:execute</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> case:create</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> case:update</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> viewer</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">permissions</span><span class="kw">:</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> integration:read</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> case:read</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="fu">permission_format</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;resource:action&quot;</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="fu">enforcement</span><span class="kw">:</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">Middleware</span><span class="kw">:</span><span class="at"> AuthorizationMiddleware()</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">Decorator</span><span class="kw">:</span><span class="at"> @RequirePermission(&quot;integration:create&quot;)</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">Function</span><span class="kw">:</span><span class="at"> HasPermission(user, &quot;integration&quot;, &quot;create&quot;)</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="fu">storage</span><span class="kw">:</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> MongoDB collection</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">schema</span><span class="kw">:</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">user_id</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">roles</span><span class="kw">:</span><span class="at"> array[string]</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">permissions</span><span class="kw">:</span><span class="at"> array[string]</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">granted_at</span><span class="kw">:</span><span class="at"> timestamp</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">granted_by</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="fu">caching</span><span class="kw">:</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ttl</span><span class="kw">:</span><span class="at"> 300 seconds</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">invalidation</span><span class="kw">:</span><span class="at"> On permission change</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="fu">audit</span><span class="kw">:</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">log_event</span><span class="kw">:</span><span class="at"> authorization_check</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">fields</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">user_id</span><span class="kw">,</span><span class="at"> resource</span><span class="kw">,</span><span class="at"> action</span><span class="kw">,</span><span class="at"> result</span><span class="kw">,</span><span class="at"> timestamp</span><span class="kw">]</span></span></code></pre></div>
<h4 id="data-protection-design">Data Protection Design</h4>
<div class="sourceCode" id="cb4"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">component</span><span class="kw">:</span><span class="at"> Data Encryption</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">encryption_at_rest</span><span class="kw">:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">algorithm</span><span class="kw">:</span><span class="at"> AES-256-GCM</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">key_management</span><span class="kw">:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">service</span><span class="kw">:</span><span class="at"> AWS KMS</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">key_rotation</span><span class="kw">:</span><span class="at"> Automatic (365 days)</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">key_alias</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;alias/securaa-data-encryption&quot;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">encrypted_fields</span><span class="kw">:</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> integration_credentials</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> api_tokens</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> customer_pii</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> sensitive_case_data</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">implementation</span><span class="kw">:</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">library</span><span class="kw">:</span><span class="at"> securaa_lib/encrypt_decrypt</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">function</span><span class="kw">:</span><span class="at"> CredentialsEncrypt(data, key)</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="fu">encryption_in_transit</span><span class="kw">:</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TLS 1.3</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">minimum_version</span><span class="kw">:</span><span class="at"> TLS 1.2</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">cipher_suites</span><span class="kw">:</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> TLS_AES_256_GCM_SHA384</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> TLS_AES_128_GCM_SHA256</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> TLS_CHACHA20_POLY1305_SHA256</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">certificate_management</span><span class="kw">:</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">provider</span><span class="kw">:</span><span class="at"> AWS Certificate Manager</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">renewal</span><span class="kw">:</span><span class="at"> Automatic</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> DNS validation</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">implementation</span><span class="kw">:</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">load_balancer</span><span class="kw">:</span><span class="at"> ALB with TLS termination</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">backend</span><span class="kw">:</span><span class="at"> TLS for service-to-service communication</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">external</span><span class="kw">:</span><span class="at"> HTTPS only for external APIs</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="fu">data_masking</span><span class="kw">:</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pii_fields</span><span class="kw">:</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">email</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;us***@example.com&quot;</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">phone</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;***-***-1234&quot;</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">ssn</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;***-**-1234&quot;</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">implementation</span><span class="kw">:</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">logging</span><span class="kw">:</span><span class="at"> Mask before logging</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">display</span><span class="kw">:</span><span class="at"> Mask in UI (unmask with permission)</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">export</span><span class="kw">:</span><span class="at"> Mask in reports (unless authorized)</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="fu">key_rotation</span><span class="kw">:</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">encryption_keys</span><span class="kw">:</span><span class="at"> 365 days</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">api_keys</span><span class="kw">:</span><span class="at"> 90 days</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">jwt_secrets</span><span class="kw">:</span><span class="at"> 90 days</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">integration_credentials</span><span class="kw">:</span><span class="at"> On-demand + 180 days</span></span></code></pre></div>
<hr />
<h2 id="microservices-security-design">Microservices Security
Design</h2>
<h3 id="service-to-service-communication">Service-to-Service
Communication</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">communication_pattern</span><span class="kw">:</span><span class="at"> Service Mesh</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">security_controls</span><span class="kw">:</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">authentication</span><span class="kw">:</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">method</span><span class="kw">:</span><span class="at"> mTLS (Mutual TLS)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">certificates</span><span class="kw">:</span><span class="at"> Service-specific certificates</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> Certificate pinning</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">authorization</span><span class="kw">:</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">method</span><span class="kw">:</span><span class="at"> JWT tokens</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">scope</span><span class="kw">:</span><span class="at"> Service-specific scopes</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> Token signature + claims</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">encryption</span><span class="kw">:</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TLS 1.3</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">mandatory</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fallback</span><span class="kw">:</span><span class="at"> Not allowed</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="fu">service_registry</span><span class="kw">:</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">location</span><span class="kw">:</span><span class="at"> MongoDB collection &quot;service_registry&quot;</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">schema</span><span class="kw">:</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">service_name</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">endpoints</span><span class="kw">:</span><span class="at"> array[string]</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">public_key</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">allowed_callers</span><span class="kw">:</span><span class="at"> array[string]</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="fu">network_policies</span><span class="kw">:</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">default</span><span class="kw">:</span><span class="at"> Deny all</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">allow_rules</span><span class="kw">:</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">from</span><span class="kw">:</span><span class="at"> zona_integrations</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">to</span><span class="kw">:</span><span class="at"> zona_apis_manager</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">ports</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="dv">8080</span><span class="kw">]</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">from</span><span class="kw">:</span><span class="at"> zona_user</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">to</span><span class="kw">:</span><span class="at"> MongoDB</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">ports</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="dv">27017</span><span class="kw">]</span></span></code></pre></div>
<h3 id="service-security-architecture">Service Security
Architecture</h3>
<p><strong>Example: zona_integrations Service</strong></p>
<div class="diagram">
<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 816.305px; background-color: white;" viewBox="0 0 816.3046875 935.6015625" role="graphics-document document" aria-roledescription="flowchart-v2"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"><g class="cluster" id="subGraph0" data-look="classic"><rect style="" x="8" y="8" width="386.8984375" height="776"/><g class="cluster-label" transform="translate(109.39453125, 8)"><text x="92.0546875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">zona_integrations Service</text></g></g></g><g class="edgePaths"><path d="M247.008,87L247.008,91.167C247.008,95.333,247.008,103.667,247.008,111.333C247.008,119,247.008,126,247.008,129.5L247.008,133" id="L_A_B_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A_B_0" data-points="W3sieCI6MjQ3LjAwNzgxMjUsInkiOjg3fSx7IngiOjI0Ny4wMDc4MTI1LCJ5IjoxMTJ9LHsieCI6MjQ3LjAwNzgxMjUsInkiOjEzN31d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M230.077,191L226.21,197.167C222.343,203.333,214.609,215.667,210.742,227.333C206.875,239,206.875,250,206.875,255.5L206.875,261" id="L_B_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_C_0" data-points="W3sieCI6MjMwLjA3Njc4MjIyNjU2MjUsInkiOjE5MX0seyJ4IjoyMDYuODc1LCJ5IjoyMjh9LHsieCI6MjA2Ljg3NSwieSI6MjY1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M206.875,319L206.875,323.167C206.875,327.333,206.875,335.667,206.875,343.333C206.875,351,206.875,358,206.875,361.5L206.875,365" id="L_C_D_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_D_0" data-points="W3sieCI6MjA2Ljg3NSwieSI6MzE5fSx7IngiOjIwNi44NzUsInkiOjM0NH0seyJ4IjoyMDYuODc1LCJ5IjozNjl9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M206.875,423L206.875,427.167C206.875,431.333,206.875,439.667,206.875,447.333C206.875,455,206.875,462,206.875,465.5L206.875,469" id="L_D_E_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D_E_0" data-points="W3sieCI6MjA2Ljg3NSwieSI6NDIzfSx7IngiOjIwNi44NzUsInkiOjQ0OH0seyJ4IjoyMDYuODc1LCJ5Ijo0NzN9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M178.537,527L172.065,533.167C165.592,539.333,152.648,551.667,146.175,563.333C139.703,575,139.703,586,139.703,591.5L139.703,597" id="L_E_F_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E_F_0" data-points="W3sieCI6MTc4LjUzNjg2NTIzNDM3NSwieSI6NTI3fSx7IngiOjEzOS43MDMxMjUsInkiOjU2NH0seyJ4IjoxMzkuNzAzMTI1LCJ5Ijo2MDF9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M139.703,655L139.703,659.167C139.703,663.333,139.703,671.667,139.703,679.333C139.703,687,139.703,694,139.703,697.5L139.703,701" id="L_F_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_F_G_0" data-points="W3sieCI6MTM5LjcwMzEyNSwieSI6NjU1fSx7IngiOjEzOS43MDMxMjUsInkiOjY4MH0seyJ4IjoxMzkuNzAzMTI1LCJ5Ijo3MDV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M269.738,191L274.929,197.167C280.121,203.333,290.504,215.667,316.56,228.237C342.616,240.808,384.345,253.617,405.21,260.021L426.075,266.425" id="L_B_H_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_H_0" data-points="W3sieCI6MjY5LjczNzk3NjA3NDIxODc1LCJ5IjoxOTF9LHsieCI6MzAwLjg4NjcxODc1LCJ5IjoyMjh9LHsieCI6NDI5Ljg5ODQzNzUsInkiOjI2Ny41OTg0OTM3ODk2OTI1NX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M210.425,527L211.235,533.167C212.046,539.333,213.668,551.667,249.594,565.189C285.521,578.711,355.752,593.423,390.868,600.779L425.983,608.134" id="L_E_I_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E_I_0" data-points="W3sieCI6MjEwLjQyNDY4MjYxNzE4NzUsInkiOjUyN30seyJ4IjoyMTUuMjg5MDYyNSwieSI6NTY0fSx7IngiOjQyOS44OTg0Mzc1LCJ5Ijo2MDguOTU0NDg1MDE1ODUzNX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M139.703,759L139.703,763.167C139.703,767.333,139.703,775.667,139.703,786C139.703,796.333,139.703,808.667,139.703,820.333C139.703,832,139.703,843,139.703,848.5L139.703,854" id="L_G_J_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_G_J_0" data-points="W3sieCI6MTM5LjcwMzEyNSwieSI6NzU5fSx7IngiOjEzOS43MDMxMjUsInkiOjc4NH0seyJ4IjoxMzkuNzAzMTI1LCJ5Ijo4MjF9LHsieCI6MTM5LjcwMzEyNSwieSI6ODU4fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M258.261,527L269.998,533.167C281.734,539.333,305.207,551.667,371.795,566.473C438.383,581.279,548.087,598.557,602.939,607.196L657.791,615.836" id="L_E_K_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E_K_0" data-points="W3sieCI6MjU4LjI2MTM1MjUzOTA2MjUsInkiOjUyN30seyJ4IjozMjguNjc5Njg3NSwieSI6NTY0fSx7IngiOjY2MS43NDIxODc1LCJ5Ijo2MTYuNDU4MDQ4MTQyNzM2M31d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" data-id="L_A_B_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_B_C_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_C_D_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_D_E_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_E_F_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_F_G_0" transform="translate(0, 0)"></g></g><g class="edgeLabel" transform="translate(300.88671875, 228)"><g class="label" transform="translate(-43.4375, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Verify Token</text></g></g><g class="edgeLabel" transform="translate(304.33092, 582.65171)"><g class="label" transform="translate(-55.5859375, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Get Credentials</text></g></g><g class="edgeLabel" transform="translate(139.703125, 821)"><g class="label" transform="translate(-55.140625, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Encrypted Data</text></g></g><g class="edgeLabel" transform="translate(455.92172, 584.04089)"><g class="label" transform="translate(-37.8046875, -12)"><text x="0" y="0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 12px; fill: #333;">Audit Logs</text></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-0" transform="translate(247.0078125, 60)"><rect class="basic label-container" style="fill:#e3f2fd !important" x="-76.6875" y="-27" width="153.375" height="54"/><g class="label" style="" transform="translate(-46.6875, -12)"><text x="46.6875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">API Gateway</text></g></g><g class="node default" id="flowchart-B-1" transform="translate(247.0078125, 164)"><rect class="basic label-container" style="fill:#f3e5f5 !important" x="-89.5859375" y="-27" width="179.171875" height="54"/><g class="label" style="" transform="translate(-59.5859375, -12)"><text x="59.5859375" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Auth Middleware</text></g></g><g class="node default" id="flowchart-C-3" transform="translate(206.875, 292)"><rect class="basic label-container" style="" x="-73.125" y="-27" width="146.25" height="54"/><g class="label" style="" transform="translate(-43.125, -12)"><text x="43.125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Rate Limiter</text></g></g><g class="node default" id="flowchart-D-5" transform="translate(206.875, 396)"><rect class="basic label-container" style="" x="-81" y="-27" width="162" height="54"/><g class="label" style="" transform="translate(-51, -12)"><text x="51.0" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Input Validator</text></g></g><g class="node default" id="flowchart-E-7" transform="translate(206.875, 500)"><rect class="basic label-container" style="fill:#e8f5e9 !important" x="-83.8125" y="-27" width="167.625" height="54"/><g class="label" style="" transform="translate(-53.8125, -12)"><text x="53.8125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Business Logic</text></g></g><g class="node default" id="flowchart-F-9" transform="translate(139.703125, 628)"><rect class="basic label-container" style="" x="-96.703125" y="-27" width="193.40625" height="54"/><g class="label" style="" transform="translate(-66.703125, -12)"><text x="66.703125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Data Access Layer</text></g></g><g class="node default" id="flowchart-G-11" transform="translate(139.703125, 732)"><rect class="basic label-container" style="fill:#fff3e0 !important" x="-90.03125" y="-27" width="180.0625" height="54"/><g class="label" style="" transform="translate(-60.03125, -12)"><text x="60.03125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Encryption Layer</text></g></g><g class="node default" id="flowchart-H-13" transform="translate(509.3984375, 292)"><rect class="basic label-container" style="" x="-79.5" y="-27" width="159" height="54"/><g class="label" style="" transform="translate(-49.5, -12)"><text x="49.5" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">JWT Validator</text></g></g><g class="node default" id="flowchart-I-15" transform="translate(520.8203125, 628)"><rect class="basic label-container" style="fill:#f48fb1 !important" x="-90.921875" y="-27" width="181.84375" height="54"/><g class="label" style="" transform="translate(-60.921875, -12)"><text x="60.921875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Secrets Manager</text></g></g><g class="node default" id="flowchart-J-17" transform="translate(139.703125, 892.8007965087891)"><path d="M0,10.200532780819891 a43.078125,10.200532780819891 0,0,0 86.15625,0 a43.078125,10.200532780819891 0,0,0 -86.15625,0 l0,49.20053278081989 a43.078125,10.200532780819891 0,0,0 86.15625,0 l0,-49.20053278081989" class="basic label-container" style="fill:#ffab91 !important" transform="translate(-43.078125, -34.80079917122984)"/><g class="label" style="" transform="translate(-35.578125, -2)"><text x="35.578125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">MongoDB</text></g></g><g class="node default" id="flowchart-K-19" transform="translate(735.0234375, 628)"><rect class="basic label-container" style="fill:#80deea !important" x="-73.28125" y="-27" width="146.5625" height="54"/><g class="label" style="" transform="translate(-43.28125, -12)"><text x="43.28125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">CloudWatch</text></g></g></g></g></g></svg>
</div>
<hr />
<h2 id="database-security-design">Database Security Design</h2>
<h3 id="mongodb-security-configuration">MongoDB Security
Configuration</h3>
<div class="sourceCode" id="cb6"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mongodb_security</span><span class="kw">:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">authentication</span><span class="kw">:</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">mechanism</span><span class="kw">:</span><span class="at"> SCRAM-SHA-256</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">users</span><span class="kw">:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">username</span><span class="kw">:</span><span class="at"> securaa_app</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">database</span><span class="kw">:</span><span class="at"> admin</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">roles</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">readWrite on mssp_core</span><span class="kw">]</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">password</span><span class="kw">:</span><span class="at"> Stored in AWS Secrets Manager</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">username</span><span class="kw">:</span><span class="at"> securaa_readonly</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">database</span><span class="kw">:</span><span class="at"> admin</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">roles</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">read on mssp_core</span><span class="kw">]</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">password</span><span class="kw">:</span><span class="at"> Stored in AWS Secrets Manager</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">authorization</span><span class="kw">:</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">role_based_access</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">encryption</span><span class="kw">:</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">at_rest</span><span class="kw">:</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">method</span><span class="kw">:</span><span class="at"> AES-256</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">key_management</span><span class="kw">:</span><span class="at"> AWS KMS</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">in_transit</span><span class="kw">:</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">tls_mode</span><span class="kw">:</span><span class="at"> requireTLS</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">certificate_key_file</span><span class="kw">:</span><span class="at"> /etc/ssl/mongodb.pem</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">ca_file</span><span class="kw">:</span><span class="at"> /etc/ssl/ca.pem</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">network_security</span><span class="kw">:</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">bind_ip</span><span class="kw">:</span><span class="at"> 127.0.0.1,10.0.1.0/24</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">27017</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">firewall_rules</span><span class="kw">:</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> allow from zona_services subnet</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> deny all others</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">auditing</span><span class="kw">:</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">log_level</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;auditLog&quot;</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">events</span><span class="kw">:</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> authentication</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> authorization</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> DDL operations</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> DML operations on sensitive collections</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">destination</span><span class="kw">:</span><span class="at"> CloudWatch Logs</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">backup</span><span class="kw">:</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">frequency</span><span class="kw">:</span><span class="at"> Daily</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">retention</span><span class="kw">:</span><span class="at"> 30 days</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">encryption</span><span class="kw">:</span><span class="at"> Enabled</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">location</span><span class="kw">:</span><span class="at"> S3 with encryption</span></span></code></pre></div>
<h3 id="data-schema-security">Data Schema Security</h3>
<div class="sourceCode" id="cb7"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">// MongoDB schema with built-in security</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> <span class="st">&quot;integrations&quot;</span><span class="op">,</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">validator</span><span class="op">:</span> {</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">$jsonSchema</span><span class="op">:</span> {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">bsonType</span><span class="op">:</span> <span class="st">&quot;object&quot;</span><span class="op">,</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">required</span><span class="op">:</span> [<span class="st">&quot;tenant_id&quot;</span><span class="op">,</span> <span class="st">&quot;integration_type&quot;</span><span class="op">,</span> <span class="st">&quot;created_by&quot;</span>]<span class="op">,</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">properties</span><span class="op">:</span> {</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tenant_id</span><span class="op">:</span> {</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>          <span class="dt">bsonType</span><span class="op">:</span> <span class="st">&quot;string&quot;</span><span class="op">,</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>          <span class="dt">description</span><span class="op">:</span> <span class="st">&quot;Tenant ID for multi-tenancy isolation&quot;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">integration_type</span><span class="op">:</span> {</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>          <span class="dt">bsonType</span><span class="op">:</span> <span class="st">&quot;string&quot;</span><span class="op">,</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>          <span class="dt">enum</span><span class="op">:</span> [<span class="st">&quot;servicenow&quot;</span><span class="op">,</span> <span class="st">&quot;splunk&quot;</span><span class="op">,</span> <span class="st">&quot;qradar&quot;</span><span class="op">,</span> <span class="op">...</span>]<span class="op">,</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>          <span class="dt">description</span><span class="op">:</span> <span class="st">&quot;Must be a valid integration type&quot;</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">credentials</span><span class="op">:</span> {</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>          <span class="dt">bsonType</span><span class="op">:</span> <span class="st">&quot;string&quot;</span><span class="op">,</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>          <span class="dt">description</span><span class="op">:</span> <span class="st">&quot;Encrypted credentials (AES-256)&quot;</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">api_endpoint</span><span class="op">:</span> {</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>          <span class="dt">bsonType</span><span class="op">:</span> <span class="st">&quot;string&quot;</span><span class="op">,</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>          <span class="dt">pattern</span><span class="op">:</span> <span class="st">&quot;^https://&quot;</span><span class="op">,</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>          <span class="dt">description</span><span class="op">:</span> <span class="st">&quot;Must be HTTPS URL&quot;</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>        <span class="dt">created_by</span><span class="op">:</span> {</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>          <span class="dt">bsonType</span><span class="op">:</span> <span class="st">&quot;string&quot;</span><span class="op">,</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>          <span class="dt">description</span><span class="op">:</span> <span class="st">&quot;User who created the integration&quot;</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">created_at</span><span class="op">:</span> {</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>          <span class="dt">bsonType</span><span class="op">:</span> <span class="st">&quot;date&quot;</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>        <span class="dt">last_modified_at</span><span class="op">:</span> {</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>          <span class="dt">bsonType</span><span class="op">:</span> <span class="st">&quot;date&quot;</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>        <span class="dt">last_modified_by</span><span class="op">:</span> {</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>          <span class="dt">bsonType</span><span class="op">:</span> <span class="st">&quot;string&quot;</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="dt">indexes</span><span class="op">:</span> [</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">tenant_id</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">integration_type</span><span class="op">:</span> <span class="dv">1</span> }<span class="op">,</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">created_at</span><span class="op">:</span> <span class="dv">1</span> }</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<h2 id="aws-infrastructure-security-design">AWS Infrastructure Security
Design</h2>
<h3 id="vpc-architecture">VPC Architecture</h3>
<div class="diagram">
<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 995.742px; background-color: white;" viewBox="0 0 995.7421875 557" role="graphics-document document" aria-roledescription="flowchart-v2"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"><g class="cluster" id="subGraph3" data-look="classic"><rect style="" x="8" y="8" width="979.7421875" height="437"/><g class="cluster-label" transform="translate(414.12890625, 8)"><text x="83.7421875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">AWS VPC - 10.0.0.0/16</text></g></g><g class="cluster" id="subGraph2" data-look="classic"><rect style="" x="28" y="316" width="453.4375" height="104"/><g class="cluster-label" transform="translate(154.71875, 316)"><text x="100.0" y="29.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Database Subnet - 10.0.3.0/24</text></g></g><g class="cluster" id="subGraph1" data-look="classic"><rect style="" x="62.0703125" y="162" width="567.5546875" height="104"/><g class="cluster-label" transform="translate(246.22265625, 162)"><text x="99.625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Private Subnet - 10.0.2.0/24</text></g></g><g class="cluster" id="subGraph0" data-look="classic"><rect style="" x="651.8359375" y="33" width="315.90625" height="387"/><g class="cluster-label" transform="translate(713.2734375, 33)"><text x="96.515625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Public Subnet - 10.0.1.0/24</text></g></g></g><g class="edgePaths"><path d="M886.427,495L890.996,490.833C895.566,486.667,904.705,478.333,909.274,470C913.844,461.667,913.844,453.333,913.844,445C913.844,436.667,913.844,428.333,913.844,415.5C913.844,402.667,913.844,385.333,913.844,368C913.844,350.667,913.844,333.333,913.844,320.5C913.844,307.667,913.844,299.333,913.844,291C913.844,282.667,913.844,274.333,913.844,261.5C913.844,248.667,913.844,231.333,913.844,214C913.844,196.667,913.844,179.333,913.844,166.5C913.844,153.667,913.844,145.333,906.102,137.298C898.361,129.263,882.878,121.525,875.137,117.657L867.396,113.788" id="L_G_A_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_G_A_0" data-points="W3sieCI6ODg2LjQyNjc1NzgxMjUsInkiOjQ5NX0seyJ4Ijo5MTMuODQzNzUsInkiOjQ3MH0seyJ4Ijo5MTMuODQzNzUsInkiOjQ0NX0seyJ4Ijo5MTMuODQzNzUsInkiOjQyMH0seyJ4Ijo5MTMuODQzNzUsInkiOjM2OH0seyJ4Ijo5MTMuODQzNzUsInkiOjMxNn0seyJ4Ijo5MTMuODQzNzUsInkiOjI5MX0seyJ4Ijo5MTMuODQzNzUsInkiOjI2Nn0seyJ4Ijo5MTMuODQzNzUsInkiOjIxNH0seyJ4Ijo5MTMuODQzNzUsInkiOjE2Mn0seyJ4Ijo5MTMuODQzNzUsInkiOjEzN30seyJ4Ijo4NjMuODE3NDU3OTMyNjkyMywieSI6MTEyfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M773.974,112L768.447,116.167C762.92,120.333,751.866,128.667,746.339,137C740.813,145.333,740.813,153.667,679.059,164.616C617.305,175.566,493.797,189.132,432.043,195.915L370.289,202.698" id="L_A_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A_C_0" data-points="W3sieCI6NzczLjk3NDMwODg5NDIzMDcsInkiOjExMn0seyJ4Ijo3NDAuODEyNSwieSI6MTM3fSx7IngiOjc0MC44MTI1LCJ5IjoxNjJ9LHsieCI6MzY2LjMxMjUsInkiOjIwMy4xMzQ1NTg4OTYzMzMyfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M840.412,112L845.137,116.167C849.863,120.333,859.314,128.667,864.04,137C868.766,145.333,868.766,153.667,823.735,164.279C778.705,174.891,688.645,187.781,643.615,194.227L598.585,200.672" id="L_A_D_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A_D_0" data-points="W3sieCI6ODQwLjQxMTUwODQxMzQ2MTUsInkiOjExMn0seyJ4Ijo4NjguNzY1NjI1LCJ5IjoxMzd9LHsieCI6ODY4Ljc2NTYyNSwieSI6MTYyfSx7IngiOjU5NC42MjUsInkiOjIwMS4yMzg3NDI0MTk2ODA4OH1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M356.24,241L369.951,245.167C383.663,249.333,411.085,257.667,477.172,266C543.259,274.333,648.01,282.667,700.386,291C752.762,299.333,752.762,307.667,756.083,315.506C759.404,323.344,766.046,330.689,769.367,334.361L772.688,338.033" id="L_C_B_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_B_0" data-points="W3sieCI6MzU2LjIzOTkzMzg5NDIzMDgsInkiOjI0MX0seyJ4Ijo0MzguNTA3ODEyNSwieSI6MjY2fSx7IngiOjc1Mi43NjE3MTg3NSwieSI6MjkxfSx7IngiOjc1Mi43NjE3MTg3NSwieSI6MzE2fSx7IngiOjc3NS4zNzEwMTg2Mjk4MDc3LCJ5IjozNDF9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M532.509,241L536.682,245.167C540.855,249.333,549.201,257.667,601.586,266C653.97,274.333,750.393,282.667,798.605,291C846.816,299.333,846.816,307.667,843.495,315.506C840.174,323.344,833.532,330.689,830.211,334.361L826.89,338.033" id="L_D_B_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D_B_0" data-points="W3sieCI6NTMyLjUwOTMxNDkwMzg0NjIsInkiOjI0MX0seyJ4Ijo1NTcuNTQ2ODc1LCJ5IjoyNjZ9LHsieCI6ODQ2LjgxNjQwNjI1LCJ5IjoyOTF9LHsieCI6ODQ2LjgxNjQwNjI1LCJ5IjozMTZ9LHsieCI6ODI0LjIwNzEwNjM3MDE5MjMsInkiOjM0MX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M799.789,395L799.789,399.167C799.789,403.333,799.789,411.667,799.789,420C799.789,428.333,799.789,436.667,799.789,445C799.789,453.333,799.789,461.667,803.866,469.551C807.943,477.435,816.097,484.87,820.173,488.587L824.25,492.305" id="L_B_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_G_0" data-points="W3sieCI6Nzk5Ljc4OTA2MjUsInkiOjM5NX0seyJ4Ijo3OTkuNzg5MDYyNSwieSI6NDIwfSx7IngiOjc5OS43ODkwNjI1LCJ5Ijo0NDV9LHsieCI6Nzk5Ljc4OTA2MjUsInkiOjQ3MH0seyJ4Ijo4MjcuMjA2MDU0Njg3NSwieSI6NDk1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M204.434,241L194.718,245.167C185.003,249.333,165.572,257.667,155.856,266C146.141,274.333,146.141,282.667,146.141,291C146.141,299.333,146.141,307.667,146.816,315.345C147.491,323.024,148.842,330.048,149.518,333.56L150.193,337.072" id="L_C_E_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_E_0" data-points="W3sieCI6MjA0LjQzMzg5NDIzMDc2OTIzLCJ5IjoyNDF9LHsieCI6MTQ2LjE0MDYyNSwieSI6MjY2fSx7IngiOjE0Ni4xNDA2MjUsInkiOjI5MX0seyJ4IjoxNDYuMTQwNjI1LCJ5IjozMTZ9LHsieCI6MTUwLjk0ODMxNzMwNzY5MjMyLCJ5IjozNDF9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M416.313,232.473L389.344,238.061C362.375,243.649,308.438,254.824,281.469,264.579C254.5,274.333,254.5,282.667,254.5,291C254.5,299.333,254.5,307.667,247.208,315.688C239.916,323.71,225.332,331.42,218.04,335.275L210.748,339.13" id="L_D_E_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D_E_0" data-points="W3sieCI6NDE2LjMxMjUsInkiOjIzMi40NzI5MTc0NDQ5MDEwMX0seyJ4IjoyNTQuNSwieSI6MjY2fSx7IngiOjI1NC41LCJ5IjoyOTF9LHsieCI6MjU0LjUsInkiOjMxNn0seyJ4IjoyMDcuMjExODM4OTQyMzA3NjgsInkiOjM0MX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M322.153,241L330.604,245.167C339.055,249.333,355.957,257.667,364.408,266C372.859,274.333,372.859,282.667,372.859,291C372.859,299.333,372.859,307.667,372.859,315.333C372.859,323,372.859,330,372.859,333.5L372.859,337" id="L_C_F_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_F_0" data-points="W3sieCI6MzIyLjE1MzI0NTE5MjMwNzcsInkiOjI0MX0seyJ4IjozNzIuODU5Mzc1LCJ5IjoyNjZ9LHsieCI6MzcyLjg1OTM3NSwieSI6MjkxfSx7IngiOjM3Mi44NTkzNzUsInkiOjMxNn0seyJ4IjozNzIuODU5Mzc1LCJ5IjozNDF9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" data-id="L_G_A_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_A_C_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_A_D_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_C_B_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_D_B_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_B_G_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_C_E_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_D_E_0" transform="translate(0, 0)"></g></g><g class="edgeLabel"><g class="label" data-id="L_C_F_0" transform="translate(0, 0)"></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-0" transform="translate(809.7890625, 85)"><rect class="basic label-container" style="fill:#ff9800 !important" x="-122.953125" y="-27" width="245.90625" height="54"/><g class="label" style="" transform="translate(-92.953125, -12)"><text x="92.953125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Application Load Balancer</text></g></g><g class="node default" id="flowchart-B-1" transform="translate(799.7890625, 368)"><rect class="basic label-container" style="" x="-79.0546875" y="-27" width="158.109375" height="54"/><g class="label" style="" transform="translate(-49.0546875, -12)"><text x="49.0546875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">NAT Gateway</text></g></g><g class="node default" id="flowchart-C-2" transform="translate(267.390625, 214)"><rect class="basic label-container" style="fill:#4caf50 !important" x="-98.921875" y="-27" width="197.84375" height="54"/><g class="label" style="" transform="translate(-68.921875, -12)"><text x="68.921875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">zona_services EC2</text></g></g><g class="node default" id="flowchart-D-3" transform="translate(505.46875, 214)"><rect class="basic label-container" style="" x="-89.15625" y="-27" width="178.3125" height="54"/><g class="label" style="" transform="translate(-59.15625, -12)"><text x="59.15625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">zona_batch EC2</text></g></g><g class="node default" id="flowchart-E-4" transform="translate(156.140625, 368)"><rect class="basic label-container" style="fill:#f44336 !important" x="-93.140625" y="-27" width="186.28125" height="54"/><g class="label" style="" transform="translate(-63.140625, -12)"><text x="63.140625" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">MongoDB Cluster</text></g></g><g class="node default" id="flowchart-F-5" transform="translate(372.859375, 368)"><rect class="basic label-container" style="" x="-73.578125" y="-27" width="147.15625" height="54"/><g class="label" style="" transform="translate(-43.578125, -12)"><text x="43.578125" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">PostgreSQL</text></g></g><g class="node default" id="flowchart-G-6" transform="translate(856.81640625, 522)"><rect class="basic label-container" style="" x="-90.921875" y="-27" width="181.84375" height="54"/><g class="label" style="" transform="translate(-60.921875, -12)"><text x="60.921875" y="17.0" text-anchor="middle" dominant-baseline="middle" style="font-family: trebuchet ms, verdana, arial, sans-serif; font-size: 14px; fill: #333;">Internet Gateway</text></g></g></g></g></g></svg>
</div>
<h3 id="security-groups-design">Security Groups Design</h3>
<div class="sourceCode" id="cb8"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">security_groups</span><span class="kw">:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">alb_sg</span><span class="kw">:</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;securaa-alb-sg&quot;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Application Load Balancer security group&quot;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">inbound_rules</span><span class="kw">:</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">443</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">source</span><span class="kw">:</span><span class="at"> 0.0.0.0/0</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;HTTPS from internet&quot;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">source</span><span class="kw">:</span><span class="at"> 0.0.0.0/0</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;HTTP (redirect to HTTPS)&quot;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">outbound_rules</span><span class="kw">:</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">destination</span><span class="kw">:</span><span class="at"> app_sg</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;To application servers&quot;</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app_sg</span><span class="kw">:</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;securaa-app-sg&quot;</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Application servers security group&quot;</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">inbound_rules</span><span class="kw">:</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">8080</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">source</span><span class="kw">:</span><span class="at"> alb_sg</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;From load balancer&quot;</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">22</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">source</span><span class="kw">:</span><span class="at"> bastion_sg</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;SSH from bastion only&quot;</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">outbound_rules</span><span class="kw">:</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">27017</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">destination</span><span class="kw">:</span><span class="at"> db_sg</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;To MongoDB&quot;</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">5432</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">destination</span><span class="kw">:</span><span class="at"> db_sg</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;To PostgreSQL&quot;</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">443</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">destination</span><span class="kw">:</span><span class="at"> 0.0.0.0/0</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;HTTPS to external APIs&quot;</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">db_sg</span><span class="kw">:</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;securaa-db-sg&quot;</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Database servers security group&quot;</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">inbound_rules</span><span class="kw">:</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">27017</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">source</span><span class="kw">:</span><span class="at"> app_sg</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;MongoDB from app servers&quot;</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">5432</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">source</span><span class="kw">:</span><span class="at"> app_sg</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;PostgreSQL from app servers&quot;</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">outbound_rules</span><span class="kw">:</span><span class="at"> </span><span class="kw">[]</span></span></code></pre></div>
<h3 id="iam-security-design">IAM Security Design</h3>
<h4 id="service-roles">Service Roles</h4>
<div class="sourceCode" id="cb9"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iam_roles</span><span class="kw">:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">codebuild_role</span><span class="kw">:</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;SecuraaCodeBuildRole&quot;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Role for AWS CodeBuild to build and push images&quot;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">assume_role_policy</span><span class="kw">:</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">service</span><span class="kw">:</span><span class="at"> codebuild.amazonaws.com</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">policies</span><span class="kw">:</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;SecuraaCodeBuildPolicy&quot;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">permissions</span><span class="kw">:</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">ECR</span><span class="kw">:</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> ecr:GetAuthorizationToken</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> ecr:BatchCheckLayerAvailability</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> ecr:PutImage</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> ecr:InitiateLayerUpload</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> ecr:UploadLayerPart</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> ecr:CompleteLayerUpload</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">S3</span><span class="kw">:</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> s3:GetObject</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> s3:PutObject</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;arn:aws:s3:::securaa-build-artifacts/*&quot;</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">CloudWatch</span><span class="kw">:</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> logs:CreateLogGroup</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> logs:CreateLogStream</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> logs:PutLogEvents</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">SecretsManager</span><span class="kw">:</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> secretsmanager:GetSecretValue</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;arn:aws:secretsmanager:*:*:secret:securaa/*&quot;</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ec2_app_role</span><span class="kw">:</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;SecuraaEC2AppRole&quot;</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Role for EC2 application instances&quot;</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">assume_role_policy</span><span class="kw">:</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">service</span><span class="kw">:</span><span class="at"> ec2.amazonaws.com</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">policies</span><span class="kw">:</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;SecuraaAppPolicy&quot;</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">permissions</span><span class="kw">:</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">ECR</span><span class="kw">:</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> ecr:GetAuthorizationToken</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> ecr:BatchGetImage</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> ecr:GetDownloadUrlForLayer</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">SecretsManager</span><span class="kw">:</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> secretsmanager:GetSecretValue</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;arn:aws:secretsmanager:*:*:secret:securaa/prod/*&quot;</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">CloudWatch</span><span class="kw">:</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> logs:CreateLogGroup</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> logs:CreateLogStream</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> logs:PutLogEvents</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> cloudwatch:PutMetricData</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">S3</span><span class="kw">:</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> s3:GetObject</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;arn:aws:s3:::securaa-config/*&quot;</span></span></code></pre></div>
<h4 id="iam-policies---least-privilege">IAM Policies - Least
Privilege</h4>
<div class="sourceCode" id="cb10"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;Version&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-10-17&quot;</span><span class="fu">,</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;Statement&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Sid&quot;</span><span class="fu">:</span> <span class="st">&quot;AllowECRPushForCodeBuild&quot;</span><span class="fu">,</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Effect&quot;</span><span class="fu">:</span> <span class="st">&quot;Allow&quot;</span><span class="fu">,</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Action&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:GetAuthorizationToken&quot;</span><span class="ot">,</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:BatchCheckLayerAvailability&quot;</span><span class="ot">,</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:PutImage&quot;</span><span class="ot">,</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:InitiateLayerUpload&quot;</span><span class="ot">,</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:UploadLayerPart&quot;</span><span class="ot">,</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ecr:CompleteLayerUpload&quot;</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Resource&quot;</span><span class="fu">:</span> <span class="st">&quot;arn:aws:ecr:us-east-2:665853670667:repository/securaa/*&quot;</span><span class="fu">,</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Condition&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;StringEquals&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;aws:RequestedRegion&quot;</span><span class="fu">:</span> <span class="st">&quot;us-east-2&quot;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Sid&quot;</span><span class="fu">:</span> <span class="st">&quot;DenyUnencryptedS3Uploads&quot;</span><span class="fu">,</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Effect&quot;</span><span class="fu">:</span> <span class="st">&quot;Deny&quot;</span><span class="fu">,</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Action&quot;</span><span class="fu">:</span> <span class="st">&quot;s3:PutObject&quot;</span><span class="fu">,</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Resource&quot;</span><span class="fu">:</span> <span class="st">&quot;arn:aws:s3:::securaa-*/*&quot;</span><span class="fu">,</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;Condition&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;StringNotEquals&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;s3:x-amz-server-side-encryption&quot;</span><span class="fu">:</span> <span class="st">&quot;AES256&quot;</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<hr />
<h2 id="api-security-design">API Security Design</h2>
<h3 id="api-security-controls">API Security Controls</h3>
<div class="sourceCode" id="cb11"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">api_security</span><span class="kw">:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">endpoint</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;/api/v1/integrations&quot;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">authentication</span><span class="kw">:</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">methods</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">JWT</span><span class="kw">,</span><span class="at"> API_KEY</span><span class="kw">]</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">location</span><span class="kw">:</span><span class="at"> Header &quot;Authorization&quot;</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">authorization</span><span class="kw">:</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">permissions</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">&quot;integration:read&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;integration:create&quot;</span><span class="kw">]</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">input_validation</span><span class="kw">:</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">content_type</span><span class="kw">:</span><span class="at"> application/json</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">max_body_size</span><span class="kw">:</span><span class="at"> 10MB</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">schema_validation</span><span class="kw">:</span><span class="at"> OpenAPI 3.0 spec</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">sanitization</span><span class="kw">:</span><span class="at"> HTML entity encoding</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">rate_limiting</span><span class="kw">:</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">authenticated</span><span class="kw">:</span><span class="at"> 1000 requests/hour</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">unauthenticated</span><span class="kw">:</span><span class="at"> 100 requests/hour</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">burst</span><span class="kw">:</span><span class="at"> 50 requests/minute</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">output_encoding</span><span class="kw">:</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">response_type</span><span class="kw">:</span><span class="at"> application/json</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">encoding</span><span class="kw">:</span><span class="at"> UTF-8</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">sanitization</span><span class="kw">:</span><span class="at"> Remove sensitive fields</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">security_headers</span><span class="kw">:</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">Content-Security-Policy</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;default-src &#39;self&#39;&quot;</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">X-Content-Type-Options</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;nosniff&quot;</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">X-Frame-Options</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;DENY&quot;</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">X-XSS-Protection</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;1; mode=block&quot;</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">Strict-Transport-Security</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;max-age=31536000; includeSubDomains&quot;</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">error_handling</span><span class="kw">:</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">mode</span><span class="kw">:</span><span class="at"> Generic messages</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">status_codes</span><span class="kw">:</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">authentication_failure</span><span class="kw">:</span><span class="at"> </span><span class="dv">401</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">authorization_failure</span><span class="kw">:</span><span class="at"> </span><span class="dv">403</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">validation_failure</span><span class="kw">:</span><span class="at"> </span><span class="dv">400</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">server_error</span><span class="kw">:</span><span class="at"> </span><span class="dv">500</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">error_response</span><span class="kw">:</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">format</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;{&quot;error&quot;: &quot;message&quot;, &quot;code&quot;: &quot;ERROR_CODE&quot;}&#39;</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">no_stack_traces</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">no_sensitive_info</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">logging</span><span class="kw">:</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">log_requests</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">log_responses</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">log_errors</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">sanitize_logs</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fields</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">timestamp</span><span class="kw">,</span><span class="at"> user_id</span><span class="kw">,</span><span class="at"> endpoint</span><span class="kw">,</span><span class="at"> method</span><span class="kw">,</span><span class="at"> status_code</span><span class="kw">]</span></span></code></pre></div>
<h3 id="api-versioning-strategy">API Versioning Strategy</h3>
<div class="sourceCode" id="cb12"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">versioning</span><span class="kw">:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">strategy</span><span class="kw">:</span><span class="at"> URI versioning</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">format</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;/api/v{major}/resource&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">examples</span><span class="kw">:</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;/api/v1/integrations&quot;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;/api/v2/integrations&quot;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">deprecation_policy</span><span class="kw">:</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">notification_period</span><span class="kw">:</span><span class="at"> 6 months</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">support_period</span><span class="kw">:</span><span class="at"> 12 months after deprecation</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">sunset_date</span><span class="kw">:</span><span class="at"> Announced in headers</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">header</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Sunset: Sat, 01 Jan 2026 00:00:00 GMT&quot;</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">breaking_changes</span><span class="kw">:</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">major_version_bump</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">backwards_compatibility</span><span class="kw">:</span><span class="at"> Not required</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">non_breaking_changes</span><span class="kw">:</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">minor_version</span><span class="kw">:</span><span class="at"> Not reflected in URI</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">examples</span><span class="kw">:</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Adding optional fields</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Adding new endpoints</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Adding new response fields</span></span></code></pre></div>
<hr />
<h2 id="container-security-design">Container Security Design</h2>
<h3 id="docker-image-security">Docker Image Security</h3>
<div class="sourceCode" id="cb13"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Secure Dockerfile example</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> golang:1.17-alpine <span class="kw">AS</span> builder</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Run as non-root user</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">addgroup</span> <span class="at">-S</span> appgroup <span class="kw">&amp;&amp;</span> <span class="ex">adduser</span> <span class="at">-S</span> appuser <span class="at">-G</span> appgroup</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Use specific versions</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="kw">WORKDIR</span> /app</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> go.mod go.sum ./</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">go</span> mod download <span class="kw">&amp;&amp;</span> <span class="ex">go</span> mod verify</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Build application</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> . .</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="va">CGO_ENABLED</span><span class="op">=</span>0 <span class="va">GOOS</span><span class="op">=</span>linux <span class="ex">go</span> build <span class="at">-a</span> <span class="at">-installsuffix</span> cgo <span class="at">-o</span> main .</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Final stage - minimal image</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> alpine:3.18</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Install security updates</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">apk</span> <span class="at">--no-cache</span> add ca-certificates <span class="kw">&amp;&amp;</span> <span class="dt">\</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="ex">apk</span> <span class="at">--no-cache</span> upgrade</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Run as non-root user</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">addgroup</span> <span class="at">-S</span> appgroup <span class="kw">&amp;&amp;</span> <span class="ex">adduser</span> <span class="at">-S</span> appuser <span class="at">-G</span> appgroup</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="kw">USER</span> appuser</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="kw">WORKDIR</span> /home/appuser</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy binary from builder</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> <span class="op">--from=builder</span> <span class="op">--chown=appuser:appgroup</span> /app/main .</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Use specific port (non-privileged)</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPOSE</span> 8080</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Security: Define health check</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="kw">HEALTHCHECK</span> <span class="op">--interval=30s</span> <span class="op">--timeout=3s</span> <span class="op">--start-period=5s</span> <span class="op">--retries=3</span> \</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  <span class="kw">CMD</span> <span class="fu">wget</span> <span class="at">--no-verbose</span> <span class="at">--tries</span><span class="op">=</span>1 <span class="at">--spider</span> http://localhost:8080/health <span class="kw">||</span> <span class="bu">exit</span> 1</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Run application</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;./main&quot;</span>]</span></code></pre></div>
<h3 id="container-runtime-security">Container Runtime Security</h3>
<div class="sourceCode" id="cb14"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">container_security</span><span class="kw">:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">image_scanning</span><span class="kw">:</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tool</span><span class="kw">:</span><span class="at"> AWS ECR Image Scanning</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">on_push</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">severity_threshold</span><span class="kw">:</span><span class="at"> HIGH</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fail_on_critical</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">image_signing</span><span class="kw">:</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tool</span><span class="kw">:</span><span class="at"> Docker Content Trust</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">key_management</span><span class="kw">:</span><span class="at"> AWS KMS</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">runtime_security</span><span class="kw">:</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">read_only_root_filesystem</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">no_new_privileges</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">drop_capabilities</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">ALL</span><span class="kw">]</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">add_capabilities</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">NET_BIND_SERVICE</span><span class="kw">]</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">resource_limits</span><span class="kw">:</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> 2GB</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="fl">1.0</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">pids_limit</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">network_security</span><span class="kw">:</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">network_mode</span><span class="kw">:</span><span class="at"> bridge</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port_mapping</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;8080:8080&quot;</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">expose_only_necessary_ports</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div>
<hr />
<h2 id="security-design-review-checklist">Security Design Review
Checklist</h2>
<h3 id="architecture-review">Architecture Review</h3>
<ul class="task-list">
<li><label><input
type="checkbox" /><strong>Authentication</strong></label>
<ul class="task-list">
<li><label><input type="checkbox" />Authentication mechanism defined and
secure</label></li>
<li><label><input type="checkbox" />Token/session management
designed</label></li>
<li><label><input type="checkbox" />MFA requirements
identified</label></li>
<li><label><input type="checkbox" />Password policy defined (if
applicable)</label></li>
</ul></li>
<li><label><input
type="checkbox" /><strong>Authorization</strong></label>
<ul class="task-list">
<li><label><input type="checkbox" />Authorization model defined
(RBAC/ABAC)</label></li>
<li><label><input type="checkbox" />Permissions and roles
documented</label></li>
<li><label><input type="checkbox" />Least privilege principle
applied</label></li>
<li><label><input type="checkbox" />Authorization enforcement points
identified</label></li>
</ul></li>
<li><label><input type="checkbox" /><strong>Data
Protection</strong></label>
<ul class="task-list">
<li><label><input type="checkbox" />Sensitive data identified and
classified</label></li>
<li><label><input type="checkbox" />Encryption at rest designed
(AES-256+)</label></li>
<li><label><input type="checkbox" />Encryption in transit designed (TLS
1.3)</label></li>
<li><label><input type="checkbox" />Key management strategy
defined</label></li>
<li><label><input type="checkbox" />Data masking strategy
defined</label></li>
</ul></li>
<li><label><input type="checkbox" /><strong>Input
Validation</strong></label>
<ul class="task-list">
<li><label><input type="checkbox" />Input validation rules
defined</label></li>
<li><label><input type="checkbox" />Sanitization approach
documented</label></li>
<li><label><input type="checkbox" />File upload security designed (if
applicable)</label></li>
<li><label><input type="checkbox" />Output encoding strategy
defined</label></li>
</ul></li>
<li><label><input type="checkbox" /><strong>API
Security</strong></label>
<ul class="task-list">
<li><label><input type="checkbox" />API authentication
designed</label></li>
<li><label><input type="checkbox" />API authorization
designed</label></li>
<li><label><input type="checkbox" />Rate limiting strategy
defined</label></li>
<li><label><input type="checkbox" />API versioning strategy
defined</label></li>
<li><label><input type="checkbox" />Security headers
defined</label></li>
</ul></li>
<li><label><input type="checkbox" /><strong>Database
Security</strong></label>
<ul class="task-list">
<li><label><input type="checkbox" />Database authentication
designed</label></li>
<li><label><input type="checkbox" />Database authorization
designed</label></li>
<li><label><input type="checkbox" />Database encryption
designed</label></li>
<li><label><input type="checkbox" />Backup strategy defined</label></li>
<li><label><input type="checkbox" />SQL/NoSQL injection
prevention</label></li>
</ul></li>
<li><label><input type="checkbox" /><strong>Infrastructure
Security</strong></label>
<ul class="task-list">
<li><label><input type="checkbox" />Network segmentation
designed</label></li>
<li><label><input type="checkbox" />Security groups/firewalls
defined</label></li>
<li><label><input type="checkbox" />IAM roles and policies
designed</label></li>
<li><label><input type="checkbox" />Secrets management
designed</label></li>
<li><label><input type="checkbox" />Container security
designed</label></li>
</ul></li>
<li><label><input type="checkbox" /><strong>Logging &amp;
Monitoring</strong></label>
<ul class="task-list">
<li><label><input type="checkbox" />Security events logging
designed</label></li>
<li><label><input type="checkbox" />Log retention policy
defined</label></li>
<li><label><input type="checkbox" />Monitoring and alerting
designed</label></li>
<li><label><input type="checkbox" />SIEM integration
designed</label></li>
</ul></li>
</ul>
<h3 id="threat-model-validation">Threat Model Validation</h3>
<ul class="task-list">
<li><label><input type="checkbox" />All threats from Requirements Phase
addressed</label></li>
<li><label><input type="checkbox" />Mitigations designed for
high/critical threats</label></li>
<li><label><input type="checkbox" />Residual risks documented and
accepted</label></li>
<li><label><input type="checkbox" />New threats identified during design
addressed</label></li>
</ul>
<h3 id="compliance-validation">Compliance Validation</h3>
<ul class="task-list">
<li><label><input type="checkbox" />SOC 2 controls addressed in
design</label></li>
<li><label><input type="checkbox" />ISO 27001 controls addressed in
design</label></li>
<li><label><input type="checkbox" />GDPR requirements addressed in
design</label></li>
<li><label><input type="checkbox" />Industry-specific compliance
addressed</label></li>
</ul>
<hr />
<h2 id="design-phase-deliverables">Design Phase Deliverables</h2>
<h3 id="required-documentation">Required Documentation</h3>
<ol type="1">
<li><strong>Architecture Diagram</strong>
<ul>
<li>Component diagram</li>
<li>Data flow diagram</li>
<li>Network diagram</li>
<li>Deployment diagram</li>
</ul></li>
<li><strong>Security Design Document</strong>
<ul>
<li>Authentication design</li>
<li>Authorization design</li>
<li>Data protection design</li>
<li>API security design</li>
<li>Infrastructure security design</li>
</ul></li>
<li><strong>Database Design</strong>
<ul>
<li>Schema design with security</li>
<li>Access control design</li>
<li>Encryption design</li>
<li>Backup and recovery design</li>
</ul></li>
<li><strong>API Specification</strong>
<ul>
<li>OpenAPI 3.0 specification</li>
<li>Security requirements per endpoint</li>
<li>Authentication/authorization requirements</li>
<li>Rate limiting specifications</li>
</ul></li>
<li><strong>Threat Model Update</strong>
<ul>
<li>Updated threat model based on design</li>
<li>New threats identified</li>
<li>Mitigation strategies</li>
<li>Residual risks</li>
</ul></li>
<li><strong>Security Test Plan</strong>
<ul>
<li>SAST test cases</li>
<li>DAST test cases</li>
<li>Penetration testing scope</li>
<li>Security acceptance tests</li>
</ul></li>
</ol>
<hr />
<h2 id="phase-exit-criteria">Phase Exit Criteria</h2>
<p>The Design Phase is complete when:</p>
<ol type="1">
<li>✅ <strong>Architecture diagrams are complete and
approved</strong></li>
<li>✅ <strong>Security design document is complete</strong></li>
<li>✅ <strong>All security controls are defined and
documented</strong></li>
<li>✅ <strong>Threat model is updated with design-level
threats</strong></li>
<li>✅ <strong>Security review completed by security team</strong></li>
<li>✅ <strong>Database design includes security controls</strong></li>
<li>✅ <strong>API security specifications are documented</strong></li>
<li>✅ <strong>Infrastructure security design is complete</strong></li>
<li>✅ <strong>Security test plan is created</strong></li>
<li>✅ <strong>Security team has approved the design</strong></li>
</ol>
<hr />
<h2 id="next-phase">Next Phase</h2>
<p>Once all exit criteria are met, proceed to <strong><a
href="04_Development_Phase.md">04_Development_Phase.md</a></strong> for
secure coding and development.</p>
<hr />
<p><em>This document is part of the SECURAA Secure SDLC documentation
suite. For questions, contact security@securaa.com</em></p>

</body>
</html>