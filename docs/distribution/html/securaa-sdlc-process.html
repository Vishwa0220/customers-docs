<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Securaa Sdlc Process</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 30px;
            background-color: #fff;
        }

        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-top: 40px;
        }

        h2 {
            color: #34495e;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
            margin-top: 30px;
        }

        h3, h4, h5, h6 {
            color: #7f8c8d;
            margin-top: 20px;
        }

        code {
            background-color: #f7f9fc;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
        }

        pre {
            background-color: #2d3436;
            color: #dfe6e9;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.85em;
        }

        pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            font-size: 0.9em;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 10px 12px;
            text-align: left;
        }

        th {
            background-color: #3498db;
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        blockquote {
            border-left: 4px solid #3498db;
            margin: 20px 0;
            padding: 10px 20px;
            background-color: #ecf0f1;
            font-style: italic;
        }

        a {
            color: #3498db;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .diagram {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background-color: #fafafa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow-x: auto;
        }

        .diagram svg {
            max-width: 100%;
            height: auto;
        }

        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }

        ul, ol {
            padding-left: 25px;
        }

        li {
            margin-bottom: 5px;
        }

        hr {
            border: none;
            border-top: 2px solid #ecf0f1;
            margin: 30px 0;
        }

        #TOC {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
        }

        #TOC ul {
            list-style-type: none;
            padding-left: 0;
        }

        #TOC li {
            padding: 3px 0;
        }

        .header-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            margin: -30px -30px 30px -30px;
            text-align: center;
        }

        .header-section h1 {
            color: white;
            border: none;
            margin: 0;
        }

        .header-section p {
            margin: 10px 0 0 0;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="header-section">
        <h1>Securaa Sdlc Process</h1>
        <p>SECURAA Security Documentation</p>
    </div>
    <h1 id="securaa-complete-secure-sdlc-process-documentation">SECURAA
Complete Secure SDLC Process Documentation</h1>
<h2
id="comprehensive-production-ready-sdlc-for-securaa-soar-platform">Comprehensive
Production-Ready SDLC for SECURAA SOAR Platform</h2>
<hr />
<h2 id="document-control">Document Control</h2>
<table>
<thead>
<tr class="header">
<th><strong>Attribute</strong></th>
<th><strong>Value</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Document Title</strong></td>
<td>SECURAA Complete Secure SDLC Process</td>
</tr>
<tr class="even">
<td><strong>Document ID</strong></td>
<td>SECURAA-SDLC-MASTER-001</td>
</tr>
<tr class="odd">
<td><strong>Version</strong></td>
<td>2.0</td>
</tr>
<tr class="even">
<td><strong>Date</strong></td>
<td>November 13, 2025</td>
</tr>
<tr class="odd">
<td><strong>Classification</strong></td>
<td>Customer-Facing - Confidential</td>
</tr>
<tr class="even">
<td><strong>Owner</strong></td>
<td>Engineering &amp; Security Team</td>
</tr>
<tr class="odd">
<td><strong>Status</strong></td>
<td>Published</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="table-of-contents">Table of Contents</h2>
<ol type="1">
<li><a href="#executive-summary">Executive Summary</a></li>
<li><a href="#technology-stack">Technology Stack</a></li>
<li><a href="#repository-structure">Repository Structure</a></li>
<li><a href="#phase-1-requirements--planning">Phase 1: Requirements
&amp; Planning</a></li>
<li><a href="#phase-2-secure-design">Phase 2: Secure Design</a></li>
<li><a href="#phase-3-secure-development">Phase 3: Secure
Development</a></li>
<li><a href="#phase-4-security-testing">Phase 4: Security
Testing</a></li>
<li><a href="#phase-5-build--deployment">Phase 5: Build &amp;
Deployment</a></li>
<li><a href="#phase-6-operations--monitoring">Phase 6: Operations &amp;
Monitoring</a></li>
<li><a href="#phase-7-cicd-security-pipeline">Phase 7: CI/CD Security
Pipeline</a></li>
</ol>
<hr />
<h2 id="executive-summary">Executive Summary</h2>
<p>This document describes the complete Secure Software Development
Lifecycle (SDLC) implemented for the SECURAA Security Orchestration,
Automation and Response (SOAR) platform. The SDLC integrates security at
every phase from requirements gathering through production
operations.</p>
<h3 id="platform-overview">Platform Overview</h3>
<p><strong>SECURAA</strong> is an enterprise SOAR platform with: -
<strong>530+ Microservices</strong> in the zona_services repository -
<strong>722+ Third-Party Integrations</strong> in the integrations
repository - <strong>9 Primary Repositories</strong> managed via AWS
CodeCommit - <strong>Containerized Deployment</strong> using Docker and
AWS ECR - <strong>AWS Infrastructure</strong> with CodeBuild, ECR, IAM,
CloudWatch</p>
<h3 id="sdlc-workflow">SDLC Workflow</h3>
<div class="diagram">
<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 709.656px; background-color: white;" viewBox="0 0 709.65625 694" role="graphics-document document" aria-roledescription="flowchart-v2">
<style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style>
<g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path d="M477.01,62L460.972,66.167C444.934,70.333,412.858,78.667,396.819,86.333C380.781,94,380.781,101,380.781,104.5L380.781,108" id="L_A_B_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A_B_0" data-points="W3sieCI6NDc3LjAxMDIxNjM0NjE1MzgsInkiOjYyfSx7IngiOjM4MC43ODEyNSwieSI6ODd9LHsieCI6MzgwLjc4MTI1LCJ5IjoxMTJ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M380.781,166L380.781,170.167C380.781,174.333,380.781,182.667,380.781,190.333C380.781,198,380.781,205,380.781,208.5L380.781,212" id="L_B_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_C_0" data-points="W3sieCI6MzgwLjc4MTI1LCJ5IjoxNjZ9LHsieCI6MzgwLjc4MTI1LCJ5IjoxOTF9LHsieCI6MzgwLjc4MTI1LCJ5IjoyMTZ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M276.07,266.022L254.103,270.851C232.135,275.681,188.201,285.341,166.233,293.67C144.266,302,144.266,309,144.266,312.5L144.266,316" id="L_C_D_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_D_0" data-points="W3sieCI6Mjc2LjA3MDMxMjUsInkiOjI2Ni4wMjE2MDI2OTUzODIxN30seyJ4IjoxNDQuMjY1NjI1LCJ5IjoyOTV9LHsieCI6MTQ0LjI2NTYyNSwieSI6MzIwfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M139.073,374L138.272,378.167C137.471,382.333,135.868,390.667,135.067,398.333C134.266,406,134.266,413,134.266,416.5L134.266,420" id="L_D_E_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D_E_0" data-points="W3sieCI6MTM5LjA3MzMxNzMwNzY5MjMyLCJ5IjozNzR9LHsieCI6MTM0LjI2NTYyNSwieSI6Mzk5fSx7IngiOjEzNC4yNjU2MjUsInkiOjQyNH1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M129.073,478L128.272,482.167C127.471,486.333,125.868,494.667,125.067,502.333C124.266,510,124.266,517,124.266,520.5L124.266,524" id="L_E_F_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E_F_0" data-points="W3sieCI6MTI5LjA3MzMxNzMwNzY5MjMyLCJ5Ijo0Nzh9LHsieCI6MTI0LjI2NTYyNSwieSI6NTAzfSx7IngiOjEyNC4yNjU2MjUsInkiOjUyOH1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M124.266,582L124.266,586.167C124.266,590.333,124.266,598.667,146.245,607.312C168.223,615.958,212.181,624.916,234.16,629.394L256.139,633.873" id="L_F_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_F_G_0" data-points="W3sieCI6MTI0LjI2NTYyNSwieSI6NTgyfSx7IngiOjEyNC4yNjU2MjUsInkiOjYwN30seyJ4IjoyNjAuMDU4NTkzNzUsInkiOjYzNC42NzIwMzk4MDA5OTV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M484.064,632L500.21,627.833C516.355,623.667,548.646,615.333,564.792,602.5C580.938,589.667,580.938,572.333,580.938,555C580.938,537.667,580.938,520.333,580.938,503C580.938,485.667,580.938,468.333,580.938,451C580.938,433.667,580.938,416.333,580.938,399C580.938,381.667,580.938,364.333,580.938,347C580.938,329.667,580.938,312.333,580.938,295C580.938,277.667,580.938,260.333,580.938,243C580.938,225.667,580.938,208.333,580.938,191C580.938,173.667,580.938,156.333,580.938,139C580.938,121.667,580.938,104.333,580.938,92.167C580.938,80,580.938,73,580.938,69.5L580.938,66" id="L_G_A_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_G_A_0" data-points="W3sieCI6NDg0LjA2NDM3ODAwNDgwNzcsInkiOjYzMn0seyJ4Ijo1ODAuOTM3NSwieSI6NjA3fSx7IngiOjU4MC45Mzc1LCJ5Ijo1NTV9LHsieCI6NTgwLjkzNzUsInkiOjUwM30seyJ4Ijo1ODAuOTM3NSwieSI6NDUxfSx7IngiOjU4MC45Mzc1LCJ5IjozOTl9LHsieCI6NTgwLjkzNzUsInkiOjM0N30seyJ4Ijo1ODAuOTM3NSwieSI6Mjk1fSx7IngiOjU4MC45Mzc1LCJ5IjoyNDN9LHsieCI6NTgwLjkzNzUsInkiOjE5MX0seyJ4Ijo1ODAuOTM3NSwieSI6MTM5fSx7IngiOjU4MC45Mzc1LCJ5Ijo4N30seyJ4Ijo1ODAuOTM3NSwieSI6NjJ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M333.371,270L326.055,274.167C318.738,278.333,304.105,286.667,303.97,294.685C303.835,302.703,318.197,310.406,325.379,314.258L332.56,318.109" id="L_C_H_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_H_0" data-points="W3sieCI6MzMzLjM3MTAxODYyOTgwNzcsInkiOjI3MH0seyJ4IjoyODkuNDcyNjU2MjUsInkiOjI5NX0seyJ4IjozMzYuMDg0NzM1NTc2OTIzMSwieSI6MzIwfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M410.46,320L414.17,315.833C417.879,311.667,425.297,303.333,425.316,295.472C425.334,287.61,417.954,280.22,414.264,276.525L410.573,272.83" id="L_H_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_H_C_0" data-points="W3sieCI6NDEwLjQ2MDQ4Njc3ODg0NjEzLCJ5IjozMjB9LHsieCI6NDMyLjcxNDg0Mzc1LCJ5IjoyOTV9LHsieCI6NDA3Ljc0Njc2OTgzMTczMDgsInkiOjI3MH1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M211.538,374L221.92,378.167C232.302,382.333,253.065,390.667,275.892,398.798C298.718,406.929,323.608,414.857,336.054,418.822L348.499,422.786" id="L_D_I_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D_I_0" data-points="W3sieCI6MjExLjUzODQ2MTUzODQ2MTU1LCJ5IjozNzR9LHsieCI6MjczLjgyODEyNSwieSI6Mzk5fSx7IngiOjM1Mi4zMDk5NDU5MTM0NjE1NSwieSI6NDI0fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M469.228,424L474.191,419.833C479.153,415.667,489.079,407.333,494.041,394.5C499.004,381.667,499.004,364.333,499.004,347C499.004,329.667,499.004,312.333,490.141,299.768C481.278,287.203,463.553,279.407,454.69,275.509L445.828,271.61" id="L_I_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_I_C_0" data-points="W3sieCI6NDY5LjIyODE0MDAyNDAzODQ1LCJ5Ijo0MjR9LHsieCI6NDk5LjAwMzkwNjI1LCJ5IjozOTl9LHsieCI6NDk5LjAwMzkwNjI1LCJ5IjozNDd9LHsieCI6NDk5LjAwMzkwNjI1LCJ5IjoyOTV9LHsieCI6NDQyLjE2NjA5MDc0NTE5MjMsInkiOjI3MH1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M203.463,478L214.142,482.167C224.821,486.333,246.178,494.667,266.12,502.741C286.061,510.815,304.588,518.63,313.851,522.538L323.114,526.445" id="L_E_J_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E_J_0" data-points="W3sieCI6MjAzLjQ2MzI2NjIyNTk2MTU1LCJ5Ijo0Nzh9LHsieCI6MjY3LjUzNTE1NjI1LCJ5Ijo1MDN9LHsieCI6MzI2Ljc5OTM1Mzk2NjM0NjIsInkiOjUyOH1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M421.038,528L425.703,523.833C430.369,519.667,439.7,511.333,409.272,501.369C378.844,491.405,308.657,479.81,273.563,474.012L238.47,468.215" id="L_J_E_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_J_E_0" data-points="W3sieCI6NDIxLjAzNzcxMDMzNjUzODQ1LCJ5Ijo1Mjh9LHsieCI6NDQ5LjAzMTI1LCJ5Ijo1MDN9LHsieCI6MjM0LjUyMzQzNzUsInkiOjQ2Ny41NjI4MTk1NTgyMDMwNX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" data-id="L_A_B_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_B_C_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_C_D_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_D_E_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_E_F_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_F_G_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_G_A_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_C_H_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_H_C_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_D_I_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_I_C_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_E_J_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_J_E_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-0" transform="translate(580.9375, 35)"><rect class="basic label-container" style="fill:#e3f2fd !important" x="-120.71875" y="-27" width="241.4375" height="54"/><g class="label" style="" transform="translate(-90.71875, -12)"><rect/><foreignObject width="181.4375" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Requirements &amp; Planning
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-B-1" transform="translate(380.78125, 139)"><rect class="basic label-container" style="fill:#f3e5f5 !important" x="-82.4765625" y="-27" width="164.953125" height="54"/><g class="label" style="" transform="translate(-52.4765625, -12)"><rect/><foreignObject width="104.953125" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Secure Design
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-C-3" transform="translate(380.78125, 243)"><rect class="basic label-container" style="fill:#e8f5e9 !important" x="-104.7109375" y="-27" width="209.421875" height="54"/><g class="label" style="" transform="translate(-74.7109375, -12)"><rect/><foreignObject width="149.421875" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Secure Development
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-D-5" transform="translate(144.265625, 347)"><rect class="basic label-container" style="fill:#fff3e0 !important" x="-86.328125" y="-27" width="172.65625" height="54"/><g class="label" style="" transform="translate(-56.328125, -12)"><rect/><foreignObject width="112.65625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Security Testing
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-E-7" transform="translate(134.265625, 451)"><rect class="basic label-container" style="fill:#fce4ec !important" x="-100.2578125" y="-27" width="200.515625" height="54"/><g class="label" style="" transform="translate(-70.2578125, -12)"><rect/><foreignObject width="140.515625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Build &amp; Deployment
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-F-9" transform="translate(124.265625, 555)"><rect class="basic label-container" style="fill:#e0f2f1 !important" x="-116.265625" y="-27" width="232.53125" height="54"/><g class="label" style="" transform="translate(-86.265625, -12)"><rect/><foreignObject width="172.53125" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Operations &amp; Monitoring
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-G-11" transform="translate(379.44140625, 659)"><rect class="basic label-container" style="" x="-119.3828125" y="-27" width="238.765625" height="54"/><g class="label" style="" transform="translate(-89.3828125, -12)"><rect/><foreignObject width="178.765625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Continuous Improvement
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-H-15" transform="translate(386.42578125, 347)"><rect class="basic label-container" style="" x="-77.578125" y="-27" width="155.15625" height="54"/><g class="label" style="" transform="translate(-47.578125, -12)"><rect/><foreignObject width="95.15625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Code Review
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-I-19" transform="translate(437.0703125, 451)"><rect class="basic label-container" style="" x="-108.8671875" y="-27" width="217.734375" height="54"/><g class="label" style="" transform="translate(-78.8671875, -12)"><rect/><foreignObject width="157.734375" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Vulnerability Scanning
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-J-23" transform="translate(390.8046875, 555)"><rect class="basic label-container" style="" x="-100.2734375" y="-27" width="200.546875" height="54"/><g class="label" style="" transform="translate(-70.2734375, -12)"><rect/><foreignObject width="140.546875" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Container Scanning
</p>
</span>
</div>
</foreignObject></g></g></g></g></g>
</svg>
</div>
<hr />
<h2 id="technology-stack">Technology Stack</h2>
<h3 id="programming-languages">Programming Languages</h3>
<table>
<colgroup>
<col style="width: 22%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr class="header">
<th>Language</th>
<th>Purpose</th>
<th>Version</th>
<th>Files/Services</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Go</strong></td>
<td>Backend microservices, APIs</td>
<td>1.17+</td>
<td>530+ services in zona_services</td>
</tr>
<tr class="even">
<td><strong>JavaScript/React</strong></td>
<td>Frontend UI</td>
<td>React 18.2+</td>
<td>zonareact repository</td>
</tr>
<tr class="odd">
<td><strong>Python</strong></td>
<td>Batch processing, integrations</td>
<td>3.8+</td>
<td>zona_batch, integrations</td>
</tr>
<tr class="even">
<td><strong>Shell</strong></td>
<td>Build automation, deployment</td>
<td>Bash</td>
<td>build_securaa scripts</td>
</tr>
</tbody>
</table>
<h3 id="infrastructure-components">Infrastructure Components</h3>
<p><strong>AWS Services in Use:</strong> - <strong>AWS
CodeCommit</strong> - Git repositories (9 repositories) - <strong>AWS
CodeBuild</strong> - CI/CD pipeline automation - <strong>Amazon
ECR</strong> - Docker image registry
(665853670667.dkr.ecr.us-east-2.amazonaws.com) - <strong>Amazon
EC2</strong> - Application hosting - <strong>AWS IAM</strong> - Access
control and permissions - <strong>AWS CloudWatch</strong> - Logging and
monitoring - <strong>AWS Secrets Manager</strong> - Credential
storage</p>
<p><strong>Databases:</strong> - <strong>MongoDB 7.0</strong> - Primary
database (mssp_core database) - <strong>PostgreSQL</strong> - Relational
data - <strong>InfluxDB</strong> - Time-series metrics</p>
<p><strong>Container Platform:</strong> - <strong>Docker</strong> -
Containerization - <strong>AWS ECR</strong> - Image registry -
<strong>Docker Compose</strong> - Local development</p>
<hr />
<h2 id="repository-structure">Repository Structure</h2>
<p>SECURAA’s codebase is organized across 9 specialized repositories in
AWS CodeCommit:</p>
<h3 id="build_securaa-repository">1. build_securaa Repository</h3>
<p><strong>Purpose</strong>: Build automation and deployment</p>
<p><strong>Key Components:</strong></p>
<pre><code>build_securaa/
├── build_securaa.sh              # Main build orchestration script
├── aws_codebuild/
│   ├── Core_BuildSpec.yaml       # Core services build (zona_services, zona_batch)
│   ├── Wrapper_BuildSpec.yaml    # Integration services build  
│   └── UI_BuildSpec.yaml         # Frontend build
├── core_scripts/
│   ├── functions_aws.sh          # AWS-specific build functions
│   ├── functions.sh              # General build functions
│   ├── securaa_ecr_login.sh      # ECR authentication
│   └── docker_ecr_login.sh       # Docker ECR login
├── deployment_scripts/           # Deployment automation
├── pkg/                          # RPM package specifications
└── securaa/                      # Core application code</code></pre>
<p><strong>Build Options</strong> (from build_securaa.sh): -
<code>-i</code> Make core Docker images - <code>-w</code> Make wrapper
(integration) images - <code>-u</code> Make UI build - <code>-r</code>
Make RPM packages - <code>-a</code> Binary and zip export -
<code>-c</code> Checkout all repos - <code>-s</code> Scan repositories -
<code>-b</code> Make batch images</p>
<p><strong>Build Process:</strong></p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./build_securaa.sh</span> <span class="st">&quot;-vi&quot;</span> <span class="va">$dev_image</span> rpm_mssp_complete 0001 <span class="va">$dev_image</span></span></code></pre></div>
<h3 id="zona_services-repository">2. zona_services Repository</h3>
<p><strong>Purpose</strong>: Core microservices (530+ services)</p>
<p><strong>Service Categories:</strong></p>
<pre><code>zona_services/
├── zona_user/                    # User management service
├── zona_integrations/            # Integration orchestration
├── zona_siem/                    # SIEM connector service
├── zona_playbook/                # Playbook execution engine
├── zona_querybuilder/            # Query builder service
├── zona_custom/                  # Custom utilities
├── zona_custom_utils/            # Custom utility functions
├── zona_apis_manager/            # API management
├── zona_sshclient/               # SSH client service
├── zona_pdf/                     # PDF generation service
├── zona_primary_server_health_check/  # Health monitoring
├── zona_shard_handler/           # Shard management
└── zona_sia_apis/                # SIA API services</code></pre>
<p>Each service is independently deployable as a Docker container.</p>
<h3 id="securaa-repository">3. securaa Repository</h3>
<p><strong>Purpose</strong>: Core application backend logic</p>
<p><strong>Components:</strong> - Authentication and authorization - API
endpoints - Business logic layer - Database operations - Common
utilities</p>
<h3 id="securaa_lib-repository">4. securaa_lib Repository</h3>
<p><strong>Purpose</strong>: Shared security library</p>
<p><strong>Key Features:</strong> -
<strong>Encryption/Decryption</strong>: AES-256-CBC encryption
implementation - <strong>JWT Token Management</strong>: Token generation
and validation - <strong>Cryptographic Operations</strong>: Secure
crypto functions - <strong>Authentication Helpers</strong>: Common auth
utilities</p>
<p><strong>Encryption Implementation</strong> (from
securaa_lib/utils/encryption.go):</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode go"><code class="sourceCode go"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">// AES-256-CBC Encryption</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">func</span> CredentialsEncryptV2<span class="op">(</span>stringToEncrypt <span class="dt">string</span><span class="op">,</span> key <span class="op">[]</span><span class="dt">byte</span><span class="op">)</span> <span class="op">(</span><span class="dt">string</span><span class="op">,</span> <span class="dt">error</span><span class="op">)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">func</span> CredentialsDecryptV2<span class="op">(</span>encodedData <span class="dt">string</span><span class="op">,</span> key <span class="op">[]</span><span class="dt">byte</span><span class="op">)</span> <span class="op">(</span><span class="dt">string</span><span class="op">,</span> <span class="dt">error</span><span class="op">)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Features:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">// - AES-256-CBC cipher</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">// - Random IV generation</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">// - PKCS7 padding</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">// - Base64 encoding</span></span></code></pre></div>
<h3 id="zona_batch-repository">5. zona_batch Repository</h3>
<p><strong>Purpose</strong>: Background batch processing jobs</p>
<p><strong>Batch Services:</strong></p>
<pre><code>zona_batch/
├── core_process_batch/           # Core data processing
├── csam_connector/               # CSAM integration batch
├── auto_purge_batch/             # Data retention enforcement
├── report_batch/                 # Report generation
├── sbot/                         # Security bot automation
└── sla_breach_monitor_batch/     # SLA monitoring</code></pre>
<h3 id="integrations-repository">6. integrations Repository</h3>
<p><strong>Purpose</strong>: Third-party system integrations (722+
integrations)</p>
<p><strong>Integration Categories:</strong> - <strong>SIEM
Platforms</strong>: Splunk, QRadar, LogRhythm, ArcSight - <strong>Threat
Intelligence</strong>: VirusTotal, AlienVault, ThreatConnect -
<strong>Ticketing Systems</strong>: ServiceNow, Jira, Remedy -
<strong>EDR/Endpoint</strong>: CrowdStrike, Carbon Black, SentinelOne -
<strong>Cloud Security</strong>: AWS Security Hub, Azure Sentinel, GCP
SCC - <strong>Network Security</strong>: Palo Alto, Cisco, Fortinet,
Checkpoint - <strong>Email Security</strong>: Proofpoint, Mimecast,
Microsoft 365 - <strong>Identity</strong>: Active Directory, Okta, Azure
AD</p>
<p><strong>Integration Structure:</strong></p>
<pre><code>integrations/
├── zona_splunk/
├── zona_qradar/
├── zona_servicenow/
├── zona_virustotal/
├── zona_crowdstrike/
├── zona_aws_securityhub/
└── ... (722+ integration modules)</code></pre>
<h3 id="zonareact-repository">7. zonareact Repository</h3>
<p><strong>Purpose</strong>: Frontend React application</p>
<p><strong>Technology:</strong> - React 18.2+ - Redux for state
management - Material-UI components - Chart visualizations - Real-time
updates via WebSockets</p>
<p><strong>Features:</strong> - User interface and dashboards - Case
management UI - Playbook designer - Custom widgets - Report generation
UI</p>
<h3 id="securaa_db-repository">8. securaa_db Repository</h3>
<p><strong>Purpose</strong>: Database schemas and migrations</p>
<p><strong>Contents:</strong> - MongoDB collection schemas - Database
initialization scripts - Migration scripts - Seed data for development -
Database versioning</p>
<p><strong>Primary Database</strong>: <code>mssp_core</code>
(MongoDB)</p>
<h3 id="securaa_pylib-repository">9. securaa_pylib Repository</h3>
<p><strong>Purpose</strong>: Python utility libraries</p>
<p><strong>Components:</strong> - Python utilities for integrations -
Data processing libraries - Helper functions for batch jobs</p>
<hr />
<h2 id="phase-1-requirements-planning">Phase 1: Requirements &amp;
Planning</h2>
<h3 id="objective">Objective</h3>
<p>Define security requirements, assess risks, and model threats before
development begins.</p>
<h3 id="activities">Activities</h3>
<h4 id="security-requirements-gathering">1.1 Security Requirements
Gathering</h4>
<p>Document security requirements for each feature:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">security_requirements</span><span class="kw">:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">authentication</span><span class="kw">:</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Authentication method (JWT, OAuth, API Key)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Session management requirements</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> MFA requirements for sensitive operations</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">authorization</span><span class="kw">:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Role-based access control (RBAC) roles</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Permission model</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Resource access controls</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">data_protection</span><span class="kw">:</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Sensitive data identification</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Encryption requirements (AES-256-CBC as per securaa_lib)</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Data classification levels</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Retention and deletion policies</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">input_validation</span><span class="kw">:</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Input validation rules</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Data type and format requirements</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Size limits</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Sanitization requirements</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">audit_logging</span><span class="kw">:</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Security events to log</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Log retention period (CloudWatch)</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Log format requirements</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> SIEM integration requirements</span></span></code></pre></div>
<h4 id="threat-modeling">1.2 Threat Modeling</h4>
<p>Use STRIDE methodology:</p>
<table>
<colgroup>
<col style="width: 43%" />
<col style="width: 24%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="header">
<th>Threat Category</th>
<th>Example</th>
<th>Mitigation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Spoofing</strong></td>
<td>Fake authentication tokens</td>
<td>JWT signature validation</td>
</tr>
<tr class="even">
<td><strong>Tampering</strong></td>
<td>Modified API requests</td>
<td>Input validation, request signing</td>
</tr>
<tr class="odd">
<td><strong>Repudiation</strong></td>
<td>Deny actions performed</td>
<td>Comprehensive audit logging</td>
</tr>
<tr class="even">
<td><strong>Information Disclosure</strong></td>
<td>Exposed credentials</td>
<td>Encryption with securaa_lib functions</td>
</tr>
<tr class="odd">
<td><strong>Denial of Service</strong></td>
<td>Request flooding</td>
<td>Rate limiting, resource limits</td>
</tr>
<tr class="even">
<td><strong>Elevation of Privilege</strong></td>
<td>Privilege escalation</td>
<td>RBAC enforcement, least privilege</td>
</tr>
</tbody>
</table>
<h4 id="risk-assessment">1.3 Risk Assessment</h4>
<p>Rate risks using DREAD scoring: - <strong>D</strong>amage Potential
(0-10) - <strong>R</strong>eproducibility (0-10) -
<strong>E</strong>xploitability (0-10) - <strong>A</strong>ffected Users
(0-10) - <strong>D</strong>iscoverability (0-10)</p>
<p><strong>Risk Levels:</strong> - <strong>Critical</strong> (40-50):
Immediate action required - <strong>High</strong> (30-39): Fix within 1
week - <strong>Medium</strong> (20-29): Fix within 1 month -
<strong>Low</strong> (0-19): Monitor and reassess</p>
<h3 id="deliverables">Deliverables</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Security requirements
document</label></li>
<li><label><input type="checkbox" />Threat model with STRIDE
analysis</label></li>
<li><label><input type="checkbox" />Risk assessment with DREAD
scoring</label></li>
<li><label><input type="checkbox" />Security acceptance
criteria</label></li>
<li><label><input type="checkbox" />Compliance requirements
mapping</label></li>
</ul>
<hr />
<h2 id="phase-2-secure-design">Phase 2: Secure Design</h2>
<h3 id="objective-1">Objective</h3>
<p>Translate security requirements into technical architecture with
built-in security controls.</p>
<h3 id="activities-1">Activities</h3>
<h4 id="architecture-design">2.1 Architecture Design</h4>
<p><strong>Microservices Architecture:</strong></p>
<div class="diagram">
<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 1323.79px; background-color: white;" viewBox="0 0 1323.7890625 458.09527587890625" role="graphics-document document" aria-roledescription="flowchart-v2">
<style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style>
<g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path d="M442.574,62L442.574,68.167C442.574,74.333,442.574,86.667,442.574,98.333C442.574,110,442.574,121,442.574,126.5L442.574,132" id="L_A_B_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_A_B_0" data-points="W3sieCI6NDQyLjU3NDIxODc1LCJ5Ijo2Mn0seyJ4Ijo0NDIuNTc0MjE4NzUsInkiOjk5fSx7IngiOjQ0Mi41NzQyMTg3NSwieSI6MTM2fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M360.98,175.541L318.193,182.118C275.406,188.694,189.832,201.847,147.045,211.924C104.258,222,104.258,229,104.258,232.5L104.258,236" id="L_B_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_C_0" data-points="W3sieCI6MzYwLjk4MDQ2ODc1LCJ5IjoxNzUuNTQxMTQ0Njg0NzMyNTN9LHsieCI6MTA0LjI1NzgxMjUsInkiOjIxNX0seyJ4IjoxMDQuMjU3ODEyNSwieSI6MjQwfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M524.168,172.416L585.67,179.513C647.172,186.611,770.176,200.805,831.678,211.403C893.18,222,893.18,229,893.18,232.5L893.18,236" id="L_B_D_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_D_0" data-points="W3sieCI6NTI0LjE2Nzk2ODc1LCJ5IjoxNzIuNDE1OTQyMDkxODAzNTd9LHsieCI6ODkzLjE3OTY4NzUsInkiOjIxNX0seyJ4Ijo4OTMuMTc5Njg3NSwieSI6MjQwfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M393.521,190L385.951,194.167C378.381,198.333,363.241,206.667,355.671,214.333C348.102,222,348.102,229,348.102,232.5L348.102,236" id="L_B_E_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_E_0" data-points="W3sieCI6MzkzLjUyMTEwODc3NDAzODQ1LCJ5IjoxOTB9LHsieCI6MzQ4LjEwMTU2MjUsInkiOjIxNX0seyJ4IjozNDguMTAxNTYyNSwieSI6MjQwfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M524.168,188.585L538.208,192.988C552.247,197.39,580.327,206.195,594.367,214.098C608.406,222,608.406,229,608.406,232.5L608.406,236" id="L_B_F_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_B_F_0" data-points="W3sieCI6NTI0LjE2Nzk2ODc1LCJ5IjoxODguNTg1Mzc2NzY5NjA0MDR9LHsieCI6NjA4LjQwNjI1LCJ5IjoyMTV9LHsieCI6NjA4LjQwNjI1LCJ5IjoyNDB9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M104.258,294L104.258,300.167C104.258,306.333,104.258,318.667,105.673,330.373C107.088,342.079,109.919,353.158,111.334,358.697L112.749,364.236" id="L_C_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_G_0" data-points="W3sieCI6MTA0LjI1NzgxMjUsInkiOjI5NH0seyJ4IjoxMDQuMjU3ODEyNSwieSI6MzMxfSx7IngiOjExMy43MzkyMDAzNzAyNzUwNywieSI6MzY4LjExMTkzODg1MTQ1MjJ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M771.125,278.711L680.301,287.426C589.477,296.141,407.828,313.57,309.463,328.57C211.098,343.569,196.016,356.138,188.475,362.422L180.934,368.706" id="L_D_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D_G_0" data-points="W3sieCI6NzcxLjEyNSwieSI6Mjc4LjcxMTM5NDMwMjg0ODZ9LHsieCI6MjI2LjE3OTY4NzUsInkiOjMzMX0seyJ4IjoxNzcuODYxNjQ2MDMyOTY1NCwieSI6MzcxLjI2NzMxNzYzNzU0Njh9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M305.103,294L295.283,300.167C285.462,306.333,265.821,318.667,246.906,331.445C227.992,344.223,209.804,357.446,200.71,364.058L191.616,370.669" id="L_E_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E_G_0" data-points="W3sieCI6MzA1LjEwMzI3MTQ4NDM3NSwieSI6Mjk0fSx7IngiOjI0Ni4xNzk2ODc1LCJ5IjozMzF9LHsieCI6MTg4LjM4MDI1ODE2MjY5MDMyLCJ5IjozNzMuMDIxMjk3MjU1MjMzODN9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M514.719,294L493.321,300.167C471.923,306.333,429.128,318.667,378.76,333.461C328.392,348.255,270.453,365.51,241.483,374.137L212.513,382.765" id="L_F_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_F_G_0" data-points="W3sieCI6NTE0LjcxODY4ODk2NDg0MzgsInkiOjI5NH0seyJ4IjozODYuMzMyMDMxMjUsInkiOjMzMX0seyJ4IjoyMDguNjc5Njg3NSwieSI6MzgzLjkwNjE4NTIyMzQzNzE1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M925.687,294L933.112,300.167C940.536,306.333,955.385,318.667,962.81,332.675C970.234,346.683,970.234,362.365,970.234,370.206L970.234,378.048" id="L_D_H_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D_H_0" data-points="W3sieCI6OTI1LjY4NzEzMzc4OTA2MjUsInkiOjI5NH0seyJ4Ijo5NzAuMjM0Mzc1LCJ5IjozMzF9LHsieCI6OTcwLjIzNDM3NSwieSI6MzgyLjA0NzY0NTU2ODg0NzY2fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M200.516,281.817L253.77,290.014C307.025,298.211,413.534,314.606,484.467,331.029C555.4,347.453,590.757,363.907,608.436,372.133L626.114,380.36" id="L_C_I_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C_I_0" data-points="W3sieCI6MjAwLjUxNTYyNSwieSI6MjgxLjgxNjU0NjI1NTY3MjE2fSx7IngiOjUyMC4wNDI5Njg3NSwieSI6MzMxfSx7IngiOjYyOS43NDA2Njk5NzkxNTE2LCJ5IjozODIuMDQ3NjQ1NTY4ODQ3NjZ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M771.125,291.531L738.395,298.109C705.665,304.687,640.206,317.844,619.247,332.551C598.289,347.258,621.831,363.516,633.602,371.646L645.373,379.775" id="L_D_I_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D_I_0" data-points="W3sieCI6NzcxLjEyNSwieSI6MjkxLjUzMTAxNzMwODg0ODJ9LHsieCI6NTc0Ljc0NjA5Mzc1LCJ5IjozMzF9LHsieCI6NjQ4LjY2NDgwNzQ2MjU0NDYsInkiOjM4Mi4wNDc2NDU1Njg4NDc2Nn1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M445.688,284.918L487.518,292.598C529.348,300.278,613.008,315.639,653.943,331.165C694.877,346.691,693.087,362.382,692.192,370.228L691.296,378.073" id="L_E_I_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E_I_0" data-points="W3sieCI6NDQ1LjY4NzUsInkiOjI4NC45MTc2NzYxOTYwMjYxNX0seyJ4Ijo2OTYuNjY3OTY4NzUsInkiOjMzMX0seyJ4Ijo2OTAuODQyNzY5NDExMzkyMiwieSI6MzgyLjA0NzY0NTU2ODg0NzY2fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M712.089,294L735.769,300.167C759.45,306.333,806.811,318.667,812.955,333.058C819.098,347.45,784.025,363.899,766.488,372.124L748.952,380.349" id="L_F_I_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_F_I_0" data-points="W3sieCI6NzEyLjA4ODYyMzA0Njg3NSwieSI6Mjk0fSx7IngiOjg1NC4xNzE4NzUsInkiOjMzMX0seyJ4Ijo3NDUuMzMwMDY5Mjg3NzA1MiwieSI6MzgyLjA0NzY0NTU2ODg0NzY2fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1015.234,290.645L1049.953,297.371C1084.672,304.097,1154.109,317.548,1188.828,332.115C1223.547,346.683,1223.547,362.365,1223.547,370.206L1223.547,378.048" id="L_D_J_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_D_J_0" data-points="W3sieCI6MTAxNS4yMzQzNzUsInkiOjI5MC42NDQ5MDI2ODg3Njk2fSx7IngiOjEyMjMuNTQ2ODc1LCJ5IjozMzF9LHsieCI6MTIyMy41NDY4NzUsInkiOjM4Mi4wNDc2NDU1Njg4NDc2Nn1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(442.57421875, 99)"><g class="label" data-id="L_A_B_0" transform="translate(-26.2265625, -12)"><foreignObject width="52.453125" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
HTTPS
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_B_C_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_B_D_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_B_E_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_B_F_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_C_G_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_D_G_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_E_G_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_F_G_0" transform="translate(0, 0)"><foreignObject width="0" height="0">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel"></span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(970.234375, 331)"><g class="label" data-id="L_D_H_0" transform="translate(-78.7109375, -12)"><foreignObject width="157.421875" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Encrypted Credentials
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(520.04296875, 331)"><g class="label" data-id="L_C_I_0" transform="translate(-17.3515625, -12)"><foreignObject width="34.703125" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Logs
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(628.9, 320.11594)"><g class="label" data-id="L_D_I_0" transform="translate(-17.3515625, -12)"><foreignObject width="34.703125" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Logs
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(696.66796875, 331)"><g class="label" data-id="L_E_I_0" transform="translate(-17.3515625, -12)"><foreignObject width="34.703125" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Logs
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(841.29934, 327.64785)"><g class="label" data-id="L_F_I_0" transform="translate(-17.3515625, -12)"><foreignObject width="34.703125" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Logs
</p>
</span>
</div>
</foreignObject></g></g><g class="edgeLabel" transform="translate(1223.546875, 331)"><g class="label" data-id="L_D_J_0" transform="translate(-57.8125, -12)"><foreignObject width="115.625" height="24">
<div class="labelBkg" data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="edgeLabel">
<p>
Integration Calls
</p>
</span>
</div>
</foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-0" transform="translate(442.57421875, 35)"><rect class="basic label-container" style="" x="-69.5703125" y="-27" width="139.140625" height="54"/><g class="label" style="" transform="translate(-39.5703125, -12)"><rect/><foreignObject width="79.140625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
User/Client
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-B-1" transform="translate(442.57421875, 163)"><rect class="basic label-container" style="fill:#ff9800 !important" x="-81.59375" y="-27" width="163.1875" height="54"/><g class="label" style="" transform="translate(-51.59375, -12)"><rect/><foreignObject width="103.1875" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
Load Balancer
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-C-3" transform="translate(104.2578125, 267)"><rect class="basic label-container" style="" x="-96.2578125" y="-27" width="192.515625" height="54"/><g class="label" style="" transform="translate(-66.2578125, -12)"><rect/><foreignObject width="132.515625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
zona_user Service
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-D-5" transform="translate(893.1796875, 267)"><rect class="basic label-container" style="" x="-122.0546875" y="-27" width="244.109375" height="54"/><g class="label" style="" transform="translate(-92.0546875, -12)"><rect/><foreignObject width="184.109375" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
zona_integrations Service
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-E-7" transform="translate(348.1015625, 267)"><rect class="basic label-container" style="" x="-97.5859375" y="-27" width="195.171875" height="54"/><g class="label" style="" transform="translate(-67.5859375, -12)"><rect/><foreignObject width="135.171875" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
zona_siem Service
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-F-9" transform="translate(608.40625, 267)"><rect class="basic label-container" style="" x="-112.71875" y="-27" width="225.4375" height="54"/><g class="label" style="" transform="translate(-82.71875, -12)"><rect/><foreignObject width="165.4375" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
zona_playbook Service
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-G-11" transform="translate(124.2578125, 409.04764556884766)"><path d="M0,14.365096245878975 a84.421875,14.365096245878975 0,0,0 168.84375,0 a84.421875,14.365096245878975 0,0,0 -168.84375,0 l0,53.36509624587897 a84.421875,14.365096245878975 0,0,0 168.84375,0 l0,-53.36509624587897" class="basic label-container" style="fill:#4caf50 !important" transform="translate(-84.421875, -41.04764436881846)"/><g class="label" style="" transform="translate(-76.921875, -2)"><rect/><foreignObject width="153.84375" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
MongoDB mssp_core
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-H-19" transform="translate(970.234375, 409.04764556884766)"><rect class="basic label-container" style="fill:#e91e63 !important" x="-111.0703125" y="-27" width="222.140625" height="54"/><g class="label" style="" transform="translate(-81.0703125, -12)"><rect/><foreignObject width="162.140625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
AWS Secrets Manager
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-I-21" transform="translate(687.76171875, 409.04764556884766)"><rect class="basic label-container" style="fill:#2196f3 !important" x="-73.28125" y="-27" width="146.5625" height="54"/><g class="label" style="" transform="translate(-43.28125, -12)"><rect/><foreignObject width="86.5625" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
CloudWatch
</p>
</span>
</div>
</foreignObject></g></g><g class="node default" id="flowchart-J-29" transform="translate(1223.546875, 409.04764556884766)"><rect class="basic label-container" style="" x="-92.2421875" y="-27" width="184.484375" height="54"/><g class="label" style="" transform="translate(-62.2421875, -12)"><rect/><foreignObject width="124.484375" height="24">
<div data-xmlns="http://www.w3.org/1999/xhtml"
style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;">
<span class="nodeLabel">
<p>
External Systems
</p>
</span>
</div>
</foreignObject></g></g></g></g></g>
</svg>
</div>
<h4 id="security-controls-design">2.2 Security Controls Design</h4>
<p><strong>Authentication Design:</strong></p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">authentication</span><span class="kw">:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">primary_method</span><span class="kw">:</span><span class="at"> JWT</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">algorithm</span><span class="kw">:</span><span class="at"> HS256</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">token_expiry</span><span class="kw">:</span><span class="at"> 3600 seconds</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">refresh_token_expiry</span><span class="kw">:</span><span class="at"> 604800 seconds</span><span class="co">  # 7 days</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">secret_storage</span><span class="kw">:</span><span class="at"> AWS Secrets Manager</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">api_key_method</span><span class="kw">:</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">format</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;securaa_api_[32_char_random]&quot;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">storage</span><span class="kw">:</span><span class="at"> Hashed with bcrypt</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">mfa</span><span class="kw">:</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">methods</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">TOTP</span><span class="kw">,</span><span class="at"> SMS</span><span class="kw">,</span><span class="at"> Email</span><span class="kw">]</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">required_for</span><span class="kw">:</span><span class="at"> Administrative operations</span></span></code></pre></div>
<p><strong>Authorization Design:</strong></p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">authorization</span><span class="kw">:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">model</span><span class="kw">:</span><span class="at"> Role-Based Access Control (RBAC)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">roles</span><span class="kw">:</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">admin</span><span class="kw">:</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Full system access</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> User management</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Configuration changes</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">analyst</span><span class="kw">:</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Case management</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Integration execution</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Report access</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">viewer</span><span class="kw">:</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Read-only access</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Report viewing</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">enforcement</span><span class="kw">:</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Middleware layer authorization</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Per-endpoint permission checks</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> API-level authorization</span></span></code></pre></div>
<p><strong>Data Protection Design:</strong></p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">encryption</span><span class="kw">:</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">at_rest</span><span class="kw">:</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">algorithm</span><span class="kw">:</span><span class="at"> AES-256-CBC</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> securaa_lib.CredentialsEncryptV2()</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">key_storage</span><span class="kw">:</span><span class="at"> AWS Secrets Manager</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">encrypted_fields</span><span class="kw">:</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> integration_credentials</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> api_tokens</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> user_passwords (bcrypt)</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> sensitive_case_data</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">in_transit</span><span class="kw">:</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TLS 1.2+</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">certificate_provider</span><span class="kw">:</span><span class="at"> AWS Certificate Manager</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enforce_https</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div>
<h4 id="database-security-design">2.3 Database Security Design</h4>
<p><strong>MongoDB Configuration:</strong></p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mongodb</span><span class="kw">:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">database</span><span class="kw">:</span><span class="at"> mssp_core</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">authentication</span><span class="kw">:</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">enabled</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">mechanism</span><span class="kw">:</span><span class="at"> SCRAM-SHA-256</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">authorization</span><span class="kw">:</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">role_based</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">users</span><span class="kw">:</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">securaa_app</span><span class="kw">:</span><span class="at"> readWrite access</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">securaa_readonly</span><span class="kw">:</span><span class="at"> read access</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">network</span><span class="kw">:</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">bind_ip</span><span class="kw">:</span><span class="at"> Private subnet only</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">27017</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">collections</span><span class="kw">:</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> integrations</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> cases</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> playbooks</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> users</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> audit_logs</span></span></code></pre></div>
<h4 id="aws-infrastructure-design">2.4 AWS Infrastructure Design</h4>
<p><strong>VPC Architecture:</strong></p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vpc</span><span class="kw">:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">cidr</span><span class="kw">:</span><span class="at"> 10.0.0.0/16</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">subnets</span><span class="kw">:</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">public</span><span class="kw">:</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cidr</span><span class="kw">:</span><span class="at"> 10.0.1.0/24</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">components</span><span class="kw">:</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Application Load Balancer</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> NAT Gateway</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">private</span><span class="kw">:</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cidr</span><span class="kw">:</span><span class="at"> 10.0.2.0/24</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">components</span><span class="kw">:</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> EC2 instances (zona_services)</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Application containers</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">database</span><span class="kw">:</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">cidr</span><span class="kw">:</span><span class="at"> 10.0.3.0/24</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">components</span><span class="kw">:</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> MongoDB cluster</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> PostgreSQL</span></span></code></pre></div>
<p><strong>Security Groups:</strong></p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">security_groups</span><span class="kw">:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">alb_sg</span><span class="kw">:</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">inbound</span><span class="kw">:</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> 443, source: 0.0.0.0/0 (HTTPS)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> 80, source: 0.0.0.0/0 (HTTP redirect)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">outbound</span><span class="kw">:</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> 8080, destination: app_sg</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">app_sg</span><span class="kw">:</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">inbound</span><span class="kw">:</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> 8080, source: alb_sg</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> 22, source: bastion_sg (SSH)</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">outbound</span><span class="kw">:</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> 27017, destination: db_sg (MongoDB)</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> 443, destination: 0.0.0.0/0 (External APIs)</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">db_sg</span><span class="kw">:</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">inbound</span><span class="kw">:</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">port</span><span class="kw">:</span><span class="at"> 27017, source: app_sg (MongoDB)</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">outbound</span><span class="kw">:</span><span class="at"> </span><span class="kw">[]</span></span></code></pre></div>
<p><strong>IAM Roles and Policies:</strong></p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iam_roles</span><span class="kw">:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">SecuraaCodeBuildRole</span><span class="kw">:</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">purpose</span><span class="kw">:</span><span class="at"> AWS CodeBuild service role</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">permissions</span><span class="kw">:</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ecr:GetAuthorizationToken</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ecr:BatchCheckLayerAvailability</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ecr:PutImage</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ecr:InitiateLayerUpload</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ecr:UploadLayerPart</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ecr:CompleteLayerUpload</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> s3:GetObject</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> s3:PutObject (securaa-artifacts bucket)</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> logs:CreateLogGroup</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> logs:CreateLogStream</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> logs:PutLogEvents</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> secretsmanager:GetSecretValue (securaa/* secrets)</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">SecuraaEC2AppRole</span><span class="kw">:</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">purpose</span><span class="kw">:</span><span class="at"> EC2 application instances</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">permissions</span><span class="kw">:</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ecr:GetAuthorizationToken</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ecr:BatchGetImage</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ecr:GetDownloadUrlForLayer</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> secretsmanager:GetSecretValue (securaa/prod/*)</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> logs:CreateLogGroup</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> logs:CreateLogStream</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> logs:PutLogEvents</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cloudwatch:PutMetricData</span></span></code></pre></div>
<h3 id="deliverables-1">Deliverables</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Architecture diagrams (component,
data flow, network)</label></li>
<li><label><input type="checkbox" />Security controls
specification</label></li>
<li><label><input type="checkbox" />Database security
design</label></li>
<li><label><input type="checkbox" />API security
specifications</label></li>
<li><label><input type="checkbox" />Infrastructure security
design</label></li>
<li><label><input type="checkbox" />IAM policies and roles</label></li>
<li><label><input type="checkbox" />Security design review
approval</label></li>
</ul>
<hr />
<h2 id="phase-3-secure-development">Phase 3: Secure Development</h2>
<h3 id="objective-2">Objective</h3>
<p>Implement secure code following secure coding standards with Git
workflow on AWS CodeCommit.</p>
<h3 id="activities-2">Activities</h3>
<h4 id="aws-codecommit-setup">3.1 AWS CodeCommit Setup</h4>
<p><strong>Repository Access:</strong></p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">codecommit_repositories</span><span class="kw">:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> build_securaa</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> zona_services</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> securaa</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> securaa_lib</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> zona_batch</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> integrations</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> zonareact</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> securaa_db</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> securaa_pylib</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">authentication</span><span class="kw">:</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">methods</span><span class="kw">:</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> HTTPS with Git credentials</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> SSH keys</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> AWS CLI with IAM credentials</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">mfa_required</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="fu">iam_policy</span><span class="kw">:</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">read_permissions</span><span class="kw">:</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> codecommit:GetRepository</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> codecommit:GetBranch</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> codecommit:GitPull</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">write_permissions</span><span class="kw">:</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> codecommit:GitPush</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> codecommit:CreateBranch</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> codecommit:CreatePullRequest</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">admin_permissions</span><span class="kw">:</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> codecommit:MergePullRequest (requires reviewer role)</span></span></code></pre></div>
<p><strong>Branch Protection:</strong></p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">protected_branches</span><span class="kw">:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">main</span><span class="kw">:</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">require_pull_request</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">required_approvals</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">require_status_checks</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">status_checks</span><span class="kw">:</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> CodeBuild Security Scan</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Unit Tests</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Integration Tests</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">restrict_push</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">release</span><span class="kw">:</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">require_pull_request</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">required_approvals</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">require_status_checks</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">dev</span><span class="kw">:</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">require_pull_request</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">required_approvals</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span></code></pre></div>
<h4 id="branching-strategy">3.2 Branching Strategy</h4>
<div class="sourceCode" id="cb17"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">branch_naming</span><span class="kw">:</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">feature</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;feature/[JIRA-ID]-short-description&quot;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">bugfix</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;bugfix/[JIRA-ID]-short-description&quot;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">hotfix</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;hotfix/[JIRA-ID]-short-description&quot;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">release</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;release/v[version]&quot;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">workflow</span><span class="kw">:</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">1</span><span class="kw">:</span><span class="at"> Create feature branch from dev</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2</span><span class="kw">:</span><span class="at"> Implement feature</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">3</span><span class="kw">:</span><span class="at"> Write unit tests</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">4</span><span class="kw">:</span><span class="at"> Run pre-commit hooks</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">5</span><span class="kw">:</span><span class="at"> Push to CodeCommit</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">6</span><span class="kw">:</span><span class="at"> Create pull request</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">7</span><span class="kw">:</span><span class="at"> Code review</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">8</span><span class="kw">:</span><span class="at"> Merge to dev</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">9</span><span class="kw">:</span><span class="at"> Integration testing</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">10</span><span class="kw">:</span><span class="at"> Merge to main for release</span></span></code></pre></div>
<h4 id="secure-coding-standards">3.3 Secure Coding Standards</h4>
<p><strong>Go Secure Coding:</strong></p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode go"><code class="sourceCode go"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">// 1. Input Validation</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="kw">func</span> ValidateInput<span class="op">(</span>input <span class="dt">string</span><span class="op">)</span> <span class="dt">error</span> <span class="op">{</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span><span class="op">(</span>input<span class="op">)</span> <span class="op">&gt;</span> <span class="dv">1000</span> <span class="op">{</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> errors<span class="op">.</span>New<span class="op">(</span><span class="st">&quot;input too long&quot;</span><span class="op">)</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    validPattern <span class="op">:=</span> regexp<span class="op">.</span>MustCompile<span class="op">(</span><span class="st">`^[a-zA-Z0-9_-]+$`</span><span class="op">)</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">!</span>validPattern<span class="op">.</span>MatchString<span class="op">(</span>input<span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> errors<span class="op">.</span>New<span class="op">(</span><span class="st">&quot;invalid characters&quot;</span><span class="op">)</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ot">nil</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">// 2. Secure Database Queries (MongoDB)</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="kw">func</span> GetUser<span class="op">(</span>userID <span class="dt">string</span><span class="op">)</span> <span class="op">(*</span>User<span class="op">,</span> <span class="dt">error</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> user User</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    err <span class="op">:=</span> db<span class="op">.</span>FindOne<span class="op">(</span>context<span class="op">.</span>Background<span class="op">(),</span> bson<span class="op">.</span>M<span class="op">{</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;user_id&quot;</span><span class="op">:</span> bson<span class="op">.</span>M<span class="op">{</span><span class="st">&quot;$eq&quot;</span><span class="op">:</span> userID<span class="op">},</span> <span class="co">// Explicit operator</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}).</span>Decode<span class="op">(&amp;</span>user<span class="op">)</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">&amp;</span>user<span class="op">,</span> err</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="co">// 3. Secure Error Handling</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="kw">func</span> HandleRequest<span class="op">(</span>w http<span class="op">.</span>ResponseWriter<span class="op">,</span> r <span class="op">*</span>http<span class="op">.</span>Request<span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    user<span class="op">,</span> err <span class="op">:=</span> authenticateUser<span class="op">(</span>r<span class="op">)</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> err <span class="op">!=</span> <span class="ot">nil</span> <span class="op">{</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Log detailed error internally</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>        logger<span class="op">.</span>Error<span class="op">(</span><span class="st">&quot;Authentication failed&quot;</span><span class="op">,</span> <span class="st">&quot;error&quot;</span><span class="op">,</span> err<span class="op">,</span> <span class="st">&quot;ip&quot;</span><span class="op">,</span> r<span class="op">.</span>RemoteAddr<span class="op">)</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Return generic error to client</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>        http<span class="op">.</span>Error<span class="op">(</span>w<span class="op">,</span> <span class="st">&quot;Authentication failed&quot;</span><span class="op">,</span> http<span class="op">.</span>StatusUnauthorized<span class="op">)</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="co">// 4. Use securaa_lib for Encryption</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="kw">func</span> EncryptCredential<span class="op">(</span>credential <span class="dt">string</span><span class="op">)</span> <span class="op">(</span><span class="dt">string</span><span class="op">,</span> <span class="dt">error</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>    key <span class="op">:=</span> <span class="op">[]</span><span class="dt">byte</span><span class="op">(</span>os<span class="op">.</span>Getenv<span class="op">(</span><span class="st">&quot;ENCRYPTION_KEY&quot;</span><span class="op">))</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> securaa_lib<span class="op">.</span>CredentialsEncryptV2<span class="op">(</span>credential<span class="op">,</span> key<span class="op">)</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a><span class="kw">func</span> DecryptCredential<span class="op">(</span>encrypted <span class="dt">string</span><span class="op">)</span> <span class="op">(</span><span class="dt">string</span><span class="op">,</span> <span class="dt">error</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>    key <span class="op">:=</span> <span class="op">[]</span><span class="dt">byte</span><span class="op">(</span>os<span class="op">.</span>Getenv<span class="op">(</span><span class="st">&quot;ENCRYPTION_KEY&quot;</span><span class="op">))</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> securaa_lib<span class="op">.</span>CredentialsDecryptV2<span class="op">(</span>encrypted<span class="op">,</span> key<span class="op">)</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a><span class="co">// 5. Secure Logging (No PII, No Credentials)</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a><span class="kw">func</span> LogSecurityEvent<span class="op">(</span>eventType<span class="op">,</span> userID<span class="op">,</span> details <span class="dt">string</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>    logger<span class="op">.</span>Info<span class="op">(</span><span class="st">&quot;Security event&quot;</span><span class="op">,</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;event_type&quot;</span><span class="op">,</span> eventType<span class="op">,</span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;user_id&quot;</span><span class="op">,</span> userID<span class="op">,</span></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;details&quot;</span><span class="op">,</span> sanitize<span class="op">(</span>details<span class="op">),</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;timestamp&quot;</span><span class="op">,</span> time<span class="op">.</span>Now<span class="op">().</span>UTC<span class="op">())</span></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>JavaScript/React Secure Coding:</strong></p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">// 1. Avoid dangerouslySetInnerHTML</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> DOMPurify <span class="im">from</span> <span class="st">&#39;dompurify&#39;</span><span class="op">;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">SafeComponent</span>({ userInput }) {</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> sanitized <span class="op">=</span> DOMPurify<span class="op">.</span><span class="fu">sanitize</span>(userInput<span class="op">,</span> {</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">ALLOWED_TAGS</span><span class="op">:</span> [<span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="st">&#39;i&#39;</span><span class="op">,</span> <span class="st">&#39;em&#39;</span><span class="op">,</span> <span class="st">&#39;strong&#39;</span>]<span class="op">,</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">ALLOWED_ATTR</span><span class="op">:</span> []</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">&lt;</span>div dangerouslySetInnerHTML<span class="op">=</span>{{ <span class="dt">__html</span><span class="op">:</span> sanitized }} <span class="op">/&gt;;</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">// 2. Secure API Calls</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">fetchData</span>(userId) {</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> response <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`/api/users/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(userId)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;GET&#39;</span><span class="op">,</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">headers</span><span class="op">:</span> {</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Authorization&#39;</span><span class="op">:</span> <span class="vs">`Bearer </span><span class="sc">${</span><span class="fu">getAuthToken</span>()<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        <span class="dt">credentials</span><span class="op">:</span> <span class="st">&#39;same-origin&#39;</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>response<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&#39;API request failed&#39;</span>)<span class="op">;</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cf">await</span> response<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="co">// 3. Input Validation</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">validateInput</span>(input<span class="op">,</span> maxLength <span class="op">=</span> <span class="dv">1000</span>) {</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="kw">typeof</span> input <span class="op">!==</span> <span class="st">&#39;string&#39;</span>) <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (input<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> maxLength) <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> dangerousPatterns <span class="op">=</span> <span class="ss">/&lt;script</span><span class="sc">|</span><span class="ss">javascript:</span><span class="sc">|</span><span class="ss">onerror=/i</span><span class="op">;</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (dangerousPatterns<span class="op">.</span><span class="fu">test</span>(input)) <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h4 id="code-review-process">3.4 Code Review Process</h4>
<p><strong>Pull Request Template:</strong></p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">## Description</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="ot">[JIRA-ID]: </span>Brief description</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">## Security Considerations</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> No hardcoded credentials</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Input validation implemented</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Using securaa_lib for encryption</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Proper error handling</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Security events logged</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Authentication/authorization enforced</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">## Testing</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Unit tests added</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Security tests included</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Manual testing completed</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Security Scan Results</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> GoSec: Pass</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Dependency scan: Pass</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reviewers</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>@security-team @team-lead</span></code></pre></div>
<p><strong>Code Review Checklist:</strong> - [ ] Authentication
implemented correctly - [ ] Authorization checks present - [ ] Input
validation comprehensive - [ ] Sensitive data encrypted using
securaa_lib - [ ] Error messages don’t expose details - [ ] No
credentials in code - [ ] Logging doesn’t contain PII - [ ] Unit tests
cover security scenarios - [ ] Code follows SECURAA standards</p>
<h3 id="deliverables-2">Deliverables</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Code in feature branch</label></li>
<li><label><input type="checkbox" />Unit tests (&gt;80%
coverage)</label></li>
<li><label><input type="checkbox" />Security tests</label></li>
<li><label><input type="checkbox" />Pull request created</label></li>
<li><label><input type="checkbox" />Code review completed</label></li>
<li><label><input type="checkbox" />Approved by 2 reviewers</label></li>
<li><label><input type="checkbox" />Merged to dev branch</label></li>
</ul>
<hr />
<h2 id="phase-4-security-testing">Phase 4: Security Testing</h2>
<h3 id="objective-3">Objective</h3>
<p>Validate security controls through automated and manual security
testing.</p>
<h3 id="activities-3">Activities</h3>
<h4 id="static-application-security-testing-sast">4.1 Static Application
Security Testing (SAST)</h4>
<p><strong>GoSec Configuration:</strong></p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .gosec.yml</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">&quot;global&quot;</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;nosec&quot;</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span><span class="kw">,</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;show-ignored&quot;</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span><span class="kw">,</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;confidence&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;medium&quot;</span><span class="kw">,</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;severity&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;medium&quot;</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">},</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">&quot;rules&quot;</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;G101&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Look for hardcoded credentials&quot;</span><span class="kw">,</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;G104&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Audit errors not checked&quot;</span><span class="kw">,</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;G201&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;SQL query construction using string building&quot;</span><span class="kw">,</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;G401&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Detect MD5 usage&quot;</span><span class="kw">,</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">&quot;G501&quot;</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Import blocklist: crypto/md5&quot;</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">}</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<p><strong>Run GoSec:</strong></p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> install github.com/securego/gosec/v2/cmd/gosec@latest</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Run scan</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="ex">gosec</span> <span class="at">-fmt</span><span class="op">=</span>json <span class="at">-out</span><span class="op">=</span>gosec-report.json ./...</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for critical issues</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="ex">gosec</span> <span class="at">-severity</span><span class="op">=</span>high ./...</span></code></pre></div>
<p><strong>ESLint Security (JavaScript/React):</strong></p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install <span class="at">--save-dev</span> eslint eslint-plugin-security</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Run scan</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="ex">eslint</span> <span class="at">--ext</span> .js,.jsx src/ <span class="at">--format</span> json <span class="at">--output-file</span> eslint-report.json</span></code></pre></div>
<h4 id="dependency-vulnerability-scanning">4.2 Dependency Vulnerability
Scanning</h4>
<p><strong>Nancy for Go:</strong></p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> install github.com/sonatype-nexus-community/nancy@latest</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Scan dependencies</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> list <span class="at">-json</span> <span class="at">-m</span> all <span class="kw">|</span> <span class="ex">nancy</span> sleuth</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Output to JSON</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> list <span class="at">-json</span> <span class="at">-m</span> all <span class="kw">|</span> <span class="ex">nancy</span> sleuth <span class="at">-output</span> json <span class="op">&gt;</span> nancy-report.json</span></code></pre></div>
<p><strong>npm audit for JavaScript:</strong></p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run npm audit</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> audit <span class="at">--json</span> <span class="op">&gt;</span> npm-audit-report.json</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix vulnerabilities</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> audit fix</span></code></pre></div>
<p><strong>govulncheck for Go:</strong></p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> install golang.org/x/vuln/cmd/govulncheck@latest</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Run vulnerability check</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="ex">govulncheck</span> ./...</span></code></pre></div>
<h4 id="dynamic-application-security-testing-dast">4.3 Dynamic
Application Security Testing (DAST)</h4>
<p><strong>OWASP ZAP Integration:</strong></p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run ZAP scan against staging environment</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> <span class="at">--name</span> zap <span class="dt">\</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-p</span> 8080:8080 <span class="dt">\</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  owasp/zap2docker-stable zap.sh <span class="at">-daemon</span> <span class="dt">\</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">-host</span> 0.0.0.0 <span class="at">-port</span> 8080</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Run spider scan</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="st">&quot;http://localhost:8080/JSON/spider/action/scan/&quot;</span> <span class="dt">\</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">--data</span> <span class="st">&quot;url=https://staging.securaa.io&quot;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Run active scan</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="st">&quot;http://localhost:8080/JSON/ascan/action/scan/&quot;</span> <span class="dt">\</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">--data</span> <span class="st">&quot;url=https://staging.securaa.io&quot;</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate report</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="st">&quot;http://localhost:8080/JSON/core/view/alerts/&quot;</span> <span class="dt">\</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">-o</span> zap-report.json</span></code></pre></div>
<h4 id="container-security-scanning">4.4 Container Security
Scanning</h4>
<p><strong>Trivy for Docker Images:</strong></p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install Trivy</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://github.com/aquasecurity/trivy/releases/download/v0.44.0/trivy_0.44.0_Linux-64bit.tar.gz</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> zxvf trivy_0.44.0_Linux-64bit.tar.gz</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> mv trivy /usr/local/bin/</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Scan Docker image</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="ex">trivy</span> image <span class="at">--severity</span> HIGH,CRITICAL securaa/zona_user:latest</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Output to JSON</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="ex">trivy</span> image <span class="at">--format</span> json <span class="at">--output</span> trivy-report.json securaa/zona_user:latest</span></code></pre></div>
<h3 id="deliverables-3">Deliverables</h3>
<ul class="task-list">
<li><label><input type="checkbox" />GoSec scan completed</label></li>
<li><label><input type="checkbox" />Dependency scans
completed</label></li>
<li><label><input type="checkbox" />DAST scan completed
(staging)</label></li>
<li><label><input type="checkbox" />Container scans
completed</label></li>
<li><label><input type="checkbox" />Security reports
generated</label></li>
<li><label><input type="checkbox" />Critical/High issues
resolved</label></li>
<li><label><input type="checkbox" />Security test approval</label></li>
</ul>
<hr />
<h2 id="phase-5-build-deployment">Phase 5: Build &amp; Deployment</h2>
<h3 id="objective-4">Objective</h3>
<p>Build secure artifacts and deploy to production using AWS CodeBuild
and ECR.</p>
<h3 id="activities-4">Activities</h3>
<h4 id="aws-codebuild-configuration">5.1 AWS CodeBuild
Configuration</h4>
<p><strong>Core_BuildSpec.yaml</strong> (Actual configuration from
repository):</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.2</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phases</span><span class="kw">:</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pre_build</span><span class="kw">:</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo CODEBUILD_SRC_DIR - $CODEBUILD_SRC_DIR</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cd ..</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> pwd</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> wget --no-check-certificate https://repo.securaa.io/code_dependency/github.com.zip</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> wget --no-check-certificate https://repo.securaa.io/code_dependency/gopkg.in.zip</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ls</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> unzip github.com.zip</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> unzip gopkg.in.zip</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;After Unziping&quot;</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ls</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> pwd</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">build</span><span class="kw">:</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> export GO111MODULE=on</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> export TAG_IMAGE=$dev_image</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo $TAG_IMAGE</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go env</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cd build_securaa</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Below are the build_securaa folders&quot;</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ls</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Entering in Core Script Folder&quot;</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cd core_scripts/</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ls</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> chmod 777 *</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ls -l</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> sudo ./securaa_ecr_login.sh</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> pwd</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ls</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cd ../</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> chmod 777 build_securaa.sh</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> export app=aws</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;The value of app is $app&quot;</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ls -l</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo $GOPATH</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo $GOROOT</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./build_securaa.sh &quot;-vi&quot; $dev_image rpm_mssp_complete 0001 $dev_image</span></span></code></pre></div>
<p><strong>Wrapper_BuildSpec.yaml</strong> (Integration services):</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.2</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phases</span><span class="kw">:</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pre_build</span><span class="kw">:</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo CODEBUILD_SRC_DIR - $CODEBUILD_SRC_DIR</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cd ..</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> pwd</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> wget --no-check-certificate https://repo.securaa.io/code_dependency/github.com.zip</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> wget --no-check-certificate https://repo.securaa.io/code_dependency/gopkg.in.zip</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ls</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> unzip github.com.zip</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> unzip gopkg.in.zip</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;After Unziping&quot;</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ls</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> pwd</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">build</span><span class="kw">:</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> export GO111MODULE=on</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> export TAG_IMAGE=$dev_image</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo $TAG_IMAGE</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go env</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cd build_securaa</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Below are the build_securaa folders&quot;</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ls</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Entering in Core Script Folder&quot;</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cd core_scripts/</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ls</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> chmod 777 *</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ls -l</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> sudo ./securaa_ecr_login.sh</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> pwd</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ls</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cd ../</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> chmod 777 build_securaa.sh</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> export app=aws</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;The value of app is $app&quot;</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ls -l</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo $GOPATH</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo $GOROOT</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./build_securaa.sh &quot;-vw&quot; $dev_image rpm_mssp_complete 0001 $dev_image</span></span></code></pre></div>
<h4 id="build-process">5.2 Build Process</h4>
<p><strong>build_securaa.sh Options</strong> (from repository):</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build core services and push to ECR</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./build_securaa.sh</span> <span class="st">&quot;-vi&quot;</span> <span class="pp">[</span><span class="ss">TAG_IMAGE</span><span class="pp">]</span> rpm_mssp_complete <span class="pp">[</span><span class="ss">BUILD_NUMBER</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">TAG_IMAGE</span><span class="pp">]</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build integration services</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="ex">./build_securaa.sh</span> <span class="st">&quot;-vw&quot;</span> <span class="pp">[</span><span class="ss">TAG_IMAGE</span><span class="pp">]</span> rpm_mssp_complete <span class="pp">[</span><span class="ss">BUILD_NUMBER</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">TAG_IMAGE</span><span class="pp">]</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Build UI</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="ex">./build_securaa.sh</span> <span class="st">&quot;-vu&quot;</span> <span class="pp">[</span><span class="ss">TAG_IMAGE</span><span class="pp">]</span> rpm_mssp_complete <span class="pp">[</span><span class="ss">BUILD_NUMBER</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">TAG_IMAGE</span><span class="pp">]</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Options:</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># -v  Verbose mode</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># -i  Make core images (zona_services, zona_batch)</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># -w  Make wrapper images (integrations)</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># -u  Make UI build (zonareact)</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># -r  Make RPM packages</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co"># -a  Binary and zip export</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co"># -c  Checkout all repos</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co"># -s  Scan repositories</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co"># -b  Make batch images</span></span></code></pre></div>
<p><strong>Build Functions</strong> (from functions_aws.sh): -
<code>build_push_images()</code> - Build and push core service images -
<code>build_push_wrapper_images()</code> - Build and push integration
images - <code>make_ecr_login()</code> - Authenticate to AWS ECR -
<code>ui_build()</code> - Build React frontend</p>
<h4 id="aws-ecr-configuration">5.3 AWS ECR Configuration</h4>
<p><strong>ECR Registry:</strong></p>
<pre><code>665853670667.dkr.ecr.us-east-2.amazonaws.com</code></pre>
<p><strong>ECR Repositories:</strong> - securaa/zona_user -
securaa/zona_integrations - securaa/zona_siem - securaa/zona_playbook -
securaa/zona_batch - securaa/zonareact - … (one per service)</p>
<p><strong>ECR Security Features:</strong></p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ecr_configuration</span><span class="kw">:</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">image_scanning</span><span class="kw">:</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">scan_on_push</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">severity_threshold</span><span class="kw">:</span><span class="at"> HIGH</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">encryption</span><span class="kw">:</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> KMS</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">kms_key</span><span class="kw">:</span><span class="at"> securaa-ecr-key</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">image_tag_mutability</span><span class="kw">:</span><span class="at"> IMMUTABLE</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">lifecycle_policy</span><span class="kw">:</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Keep last 10 production images</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Remove untagged images after 7 days</span></span></code></pre></div>
<p><strong>ECR Authentication:</strong></p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># From securaa_ecr_login.sh</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> ecr get-login-password <span class="at">--region</span> us-east-2 <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="ex">docker</span> login <span class="at">--username</span> AWS <span class="at">--password-stdin</span> <span class="dt">\</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  665853670667.dkr.ecr.us-east-2.amazonaws.com</span></code></pre></div>
<h4 id="container-security">5.4 Container Security</h4>
<p><strong>Secure Dockerfile Pattern:</strong></p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multi-stage build</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> golang:1.17-alpine <span class="kw">AS</span> builder</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create non-root user</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">addgroup</span> <span class="at">-S</span> appgroup <span class="kw">&amp;&amp;</span> <span class="ex">adduser</span> <span class="at">-S</span> appuser <span class="at">-G</span> appgroup</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="kw">WORKDIR</span> /app</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> go.mod go.sum ./</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">go</span> mod download <span class="kw">&amp;&amp;</span> <span class="ex">go</span> mod verify</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> . .</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="va">CGO_ENABLED</span><span class="op">=</span>0 <span class="va">GOOS</span><span class="op">=</span>linux <span class="ex">go</span> build <span class="at">-o</span> main .</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Final stage - minimal image</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> alpine:3.18</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Install security updates</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">apk</span> <span class="at">--no-cache</span> add ca-certificates <span class="kw">&amp;&amp;</span> <span class="dt">\</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="ex">apk</span> <span class="at">--no-cache</span> upgrade</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create non-root user</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">addgroup</span> <span class="at">-S</span> appgroup <span class="kw">&amp;&amp;</span> <span class="ex">adduser</span> <span class="at">-S</span> appuser <span class="at">-G</span> appgroup</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="kw">USER</span> appuser</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="kw">WORKDIR</span> /home/appuser</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> <span class="op">--from=builder</span> <span class="op">--chown=appuser:appgroup</span> /app/main .</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPOSE</span> 8080</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="kw">HEALTHCHECK</span> <span class="op">--interval=30s</span> <span class="op">--timeout=3s</span> \</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>  <span class="kw">CMD</span> <span class="fu">wget</span> <span class="at">--no-verbose</span> <span class="at">--tries</span><span class="op">=</span>1 <span class="at">--spider</span> http://localhost:8080/health <span class="kw">||</span> <span class="bu">exit</span> 1</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;./main&quot;</span>]</span></code></pre></div>
<h4 id="deployment-automation">5.5 Deployment Automation</h4>
<p><strong>Deployment Process:</strong></p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">deployment_flow</span><span class="kw">:</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">1_build</span><span class="kw">:</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> CodeBuild triggered on merge to main</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Dependencies downloaded from repo.securaa.io</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Go modules vendored (GO111MODULE=on)</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Services built</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Docker images created</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2_scan</span><span class="kw">:</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Container images scanned</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Vulnerabilities checked</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Scan results reviewed</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">3_push</span><span class="kw">:</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Images tagged with build number</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Push to ECR registry</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Image signing</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">4_deploy</span><span class="kw">:</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Update EC2 instances</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Pull new images from ECR</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Rolling deployment</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Health checks</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">5_verify</span><span class="kw">:</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Service health checks</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Integration tests</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Monitoring validation</span></span></code></pre></div>
<h3 id="deliverables-4">Deliverables</h3>
<ul class="task-list">
<li><label><input type="checkbox" />CodeBuild project
configured</label></li>
<li><label><input type="checkbox" />Build scripts tested</label></li>
<li><label><input type="checkbox" />Docker images built</label></li>
<li><label><input type="checkbox" />Container scans passed</label></li>
<li><label><input type="checkbox" />Images pushed to ECR</label></li>
<li><label><input type="checkbox" />Deployment successful</label></li>
<li><label><input type="checkbox" />Health checks passing</label></li>
</ul>
<hr />
<h2 id="phase-6-operations-monitoring">Phase 6: Operations &amp;
Monitoring</h2>
<h3 id="objective-5">Objective</h3>
<p>Monitor production systems and respond to security events.</p>
<h3 id="activities-5">Activities</h3>
<h4 id="cloudwatch-logging">6.1 CloudWatch Logging</h4>
<p><strong>Log Configuration:</strong></p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cloudwatch_logs</span><span class="kw">:</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">log_groups</span><span class="kw">:</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> /aws/securaa/zona_services</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> /aws/securaa/zona_batch</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> /aws/securaa/integrations</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> /aws/codebuild/securaa-core</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> /aws/codebuild/securaa-wrapper</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">retention</span><span class="kw">:</span><span class="at"> 90 days</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">log_events</span><span class="kw">:</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Authentication events</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Authorization failures</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> API requests</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Integration executions</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Security events</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Application errors</span></span></code></pre></div>
<p><strong>Security Event Logging:</strong></p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode go"><code class="sourceCode go"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Log security events</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="kw">func</span> LogSecurityEvent<span class="op">(</span>logger <span class="op">*</span>zap<span class="op">.</span>Logger<span class="op">,</span> event SecurityEvent<span class="op">)</span> <span class="op">{</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    logger<span class="op">.</span>Info<span class="op">(</span><span class="st">&quot;security_event&quot;</span><span class="op">,</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>Time<span class="op">(</span><span class="st">&quot;timestamp&quot;</span><span class="op">,</span> time<span class="op">.</span>Now<span class="op">().</span>UTC<span class="op">()),</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;event_type&quot;</span><span class="op">,</span> event<span class="op">.</span>EventType<span class="op">),</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;severity&quot;</span><span class="op">,</span> event<span class="op">.</span>Severity<span class="op">),</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;user_id&quot;</span><span class="op">,</span> event<span class="op">.</span>UserID<span class="op">),</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;ip_address&quot;</span><span class="op">,</span> event<span class="op">.</span>IPAddress<span class="op">),</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;resource&quot;</span><span class="op">,</span> event<span class="op">.</span>Resource<span class="op">),</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;action&quot;</span><span class="op">,</span> event<span class="op">.</span>Action<span class="op">),</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>        zap<span class="op">.</span>String<span class="op">(</span><span class="st">&quot;result&quot;</span><span class="op">,</span> event<span class="op">.</span>Result<span class="op">))</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="cloudwatch-metrics">6.2 CloudWatch Metrics</h4>
<p><strong>Application Metrics:</strong></p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span><span class="kw">:</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">authentication</span><span class="kw">:</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> AuthenticationSuccess (count)</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> AuthenticationFailure (count)</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> AuthenticationLatency (milliseconds)</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">api</span><span class="kw">:</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> APIRequestCount (count)</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> API4xxErrors (count)</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> API5xxErrors (count)</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> APILatency (milliseconds)</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">integrations</span><span class="kw">:</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> IntegrationExecutions (count)</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> IntegrationFailures (count)</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> IntegrationLatency (milliseconds)</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">system</span><span class="kw">:</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> CPUUtilization (percent)</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> MemoryUtilization (percent)</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> DiskUtilization (percent)</span></span></code></pre></div>
<h4 id="alerting-configuration">6.3 Alerting Configuration</h4>
<p><strong>CloudWatch Alarms:</strong></p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">alarms</span><span class="kw">:</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">high_authentication_failures</span><span class="kw">:</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metric</span><span class="kw">:</span><span class="at"> AuthenticationFailure</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">threshold</span><span class="kw">:</span><span class="at"> </span><span class="dv">50</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">period</span><span class="kw">:</span><span class="at"> </span><span class="dv">300</span><span class="co">  # 5 minutes</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">comparison</span><span class="kw">:</span><span class="at"> GreaterThanThreshold</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action</span><span class="kw">:</span><span class="at"> SNS notification to security team</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">critical_api_errors</span><span class="kw">:</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metric</span><span class="kw">:</span><span class="at"> API5xxErrors</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">threshold</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">period</span><span class="kw">:</span><span class="at"> </span><span class="dv">300</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">evaluation_periods</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action</span><span class="kw">:</span><span class="at"> SNS notification to ops team</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">unauthorized_access</span><span class="kw">:</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metric</span><span class="kw">:</span><span class="at"> API403Errors</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">threshold</span><span class="kw">:</span><span class="at"> </span><span class="dv">30</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">period</span><span class="kw">:</span><span class="at"> </span><span class="dv">300</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action</span><span class="kw">:</span><span class="at"> SNS notification to security team</span></span></code></pre></div>
<h4 id="incident-response">6.4 Incident Response</h4>
<p><strong>Incident Response Levels:</strong></p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">severity_levels</span><span class="kw">:</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">critical</span><span class="kw">:</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Production system compromised or data breach&quot;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">response_time</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;&lt; 15 minutes&quot;</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">escalation</span><span class="kw">:</span><span class="at"> CISO, CTO</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">actions</span><span class="kw">:</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Activate incident response team</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Isolate affected systems</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Preserve evidence</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Notify stakeholders</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">high</span><span class="kw">:</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Security vulnerability actively exploited&quot;</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">response_time</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;&lt; 1 hour&quot;</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">escalation</span><span class="kw">:</span><span class="at"> Security team lead</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">actions</span><span class="kw">:</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Assess impact</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Implement containment</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Deploy fixes</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Monitor for continued activity</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">medium</span><span class="kw">:</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Security vulnerability discovered&quot;</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">response_time</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;&lt; 4 hours&quot;</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">escalation</span><span class="kw">:</span><span class="at"> Security team</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">actions</span><span class="kw">:</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Analyze vulnerability</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Develop remediation plan</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Schedule deployment</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">low</span><span class="kw">:</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Potential security issue&quot;</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">response_time</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;&lt; 1 business day&quot;</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">escalation</span><span class="kw">:</span><span class="at"> Development team</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">actions</span><span class="kw">:</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Investigate issue</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Assess risk</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Create ticket</span></span></code></pre></div>
<h3 id="deliverables-5">Deliverables</h3>
<ul class="task-list">
<li><label><input type="checkbox" />CloudWatch logging
configured</label></li>
<li><label><input type="checkbox" />Metrics dashboards
created</label></li>
<li><label><input type="checkbox" />Alarms configured</label></li>
<li><label><input type="checkbox" />Incident response plan
documented</label></li>
<li><label><input type="checkbox" />On-call rotation
established</label></li>
<li><label><input type="checkbox" />Runbooks created</label></li>
</ul>
<hr />
<h2 id="phase-7-cicd-security-pipeline">Phase 7: CI/CD Security
Pipeline</h2>
<h3 id="objective-6">Objective</h3>
<p>Integrate automated security checks throughout the CI/CD
pipeline.</p>
<h3 id="activities-6">Activities</h3>
<h4 id="pre-commit-security-hooks">7.1 Pre-Commit Security Hooks</h4>
<p><strong>Pre-Commit Hook:</strong></p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># .git/hooks/pre-commit</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="at">-e</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Running pre-commit security checks...&quot;</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Check for secrets</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">git</span> diff <span class="at">--cached</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-iE</span> <span class="st">&#39;(password|api[_-]?key|secret|token)\s*=\s*[&quot;\x27][^&quot;\x27]+[&quot;\x27]&#39;</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;ERROR: Possible hardcoded secret detected!&quot;</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">exit</span> 1</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Run GoSec</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="fu">ls</span> <span class="pp">*</span>.go <span class="dv">1</span><span class="op">&gt;</span> /dev/null <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="ex">gosec</span> <span class="at">-quiet</span> ./...</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Run tests</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> test ./... <span class="at">-short</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Pre-commit checks passed!&quot;</span></span></code></pre></div>
<h4 id="codebuild-security-integration">7.2 CodeBuild Security
Integration</h4>
<p><strong>Enhanced Security BuildSpec:</strong></p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.2</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">variables</span><span class="kw">:</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">GO111MODULE</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;on&quot;</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">phases</span><span class="kw">:</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">install</span><span class="kw">:</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co">      # Install security tools</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go install github.com/securego/gosec/v2/cmd/gosec@latest</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go install github.com/sonatype-nexus-community/nancy@latest</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go install golang.org/x/vuln/cmd/govulncheck@latest</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pre_build</span><span class="kw">:</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="co">      # Download dependencies</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cd ..</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> wget --no-check-certificate https://repo.securaa.io/code_dependency/github.com.zip</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> wget --no-check-certificate https://repo.securaa.io/code_dependency/gopkg.in.zip</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> unzip github.com.zip</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> unzip gopkg.in.zip</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="co">      # Security scans</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running GoSec security scanner...&quot;</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> gosec -fmt json -out gosec-report.json ./...</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running dependency vulnerability scan...&quot;</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> go list -json -m all | nancy sleuth -output json &gt; nancy-report.json</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> echo &quot;Running govulncheck...&quot;</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> govulncheck ./...</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">build</span><span class="kw">:</span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">commands</span><span class="kw">:</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cd build_securaa</span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cd core_scripts/</span></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> chmod 777 *</span></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> sudo ./securaa_ecr_login.sh</span></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> cd ../</span></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> chmod 777 build_securaa.sh</span></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> export app=aws</span></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./build_securaa.sh &quot;-vi&quot; $dev_image rpm_mssp_complete 0001 $dev_image</span></span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a><span class="co">      # Container security scan</span></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> trivy image --severity HIGH,CRITICAL securaa/zona_user:latest</span></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a><span class="fu">artifacts</span><span class="kw">:</span></span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">files</span><span class="kw">:</span></span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> gosec-report.json</span></span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> nancy-report.json</span></span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a><span class="fu">reports</span><span class="kw">:</span></span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">SecurityReports</span><span class="kw">:</span></span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">files</span><span class="kw">:</span></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> gosec-report.json</span></span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> nancy-report.json</span></span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">file-format</span><span class="kw">:</span><span class="at"> JSON</span></span></code></pre></div>
<h4 id="security-gates">7.3 Security Gates</h4>
<p><strong>Gate Configuration:</strong></p>
<div class="sourceCode" id="cb44"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">security_gates</span><span class="kw">:</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">gate_1_secrets</span><span class="kw">:</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Secrets Detection&quot;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fail_on_finding</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">gitleaks</span><span class="kw">]</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Block commit immediately&quot;</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">gate_2_sast</span><span class="kw">:</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Static Analysis&quot;</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fail_on_finding</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">gosec</span><span class="kw">,</span><span class="at"> eslint-security</span><span class="kw">]</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">criteria</span><span class="kw">:</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">max_critical</span><span class="kw">:</span><span class="at"> </span><span class="dv">0</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">max_high</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Fail build if criteria not met&quot;</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">gate_3_dependencies</span><span class="kw">:</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Dependency Vulnerabilities&quot;</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fail_on_finding</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">nancy</span><span class="kw">,</span><span class="at"> npm-audit</span><span class="kw">,</span><span class="at"> govulncheck</span><span class="kw">]</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">criteria</span><span class="kw">:</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">max_critical_cvss</span><span class="kw">:</span><span class="at"> </span><span class="dv">0</span><span class="co">  # No CVSS &gt;= 9.0</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">max_high_cvss</span><span class="kw">:</span><span class="at"> </span><span class="dv">5</span><span class="co">       # Max 5 with CVSS &gt;= 7.0</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Fail build if critical vulnerabilities&quot;</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">gate_4_container</span><span class="kw">:</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Container Security&quot;</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">fail_on_finding</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">tools</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">trivy</span><span class="kw">]</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">criteria</span><span class="kw">:</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">max_critical</span><span class="kw">:</span><span class="at"> </span><span class="dv">0</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">max_high</span><span class="kw">:</span><span class="at"> </span><span class="dv">5</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">action</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Block ECR push&quot;</span></span></code></pre></div>
<h4 id="automated-security-reporting">7.4 Automated Security
Reporting</h4>
<p><strong>Security Report Generation:</strong></p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scripts/generate-security-report.py</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_report():</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    report <span class="op">=</span> {</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;timestamp&#39;</span>: datetime.utcnow().isoformat(),</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;build_number&#39;</span>: os.getenv(<span class="st">&#39;CODEBUILD_BUILD_NUMBER&#39;</span>),</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;commit_id&#39;</span>: os.getenv(<span class="st">&#39;CODEBUILD_RESOLVED_SOURCE_VERSION&#39;</span>),</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;findings&#39;</span>: {</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;gosec&#39;</span>: parse_gosec_report(),</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;nancy&#39;</span>: parse_nancy_report(),</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;trivy&#39;</span>: parse_trivy_report()</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;gates_passed&#39;</span>: evaluate_gates()</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;security-report.json&#39;</span>, <span class="st">&#39;w&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>        json.dump(report, f, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> report[<span class="st">&#39;gates_passed&#39;</span>]</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate_gates():</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check all security gates</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    gosec_critical <span class="op">=</span> count_critical_issues(<span class="st">&#39;gosec-report.json&#39;</span>)</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    nancy_critical <span class="op">=</span> count_critical_vulns(<span class="st">&#39;nancy-report.json&#39;</span>)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> gosec_critical <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">or</span> nancy_critical <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;SECURITY GATE FAILED: Critical issues found!&quot;</span>)</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;SECURITY GATE PASSED&quot;</span>)</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>    passed <span class="op">=</span> generate_report()</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>    sys.exit(<span class="dv">0</span> <span class="cf">if</span> passed <span class="cf">else</span> <span class="dv">1</span>)</span></code></pre></div>
<h3 id="deliverables-6">Deliverables</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Pre-commit hooks
installed</label></li>
<li><label><input type="checkbox" />Security scanning in
CodeBuild</label></li>
<li><label><input type="checkbox" />Security gates
configured</label></li>
<li><label><input type="checkbox" />Container scanning
integrated</label></li>
<li><label><input type="checkbox" />Automated reporting
active</label></li>
<li><label><input type="checkbox" />Security metrics
tracked</label></li>
</ul>
<hr />
<h2 id="security-tools-reference">Security Tools Reference</h2>
<h3 id="tools-used-in-sdlc">Tools Used in SDLC</h3>
<table>
<colgroup>
<col style="width: 15%" />
<col style="width: 23%" />
<col style="width: 18%" />
<col style="width: 42%" />
</colgroup>
<thead>
<tr class="header">
<th>Tool</th>
<th>Purpose</th>
<th>Phase</th>
<th>Implementation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>GoSec</strong></td>
<td>Go SAST</td>
<td>Development, Testing</td>
<td><code>gosec ./...</code></td>
</tr>
<tr class="even">
<td><strong>Nancy</strong></td>
<td>Go dependency scanning</td>
<td>Testing</td>
<td><code>go list -m all \| nancy sleuth</code></td>
</tr>
<tr class="odd">
<td><strong>govulncheck</strong></td>
<td>Go vulnerability check</td>
<td>Testing</td>
<td><code>govulncheck ./...</code></td>
</tr>
<tr class="even">
<td><strong>ESLint Security</strong></td>
<td>JavaScript SAST</td>
<td>Development, Testing</td>
<td><code>eslint --plugin security</code></td>
</tr>
<tr class="odd">
<td><strong>npm audit</strong></td>
<td>JavaScript dependency scanning</td>
<td>Testing</td>
<td><code>npm audit</code></td>
</tr>
<tr class="even">
<td><strong>OWASP ZAP</strong></td>
<td>DAST</td>
<td>Testing</td>
<td>Docker container</td>
</tr>
<tr class="odd">
<td><strong>Trivy</strong></td>
<td>Container scanning</td>
<td>Build</td>
<td><code>trivy image</code></td>
</tr>
<tr class="even">
<td><strong>AWS CodeBuild</strong></td>
<td>CI/CD</td>
<td>Build</td>
<td>BuildSpec files</td>
</tr>
<tr class="odd">
<td><strong>AWS ECR</strong></td>
<td>Container registry</td>
<td>Build, Deploy</td>
<td>ECR API</td>
</tr>
<tr class="even">
<td><strong>CloudWatch</strong></td>
<td>Logging, Monitoring</td>
<td>Operations</td>
<td>AWS SDK</td>
</tr>
</tbody>
</table>
<h3 id="security-tool-installation">Security Tool Installation</h3>
<div class="sourceCode" id="cb46"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Go security tools</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> install github.com/securego/gosec/v2/cmd/gosec@latest</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> install github.com/sonatype-nexus-community/nancy@latest</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="ex">go</span> install golang.org/x/vuln/cmd/govulncheck@latest</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># JavaScript security tools</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install <span class="at">-g</span> eslint eslint-plugin-security</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Container security</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://github.com/aquasecurity/trivy/releases/download/v0.44.0/trivy_0.44.0_Linux-64bit.tar.gz</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> zxvf trivy_0.44.0_Linux-64bit.tar.gz</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> mv trivy /usr/local/bin/</span></code></pre></div>
<hr />
<h2 id="compliance-standards">Compliance &amp; Standards</h2>
<h3 id="compliance-frameworks">Compliance Frameworks</h3>
<p><strong>SOC 2 Type II:</strong> - CC6.1: Logical Access Controls
(IAM, branch protection, code review) - CC6.6: Encryption at Rest
(AES-256-CBC via securaa_lib) - CC6.7: Encryption in Transit (TLS,
HTTPS) - CC7.2: Security Monitoring (CloudWatch, logging) - CC8.1:
Change Management (Git workflow, pull requests)</p>
<p><strong>ISO 27001:2022:</strong> - A.8.1: Inventory of Assets
(Repository documentation) - A.14.2: Security in Development (Secure
SDLC) - A.14.2.5: Secure Development Principles (Secure coding
standards) - A.18.1.3: Protection of Records (Audit logging,
retention)</p>
<p><strong>GDPR:</strong> - Data Protection by Design (Security in
design phase) - Data Minimization (Data flow analysis) - Security of
Processing (Encryption, access controls) - Data Breach Notification
(Incident response)</p>
<hr />
<h2 id="metrics-kpis">Metrics &amp; KPIs</h2>
<h3 id="security-metrics">Security Metrics</h3>
<table>
<thead>
<tr class="header">
<th>Metric</th>
<th>Target</th>
<th>Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Critical vulnerabilities</td>
<td>0</td>
<td>Continuous</td>
</tr>
<tr class="even">
<td>High vulnerabilities</td>
<td>&lt; 5</td>
<td>Weekly</td>
</tr>
<tr class="odd">
<td>Mean time to remediation (Critical)</td>
<td>&lt; 24 hours</td>
<td>Per incident</td>
</tr>
<tr class="even">
<td>Mean time to remediation (High)</td>
<td>&lt; 7 days</td>
<td>Per incident</td>
</tr>
<tr class="odd">
<td>Security test coverage</td>
<td>&gt; 80%</td>
<td>Monthly</td>
</tr>
<tr class="even">
<td>Failed security scans</td>
<td>&lt; 5%</td>
<td>Per build</td>
</tr>
</tbody>
</table>
<h3 id="development-metrics">Development Metrics</h3>
<table>
<thead>
<tr class="header">
<th>Metric</th>
<th>Target</th>
<th>Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Build success rate</td>
<td>&gt; 95%</td>
<td>Daily</td>
</tr>
<tr class="even">
<td>Code review completion time</td>
<td>&lt; 48 hours</td>
<td>Per PR</td>
</tr>
<tr class="odd">
<td>Deployment frequency</td>
<td>Multiple per week</td>
<td>Weekly</td>
</tr>
<tr class="even">
<td>Change failure rate</td>
<td>&lt; 10%</td>
<td>Monthly</td>
</tr>
<tr class="odd">
<td>Mean time to recovery</td>
<td>&lt; 1 hour</td>
<td>Per incident</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="roles-responsibilities">Roles &amp; Responsibilities</h2>
<h3 id="development-team">Development Team</h3>
<ul>
<li>Follow secure coding standards</li>
<li>Write security-focused unit tests</li>
<li>Participate in code reviews</li>
<li>Address security findings promptly</li>
<li>Use securaa_lib for encryption</li>
</ul>
<h3 id="security-team">Security Team</h3>
<ul>
<li>Define security requirements</li>
<li>Conduct threat modeling</li>
<li>Review security architecture</li>
<li>Approve production deployments</li>
<li>Respond to security incidents</li>
</ul>
<h3 id="devops-team">DevOps Team</h3>
<ul>
<li>Maintain CI/CD pipeline (CodeBuild)</li>
<li>Manage AWS infrastructure</li>
<li>Configure security tools</li>
<li>Monitor system health</li>
<li>Manage ECR and deployments</li>
</ul>
<h3 id="qa-team">QA Team</h3>
<ul>
<li>Execute security test cases</li>
<li>Perform DAST scanning</li>
<li>Validate security requirements</li>
<li>Document security issues</li>
</ul>
<hr />
<h2 id="summary">Summary</h2>
<p>This document provides a comprehensive overview of the SECURAA Secure
SDLC process, covering all phases from requirements gathering through
production operations. The SDLC integrates security at every stage
using:</p>
<ul>
<li><strong>AWS Infrastructure</strong>: CodeCommit, CodeBuild, ECR,
IAM, CloudWatch</li>
<li><strong>Security Tools</strong>: GoSec, Nancy, govulncheck, ESLint,
OWASP ZAP, Trivy</li>
<li><strong>Secure Coding</strong>: securaa_lib encryption, input
validation, secure error handling</li>
<li><strong>Automated Security</strong>: Pre-commit hooks, CodeBuild
security scans, container scanning</li>
<li><strong>Comprehensive Monitoring</strong>: CloudWatch logging,
metrics, alerting</li>
</ul>
<h3 id="key-artifacts">Key Artifacts</h3>
<p><strong>Repositories:</strong> 1. build_securaa - Build automation 2.
zona_services - 530+ microservices 3. securaa - Core application 4.
securaa_lib - Security library (AES-256-CBC encryption) 5. zona_batch -
Batch processing 6. integrations - 722+ integrations 7. zonareact -
React frontend 8. securaa_db - Database schemas 9. securaa_pylib -
Python utilities</p>
<p><strong>Build System:</strong> - Core_BuildSpec.yaml - Core services
- Wrapper_BuildSpec.yaml - Integration services - build_securaa.sh -
Build orchestration - ECR Registry:
665853670667.dkr.ecr.us-east-2.amazonaws.com</p>
<p><strong>Security Features:</strong> - AES-256-CBC encryption
(securaa_lib) - JWT authentication - RBAC authorization - MongoDB
SCRAM-SHA-256 auth - TLS 1.2+ for transit - IAM policies (least
privilege) - Container security scanning - Automated vulnerability
detection</p>
<hr />
<h2 id="document-history">Document History</h2>
<table>
<colgroup>
<col style="width: 28%" />
<col style="width: 18%" />
<col style="width: 25%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="header">
<th>Version</th>
<th>Date</th>
<th>Author</th>
<th>Changes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1.0</td>
<td>October 2024</td>
<td>Security Team</td>
<td>Initial documentation</td>
</tr>
<tr class="even">
<td>2.0</td>
<td>November 13, 2025</td>
<td>Engineering &amp; Security</td>
<td>Complete consolidated SDLC with codebase details</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="contact-information">Contact Information</h2>
<p><strong>Document Owner</strong>: Engineering &amp; Security
Leadership<br />
<strong>Security Team</strong>: security@securaa.com<br />
<strong>Engineering Team</strong>: engineering@securaa.com</p>
<p><strong>For Questions or Feedback</strong>: - Slack: #security-sdlc -
Email: sdlc-feedback@securaa.com</p>
<hr />
<p><em>This document contains actual implementation details from the
SECURAA codebase including real AWS infrastructure configurations, build
scripts, repository structures, and security implementations. All
information is based on concrete code analysis of the SECURAA
platform.</em></p>

</body>
</html>